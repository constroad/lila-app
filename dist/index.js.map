{
  "version": 3,
  "sources": ["../src/config/environment.ts", "../src/utils/logger.ts", "../src/models/company.model.ts", "../src/services/quota-validator.service.ts", "../node_modules/safe-buffer/index.js", "../node_modules/jws/lib/data-stream.js", "../node_modules/ecdsa-sig-formatter/src/param-bytes-for-alg.js", "../node_modules/ecdsa-sig-formatter/src/ecdsa-sig-formatter.js", "../node_modules/buffer-equal-constant-time/index.js", "../node_modules/jwa/index.js", "../node_modules/jws/lib/tostring.js", "../node_modules/jws/lib/sign-stream.js", "../node_modules/jws/lib/verify-stream.js", "../node_modules/jws/index.js", "../node_modules/jsonwebtoken/decode.js", "../node_modules/jsonwebtoken/lib/JsonWebTokenError.js", "../node_modules/jsonwebtoken/lib/NotBeforeError.js", "../node_modules/jsonwebtoken/lib/TokenExpiredError.js", "../node_modules/ms/index.js", "../node_modules/jsonwebtoken/lib/timespan.js", "../node_modules/semver/internal/constants.js", "../node_modules/semver/internal/debug.js", "../node_modules/semver/internal/re.js", "../node_modules/semver/internal/parse-options.js", "../node_modules/semver/internal/identifiers.js", "../node_modules/semver/classes/semver.js", "../node_modules/semver/functions/parse.js", "../node_modules/semver/functions/valid.js", "../node_modules/semver/functions/clean.js", "../node_modules/semver/functions/inc.js", "../node_modules/semver/functions/diff.js", "../node_modules/semver/functions/major.js", "../node_modules/semver/functions/minor.js", "../node_modules/semver/functions/patch.js", "../node_modules/semver/functions/prerelease.js", "../node_modules/semver/functions/compare.js", "../node_modules/semver/functions/rcompare.js", "../node_modules/semver/functions/compare-loose.js", "../node_modules/semver/functions/compare-build.js", "../node_modules/semver/functions/sort.js", "../node_modules/semver/functions/rsort.js", "../node_modules/semver/functions/gt.js", "../node_modules/semver/functions/lt.js", "../node_modules/semver/functions/eq.js", "../node_modules/semver/functions/neq.js", "../node_modules/semver/functions/gte.js", "../node_modules/semver/functions/lte.js", "../node_modules/semver/functions/cmp.js", "../node_modules/semver/functions/coerce.js", "../node_modules/semver/internal/lrucache.js", "../node_modules/semver/classes/range.js", "../node_modules/semver/classes/comparator.js", "../node_modules/semver/functions/satisfies.js", "../node_modules/semver/ranges/to-comparators.js", "../node_modules/semver/ranges/max-satisfying.js", "../node_modules/semver/ranges/min-satisfying.js", "../node_modules/semver/ranges/min-version.js", "../node_modules/semver/ranges/valid.js", "../node_modules/semver/ranges/outside.js", "../node_modules/semver/ranges/gtr.js", "../node_modules/semver/ranges/ltr.js", "../node_modules/semver/ranges/intersects.js", "../node_modules/semver/ranges/simplify.js", "../node_modules/semver/ranges/subset.js", "../node_modules/semver/index.js", "../node_modules/jsonwebtoken/lib/asymmetricKeyDetailsSupported.js", "../node_modules/jsonwebtoken/lib/rsaPssKeyDetailsSupported.js", "../node_modules/jsonwebtoken/lib/validateAsymmetricKey.js", "../node_modules/jsonwebtoken/lib/psSupported.js", "../node_modules/jsonwebtoken/verify.js", "../node_modules/lodash.includes/index.js", "../node_modules/lodash.isboolean/index.js", "../node_modules/lodash.isinteger/index.js", "../node_modules/lodash.isnumber/index.js", "../node_modules/lodash.isplainobject/index.js", "../node_modules/lodash.isstring/index.js", "../node_modules/lodash.once/index.js", "../node_modules/jsonwebtoken/sign.js", "../node_modules/jsonwebtoken/index.js", "../src/index.ts", "../src/api/middlewares/rateLimiter.ts", "../src/api/middlewares/errorHandler.ts", "../src/config/constants.ts", "../src/api/routes/session.routes.ts", "../src/api/controllers/session.controller.ts", "../src/whatsapp/baileys/connection.manager.ts", "../src/whatsapp/ai-agent/message.listener.ts", "../src/whatsapp/ai-agent/agent.service.ts", "../src/whatsapp/ai-agent/prompts/asphalt-sales.prompt.ts", "../src/whatsapp/ai-agent/conversation.manager.ts", "../src/storage/json.store.ts", "../src/utils/retry.ts", "../src/whatsapp/ai-agent/typing-simulator.ts", "../src/utils/validators.ts", "../src/whatsapp/queue/outbox-queue.ts", "../src/api/routes/jobs.routes.ts", "../src/jobs/scheduler.service.ts", "../src/api/controllers/jobs.controller.ts", "../src/api/routes/message.routes.ts", "../src/api/controllers/message.controller.ts", "../src/middleware/quota.middleware.ts", "../src/middleware/tenant.middleware.ts", "../src/middleware/company-rate-limiter.middleware.ts", "../src/api/routes/pdf.routes.ts", "../src/pdf/generator.service.ts", "../src/api/controllers/pdf.controller.ts", "../src/api/controllers/pdf-vale.controller.ts", "../src/pdf/render.service.ts", "../src/api/routes/drive.routes.ts", "../src/api/controllers/drive.controller.ts", "../src/services/storage-path.service.ts", "../src/api/controllers/drive-pdf.controller.ts", "../src/api/docs/openapi.ts"],
  "sourcesContent": ["import dotenv from 'dotenv';\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst envPath = path.join(__dirname, '../../.env');\nconst devEnvPath = path.join(__dirname, '../../.env.development');\n\ndotenv.config({ path: envPath });\n\nif (process.env.NODE_ENV === 'development' || fs.existsSync(devEnvPath)) {\n  dotenv.config({ path: devEnvPath, override: true });\n}\n\nexport const config = {\n  port: parseInt(process.env.PORT || '3001', 10),\n  nodeEnv: process.env.NODE_ENV || 'development',\n  \n  // WhatsApp\n  whatsapp: {\n    sessionDir: process.env.WHATSAPP_SESSION_DIR || './data/sessions',\n    autoReconnect: process.env.WHATSAPP_AUTO_RECONNECT !== 'false',\n    maxReconnectAttempts: parseInt(process.env.WHATSAPP_MAX_RECONNECT_ATTEMPTS || '0', 10),\n    qrTimeout: 60000, // 60 segundos\n    aiEnabled: process.env.WHATSAPP_AI_ENABLED !== 'false',\n    aiTestNumber: process.env.WHATSAPP_AI_TEST_NUMBER || '51949376824',\n    baileysLogLevel: process.env.WHATSAPP_BAILEYS_LOG_LEVEL || 'fatal',\n  },\n  \n  // Claude API\n  anthropic: {\n    apiKey: process.env.ANTHROPIC_API_KEY!,\n  },\n\n  telegram: {\n    botToken: process.env.TELEGRAM_BOT_TOKEN || '',\n  },\n\n  // MongoDB (Portal connection for quotas - MongoDB only)\n  mongodb: {\n    portalUri: process.env.PORTAL_MONGO_URI || process.env.MONGO_URI || 'mongodb://localhost:27017',\n    sharedDb: process.env.PORTAL_SHARED_DB || 'shared_db',\n  },\n\n  // Cron Jobs\n  jobs: {\n    storageFile: process.env.CRONJOBS_STORAGE || './data/cronjobs.json',\n    checkInterval: 10000, // Verificar cada 10s\n  },\n  \n  // PDF\n  pdf: {\n    templatesDir: process.env.PDF_TEMPLATES_DIR || './templates/pdf',\n    uploadsDir: process.env.PDF_UPLOADS_DIR || './uploads',\n    tempDir: process.env.PDF_TEMP_DIR || './data/pdf-temp',\n    tempPublicBaseUrl: process.env.PDF_TEMP_PUBLIC_BASE_URL || '/pdf-temp',\n  },\n\n  // Multi-tenant storage (Fase 9)\n  drive: {\n    maxFileSizeMb: parseInt(process.env.DRIVE_MAX_FILE_SIZE_MB || '25', 10),\n  },\n\n  // Storage root for multi-tenant files\n  storage: {\n    root: process.env.FILE_STORAGE_ROOT || '/mnt/constroad-storage',\n  },\n  \n  // Logging\n  logging: {\n    level: process.env.LOG_LEVEL || 'info',\n    dir: process.env.LOG_DIR || './logs',\n  },\n  \n  // Security\n  security: {\n    apiSecretKey: process.env.API_SECRET_KEY || 'dev-secret-key',\n    jwtSecret: process.env.JWT_SECRET || 'dev-jwt-secret',\n    rateLimitWindow: process.env.RATE_LIMIT_WINDOW || '5m',\n    rateLimitMax: parseInt(process.env.RATE_LIMIT_MAX || '200', 10),\n  },\n  \n  // Features\n  features: {\n    enablePDF: true,\n    enableCron: true,\n    enableHotReload: true,\n  },\n};\n\nexport default config;\n", "import winston from 'winston';\nimport path from 'path';\nimport { config } from '../config/environment.js';\n\nconst logDir = config.logging.dir;\n\nconst logger = winston.createLogger({\n  level: config.logging.level,\n  format: winston.format.combine(\n    winston.format.timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),\n    winston.format.errors({ stack: true }),\n    winston.format.splat(),\n    winston.format.json(),\n    winston.format.printf(({ timestamp, level, message, ...meta }) => {\n      return `${timestamp} [${level.toUpperCase()}]: ${message} ${\n        Object.keys(meta).length ? JSON.stringify(meta, null, 2) : ''\n      }`;\n    })\n  ),\n  defaultMeta: { service: 'lila-app' },\n  transports: [\n    new winston.transports.File({\n      filename: path.join(logDir, 'error.log'),\n      level: 'error',\n      maxsize: 5242880, // 5MB\n      maxFiles: 5,\n    }),\n    new winston.transports.File({\n      filename: path.join(logDir, 'combined.log'),\n      maxsize: 5242880, // 5MB\n      maxFiles: 10,\n    }),\n  ],\n});\n\n// Agregar consola en desarrollo\nif (config.nodeEnv === 'development') {\n  logger.add(\n    new winston.transports.Console({\n      format: winston.format.combine(\n        winston.format.colorize(),\n        winston.format.printf(({ timestamp, level, message, ...meta }) => {\n          const metaStr = Object.keys(meta).length\n            ? JSON.stringify(meta, null, 2)\n            : '';\n          return `${timestamp} [${level}]: ${message} ${metaStr}`;\n        })\n      ),\n    })\n  );\n}\n\nexport default logger;\n", "/**\n * Company Model - Portal MongoDB Schema\n *\n * Modelo de solo lectura para acceder a la informaci\u00F3n de empresas\n * desde la base de datos de Portal. Usado para validar quotas.\n *\n * Fase 10: Quotas y Validaciones\n *\n * IMPORTANTE: Este modelo es READ-ONLY desde lila-app.\n * Solo Portal debe modificar datos de Company.\n */\n\nimport mongoose, { Schema, Document } from 'mongoose';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface ICompanyLimits {\n  whatsappMessages: number; // L\u00EDmite mensual de mensajes de WhatsApp\n  storage: number; // L\u00EDmite de almacenamiento en GB\n  users: number; // N\u00FAmero m\u00E1ximo de usuarios\n  orders: number; // N\u00FAmero m\u00E1ximo de \u00F3rdenes activas\n}\n\nexport interface ICompany extends Document {\n  companyId: string; // ID \u00FAnico de la empresa\n  name: string;\n  ruc?: string;\n  email?: string;\n  phone?: string;\n  address?: string;\n\n  // Multi-tenant configuration\n  limits: ICompanyLimits;\n  isActive: boolean;\n\n  // Metadata\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// ============================================================================\n// SCHEMA\n// ============================================================================\n\nconst CompanyLimitsSchema = new Schema<ICompanyLimits>(\n  {\n    whatsappMessages: {\n      type: Number,\n      required: true,\n      default: 1000,\n      min: 0,\n    },\n    storage: {\n      type: Number,\n      required: true,\n      default: 10, // 10 GB\n      min: 0,\n    },\n    users: {\n      type: Number,\n      required: true,\n      default: 5,\n      min: 1,\n    },\n    orders: {\n      type: Number,\n      required: true,\n      default: 100,\n      min: 0,\n    },\n  },\n  { _id: false }\n);\n\nconst CompanySchema = new Schema<ICompany>(\n  {\n    companyId: {\n      type: String,\n      required: true,\n      unique: true,\n      index: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    ruc: {\n      type: String,\n      sparse: true,\n    },\n    email: {\n      type: String,\n      sparse: true,\n    },\n    phone: {\n      type: String,\n    },\n    address: {\n      type: String,\n    },\n    limits: {\n      type: CompanyLimitsSchema,\n      required: true,\n      default: () => ({}), // Usa defaults del sub-schema\n    },\n    isActive: {\n      type: Boolean,\n      required: true,\n      default: true,\n    },\n  },\n  {\n    timestamps: true,\n    collection: 'companies', // Nombre de la colecci\u00F3n en Portal\n  }\n);\n\n// ============================================================================\n// INDEXES\n// ============================================================================\n\nCompanySchema.index({ companyId: 1 });\nCompanySchema.index({ isActive: 1 });\n\n// ============================================================================\n// EXPORT\n// ============================================================================\n\n// NOTA: Este modelo se crea din\u00E1micamente en QuotaValidatorService\n// para evitar problemas con m\u00FAltiples conexiones de mongoose\nexport default CompanySchema;\nexport { CompanySchema };\n", "/**\n * QuotaValidatorService - Multi-Tenant Quota Validation\n *\n * Servicio SINGLETON para validar quotas de empresas consultando Portal MongoDB.\n * Usa MongoDB como fuente \u00FAnica de verdad para limits y usage.\n *\n * ARQUITECTURA ROBUSTA PARA PRODUCCI\u00D3N:\n * ========================================\n * \u2705 Singleton global para evitar m\u00FAltiples conexiones\n * \u2705 Connection pooling optimizado\n * \u2705 Circuit breaker para evitar connection storms\n * \u2705 Lazy connection (solo conecta cuando se necesita)\n * \u2705 Event listeners sin duplicados\n * \u2705 Logging controlado\n *\n * Fase 10: Quotas y Validaciones (MongoDB-only)\n *\n * @example\n * ```typescript\n * import { quotaValidatorService } from './quota-validator.service';\n *\n * // Auto-conecta en primera llamada\n * const canSend = await quotaValidatorService.checkWhatsAppQuota('company-123');\n * if (!canSend) {\n *   throw new Error('WhatsApp quota exceeded');\n * }\n * ```\n */\n\nimport mongoose, { Connection, Model } from 'mongoose';\nimport { config } from '../config/environment.js';\nimport { CompanySchema, ICompany } from '../models/company.model.js';\nimport logger from '../utils/logger.js';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface QuotaCheckResult {\n  allowed: boolean;\n  current: number;\n  limit: number;\n  remaining: number;\n  period: string;\n}\n\nexport interface QuotaInfo {\n  whatsappMessages: QuotaCheckResult;\n  storage: QuotaCheckResult;\n}\n\ninterface CircuitBreakerState {\n  isOpen: boolean;\n  failures: number;\n  lastFailure: number;\n  nextRetry: number;\n}\n\n// ============================================================================\n// GLOBAL CACHE (sobrevive hot reloads en desarrollo)\n// ============================================================================\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var __quotaValidatorService: QuotaValidatorService | undefined;\n}\n\n// ============================================================================\n// SERVICE\n// ============================================================================\n\nexport class QuotaValidatorService {\n  private portalMongoConn: Connection | null = null;\n  private CompanyModel: Model<ICompany> | null = null;\n  private isConnected = false;\n  private isConnecting = false;\n\n  // Circuit breaker\n  private circuitBreaker: CircuitBreakerState = {\n    isOpen: false,\n    failures: 0,\n    lastFailure: 0,\n    nextRetry: 0,\n  };\n\n  // Configuration\n  private readonly CIRCUIT_BREAKER_THRESHOLD = 5;\n  private readonly CIRCUIT_BREAKER_TIMEOUT = 60 * 1000; // 1 min\n  private readonly CONNECTION_TIMEOUT = 10000; // 10 sec\n  private readonly IS_PROD = process.env.NODE_ENV === 'production';\n\n  // Singleton\n  private static instance: QuotaValidatorService | undefined;\n\n  private constructor() {\n    // Private constructor para forzar uso de getInstance()\n    // Graceful shutdown\n    process.once('SIGINT', () => this.disconnect());\n    process.once('SIGTERM', () => this.disconnect());\n  }\n\n  /**\n   * Get singleton instance (global cache para hot reloads)\n   */\n  public static getInstance(): QuotaValidatorService {\n    if (!global.__quotaValidatorService) {\n      global.__quotaValidatorService = new QuotaValidatorService();\n    }\n    return global.__quotaValidatorService;\n  }\n\n  // ==========================================================================\n  // CONNECTION\n  // ==========================================================================\n\n  /**\n   * Conecta a MongoDB de Portal (lazy, solo si es necesario)\n   */\n  async connect(): Promise<void> {\n    // Si ya est\u00E1 conectado, retornar inmediatamente\n    if (this.isConnected && this.portalMongoConn && this.portalMongoConn.readyState === 1) {\n      return;\n    }\n\n    // Si ya est\u00E1 conectando, esperar\n    if (this.isConnecting) {\n      return this.waitForConnection();\n    }\n\n    // Circuit breaker check\n    if (this.isCircuitBreakerOpen()) {\n      throw new Error('Circuit breaker is open. Too many connection failures.');\n    }\n\n    this.isConnecting = true;\n\n    try {\n      // Solo log en primera conexi\u00F3n\n      if (!this.portalMongoConn || !this.IS_PROD) {\n        logger.info('\uD83D\uDCE1 Connecting to Portal MongoDB (shared_db)...');\n      }\n\n      const connection = mongoose.createConnection(config.mongodb.portalUri, {\n        dbName: config.mongodb.sharedDb,\n        serverSelectionTimeoutMS: this.CONNECTION_TIMEOUT,\n        socketTimeoutMS: 45000,\n        maxPoolSize: this.IS_PROD ? 5 : 3,\n        minPoolSize: 1,\n        family: 4, // Force IPv4\n        retryWrites: true,\n        heartbeatFrequencyMS: 10000,\n      });\n\n      // Setup event listeners (evitar duplicados)\n      this.setupConnectionListeners(connection);\n\n      this.portalMongoConn = await connection.asPromise();\n\n      // Crear modelo de Company (verificar si ya existe para evitar OverwriteModelError)\n      if (this.portalMongoConn.models.Company) {\n        this.CompanyModel = this.portalMongoConn.models.Company as Model<ICompany>;\n      } else {\n        this.CompanyModel = this.portalMongoConn.model<ICompany>('Company', CompanySchema);\n      }\n\n      this.isConnected = true;\n      this.isConnecting = false;\n      this.resetCircuitBreaker();\n\n      logger.info('\u2705 QuotaValidator connected to Portal MongoDB');\n    } catch (error) {\n      this.isConnecting = false;\n      this.isConnected = false;\n      this.recordCircuitBreakerFailure();\n\n      logger.error('\u274C Failed to connect to Portal MongoDB:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Wait for connection in progress\n   */\n  private async waitForConnection(): Promise<void> {\n    const maxWait = 30000; // 30 seconds\n    const checkInterval = 100; // 100ms\n    let waited = 0;\n\n    while (waited < maxWait) {\n      if (this.isConnected && this.portalMongoConn?.readyState === 1) {\n        return;\n      }\n      if (!this.isConnecting) {\n        // Connection failed\n        throw new Error('Connection attempt failed');\n      }\n\n      await new Promise(resolve => setTimeout(resolve, checkInterval));\n      waited += checkInterval;\n    }\n\n    throw new Error('Connection timeout');\n  }\n\n  /**\n   * Setup connection event listeners (evita duplicados)\n   */\n  private setupConnectionListeners(conn: Connection): void {\n    // Remover listeners anteriores si existen\n    conn.removeAllListeners('error');\n    conn.removeAllListeners('disconnected');\n    conn.removeAllListeners('reconnected');\n\n    // Error handler\n    conn.on('error', (err) => {\n      if (this.IS_PROD) {\n        logger.error('\u274C Portal MongoDB error:', err.message);\n      }\n      this.isConnected = false;\n    });\n\n    // Disconnected (silencioso)\n    conn.on('disconnected', () => {\n      this.isConnected = false;\n      // Silencioso - no loggear desconexiones normales\n    });\n\n    // Reconnected (solo en producci\u00F3n)\n    conn.on('reconnected', () => {\n      this.isConnected = true;\n      if (this.IS_PROD) {\n        logger.info('\uD83D\uDD04 Portal MongoDB reconnected');\n      }\n    });\n  }\n\n  /**\n   * Circuit breaker: Check if open\n   */\n  private isCircuitBreakerOpen(): boolean {\n    if (!this.circuitBreaker.isOpen) return false;\n\n    // Check si es tiempo de reintentar\n    if (Date.now() > this.circuitBreaker.nextRetry) {\n      this.circuitBreaker.isOpen = false;\n      this.circuitBreaker.failures = 0;\n      logger.info('\uD83D\uDD13 Circuit breaker closed - retrying connections');\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Circuit breaker: Record failure\n   */\n  private recordCircuitBreakerFailure(): void {\n    this.circuitBreaker.failures++;\n    this.circuitBreaker.lastFailure = Date.now();\n\n    if (this.circuitBreaker.failures >= this.CIRCUIT_BREAKER_THRESHOLD) {\n      this.circuitBreaker.isOpen = true;\n      this.circuitBreaker.nextRetry = Date.now() + this.CIRCUIT_BREAKER_TIMEOUT;\n\n      logger.error(\n        `\uD83D\uDD12 Circuit breaker OPEN - Too many failures (${this.circuitBreaker.failures}). ` +\n        `Will retry in ${this.CIRCUIT_BREAKER_TIMEOUT / 1000}s`\n      );\n    }\n  }\n\n  /**\n   * Circuit breaker: Reset\n   */\n  private resetCircuitBreaker(): void {\n    if (this.circuitBreaker.failures > 0 || this.circuitBreaker.isOpen) {\n      this.circuitBreaker.isOpen = false;\n      this.circuitBreaker.failures = 0;\n      logger.info('\u2705 Circuit breaker reset');\n    }\n  }\n\n  /**\n   * Desconecta de MongoDB\n   */\n  async disconnect(): Promise<void> {\n    if (this.portalMongoConn) {\n      try {\n        await this.portalMongoConn.close();\n        this.portalMongoConn = null;\n        this.CompanyModel = null;\n        this.isConnected = false;\n        logger.info('\uD83D\uDD0C QuotaValidator disconnected from Portal MongoDB');\n      } catch (error) {\n        logger.error('\u274C Error disconnecting QuotaValidator:', error);\n      }\n    }\n  }\n\n  /**\n   * Verifica si est\u00E1 conectado y listo\n   */\n  isReady(): boolean {\n    return this.isConnected && this.portalMongoConn !== null && this.portalMongoConn.readyState === 1;\n  }\n\n  // ==========================================================================\n  // COMPANY HELPERS\n  // ==========================================================================\n\n  /**\n   * Obtiene los datos de una empresa desde Portal MongoDB\n   * (auto-conecta si es necesario)\n   */\n  private async getCompany(companyId: string): Promise<ICompany> {\n    // Auto-connect si no est\u00E1 conectado\n    if (!this.isReady()) {\n      await this.connect();\n    }\n\n    if (!this.CompanyModel) {\n      throw new Error('QuotaValidator not initialized');\n    }\n\n    const company = await this.CompanyModel.findOne({ companyId, isActive: true });\n\n    if (!company) {\n      logger.warn(`Company not found or inactive: ${companyId}`);\n      throw new Error(`Company not found: ${companyId}`);\n    }\n\n    return company;\n  }\n\n  /**\n   * Obtiene el periodo actual (YYYY-MM)\n   */\n  private getCurrentPeriod(): string {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0');\n    return `${year}-${month}`;\n  }\n\n  // ==========================================================================\n  // WHATSAPP QUOTA\n  // ==========================================================================\n\n  /**\n   * Verifica si una empresa puede enviar un mensaje de WhatsApp\n   * @param companyId ID de la empresa\n   * @returns true si est\u00E1 permitido, false si excede el l\u00EDmite\n   */\n  async checkWhatsAppQuota(companyId: string): Promise<boolean> {\n    try {\n      const company = await this.getCompany(companyId);\n      const limit = company.limits.whatsappMessages;\n      const used = company.subscription?.usage?.whatsappMessages || 0;\n\n      // -1 significa ilimitado\n      if (limit === -1) {\n        return true;\n      }\n\n      const allowed = used < limit;\n\n      if (!allowed) {\n        logger.warn(`WhatsApp quota exceeded for ${companyId}: ${used}/${limit}`);\n      }\n\n      return allowed;\n    } catch (error) {\n      logger.error(`Error checking WhatsApp quota for ${companyId}:`, error);\n      // En caso de error, permitir la operaci\u00F3n para no bloquear el servicio\n      return true;\n    }\n  }\n\n  /**\n   * Obtiene informaci\u00F3n detallada de la quota de WhatsApp\n   */\n  async getWhatsAppQuotaInfo(companyId: string): Promise<QuotaCheckResult> {\n    const company = await this.getCompany(companyId);\n    const limit = company.limits.whatsappMessages;\n    const current = company.subscription?.usage?.whatsappMessages || 0;\n\n    // -1 significa ilimitado\n    if (limit === -1) {\n      return {\n        allowed: true,\n        current,\n        limit,\n        remaining: -1, // Ilimitado\n        period: this.getCurrentPeriod()\n      };\n    }\n\n    const remaining = Math.max(0, limit - current);\n    const allowed = current < limit;\n    const period = this.getCurrentPeriod();\n\n    return { allowed, current, limit, remaining, period };\n  }\n\n  /**\n   * Incrementa el contador de mensajes de WhatsApp en MongoDB\n   */\n  async incrementWhatsAppUsage(companyId: string, count: number = 1): Promise<number> {\n    if (!this.isReady()) {\n      await this.connect();\n    }\n\n    if (!this.CompanyModel) {\n      throw new Error('QuotaValidator not initialized');\n    }\n\n    const result = await this.CompanyModel.findOneAndUpdate(\n      { companyId, isActive: true },\n      { $inc: { 'subscription.usage.whatsappMessages': count } },\n      { new: true }\n    );\n\n    if (!result) {\n      throw new Error(`Company not found: ${companyId}`);\n    }\n\n    const newValue = result.subscription?.usage?.whatsappMessages || 0;\n    logger.debug(`WhatsApp usage for ${companyId}: ${newValue}`);\n\n    return newValue;\n  }\n\n  // ==========================================================================\n  // STORAGE QUOTA\n  // ==========================================================================\n\n  /**\n   * Verifica si una empresa puede almacenar un archivo\n   */\n  async checkStorageQuota(companyId: string, fileSize: number): Promise<boolean> {\n    try {\n      const company = await this.getCompany(companyId);\n      const limitGb = company.limits.storage;\n\n      // -1 significa ilimitado\n      if (limitGb === -1) {\n        return true;\n      }\n\n      const limitBytes = limitGb * 1024 * 1024 * 1024;\n\n      const usedGb = company.subscription?.usage?.storage || 0;\n      const usedBytes = usedGb * 1024 * 1024 * 1024;\n\n      const allowed = usedBytes + fileSize <= limitBytes;\n\n      if (!allowed) {\n        logger.warn(\n          `Storage quota exceeded for ${companyId}: ${this.formatBytes(usedBytes + fileSize)}/${limitGb} GB`\n        );\n      }\n\n      return allowed;\n    } catch (error) {\n      logger.error(`Error checking storage quota for ${companyId}:`, error);\n      return true;\n    }\n  }\n\n  /**\n   * Obtiene informaci\u00F3n detallada de la quota de almacenamiento\n   */\n  async getStorageQuotaInfo(companyId: string): Promise<QuotaCheckResult> {\n    const company = await this.getCompany(companyId);\n    const limitGb = company.limits.storage;\n\n    const usedGb = company.subscription?.usage?.storage || 0;\n    const current = usedGb * 1024 * 1024 * 1024;\n\n    // -1 significa ilimitado\n    if (limitGb === -1) {\n      return {\n        allowed: true,\n        current,\n        limit: -1,\n        remaining: -1, // Ilimitado\n        period: this.getCurrentPeriod()\n      };\n    }\n\n    const limit = limitGb * 1024 * 1024 * 1024;\n    const remaining = Math.max(0, limit - current);\n    const allowed = current < limit;\n    const period = this.getCurrentPeriod();\n\n    return { allowed, current, limit, remaining, period };\n  }\n\n  /**\n   * Incrementa el contador de almacenamiento en MongoDB\n   */\n  async incrementStorageUsage(companyId: string, fileSize: number): Promise<number> {\n    if (!this.isReady()) {\n      await this.connect();\n    }\n\n    if (!this.CompanyModel) {\n      throw new Error('QuotaValidator not initialized');\n    }\n\n    const fileSizeGb = fileSize / (1024 * 1024 * 1024);\n\n    const result = await this.CompanyModel.findOneAndUpdate(\n      { companyId, isActive: true },\n      { $inc: { 'subscription.usage.storage': fileSizeGb } },\n      { new: true }\n    );\n\n    if (!result) {\n      throw new Error(`Company not found: ${companyId}`);\n    }\n\n    const newValueGb = result.subscription?.usage?.storage || 0;\n    const newValueBytes = newValueGb * 1024 * 1024 * 1024;\n\n    logger.debug(`Storage usage for ${companyId}: ${newValueGb.toFixed(4)} GB`);\n\n    return newValueBytes;\n  }\n\n  /**\n   * Decrementa el contador de almacenamiento en MongoDB\n   */\n  async decrementStorageUsage(companyId: string, fileSize: number): Promise<number> {\n    if (!this.isReady()) {\n      await this.connect();\n    }\n\n    if (!this.CompanyModel) {\n      throw new Error('QuotaValidator not initialized');\n    }\n\n    const fileSizeGb = fileSize / (1024 * 1024 * 1024);\n\n    const result = await this.CompanyModel.findOneAndUpdate(\n      { companyId, isActive: true },\n      { $inc: { 'subscription.usage.storage': -fileSizeGb } },\n      { new: true }\n    );\n\n    if (!result) {\n      throw new Error(`Company not found: ${companyId}`);\n    }\n\n    const newValueGb = result.subscription?.usage?.storage || 0;\n    const newValueBytes = newValueGb * 1024 * 1024 * 1024;\n\n    logger.debug(`Storage usage for ${companyId}: ${newValueGb.toFixed(4)} GB`);\n\n    return newValueBytes;\n  }\n\n  // ==========================================================================\n  // GENERAL QUOTA INFO\n  // ==========================================================================\n\n  /**\n   * Obtiene informaci\u00F3n completa de todas las quotas\n   */\n  async getQuotaInfo(companyId: string): Promise<QuotaInfo> {\n    const whatsappMessages = await this.getWhatsAppQuotaInfo(companyId);\n    const storage = await this.getStorageQuotaInfo(companyId);\n\n    return { whatsappMessages, storage };\n  }\n\n  // ==========================================================================\n  // UTILITIES\n  // ==========================================================================\n\n  /**\n   * Formatea bytes a formato legible\n   */\n  private formatBytes(bytes: number): string {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;\n  }\n}\n\n// ============================================================================\n// SINGLETON EXPORT\n// ============================================================================\n\nexport const quotaValidatorService = QuotaValidatorService.getInstance();\nexport default quotaValidatorService;\n", "/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\n/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.prototype = Object.create(Buffer.prototype)\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n", "/*global module, process*/\nvar Buffer = require('safe-buffer').Buffer;\nvar Stream = require('stream');\nvar util = require('util');\n\nfunction DataStream(data) {\n  this.buffer = null;\n  this.writable = true;\n  this.readable = true;\n\n  // No input\n  if (!data) {\n    this.buffer = Buffer.alloc(0);\n    return this;\n  }\n\n  // Stream\n  if (typeof data.pipe === 'function') {\n    this.buffer = Buffer.alloc(0);\n    data.pipe(this);\n    return this;\n  }\n\n  // Buffer or String\n  // or Object (assumedly a passworded key)\n  if (data.length || typeof data === 'object') {\n    this.buffer = data;\n    this.writable = false;\n    process.nextTick(function () {\n      this.emit('end', data);\n      this.readable = false;\n      this.emit('close');\n    }.bind(this));\n    return this;\n  }\n\n  throw new TypeError('Unexpected data type ('+ typeof data + ')');\n}\nutil.inherits(DataStream, Stream);\n\nDataStream.prototype.write = function write(data) {\n  this.buffer = Buffer.concat([this.buffer, Buffer.from(data)]);\n  this.emit('data', data);\n};\n\nDataStream.prototype.end = function end(data) {\n  if (data)\n    this.write(data);\n  this.emit('end', data);\n  this.emit('close');\n  this.writable = false;\n  this.readable = false;\n};\n\nmodule.exports = DataStream;\n", "'use strict';\n\nfunction getParamSize(keySize) {\n\tvar result = ((keySize / 8) | 0) + (keySize % 8 === 0 ? 0 : 1);\n\treturn result;\n}\n\nvar paramBytesForAlg = {\n\tES256: getParamSize(256),\n\tES384: getParamSize(384),\n\tES512: getParamSize(521)\n};\n\nfunction getParamBytesForAlg(alg) {\n\tvar paramBytes = paramBytesForAlg[alg];\n\tif (paramBytes) {\n\t\treturn paramBytes;\n\t}\n\n\tthrow new Error('Unknown algorithm \"' + alg + '\"');\n}\n\nmodule.exports = getParamBytesForAlg;\n", "'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar getParamBytesForAlg = require('./param-bytes-for-alg');\n\nvar MAX_OCTET = 0x80,\n\tCLASS_UNIVERSAL = 0,\n\tPRIMITIVE_BIT = 0x20,\n\tTAG_SEQ = 0x10,\n\tTAG_INT = 0x02,\n\tENCODED_TAG_SEQ = (TAG_SEQ | PRIMITIVE_BIT) | (CLASS_UNIVERSAL << 6),\n\tENCODED_TAG_INT = TAG_INT | (CLASS_UNIVERSAL << 6);\n\nfunction base64Url(base64) {\n\treturn base64\n\t\t.replace(/=/g, '')\n\t\t.replace(/\\+/g, '-')\n\t\t.replace(/\\//g, '_');\n}\n\nfunction signatureAsBuffer(signature) {\n\tif (Buffer.isBuffer(signature)) {\n\t\treturn signature;\n\t} else if ('string' === typeof signature) {\n\t\treturn Buffer.from(signature, 'base64');\n\t}\n\n\tthrow new TypeError('ECDSA signature must be a Base64 string or a Buffer');\n}\n\nfunction derToJose(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\t// the DER encoded param should at most be the param size, plus a padding\n\t// zero, since due to being a signed integer\n\tvar maxEncodedParamLength = paramBytes + 1;\n\n\tvar inputLength = signature.length;\n\n\tvar offset = 0;\n\tif (signature[offset++] !== ENCODED_TAG_SEQ) {\n\t\tthrow new Error('Could not find expected \"seq\"');\n\t}\n\n\tvar seqLength = signature[offset++];\n\tif (seqLength === (MAX_OCTET | 1)) {\n\t\tseqLength = signature[offset++];\n\t}\n\n\tif (inputLength - offset < seqLength) {\n\t\tthrow new Error('\"seq\" specified length of \"' + seqLength + '\", only \"' + (inputLength - offset) + '\" remaining');\n\t}\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"r\"');\n\t}\n\n\tvar rLength = signature[offset++];\n\n\tif (inputLength - offset - 2 < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", only \"' + (inputLength - offset - 2) + '\" available');\n\t}\n\n\tif (maxEncodedParamLength < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar rOffset = offset;\n\toffset += rLength;\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"s\"');\n\t}\n\n\tvar sLength = signature[offset++];\n\n\tif (inputLength - offset !== sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", expected \"' + (inputLength - offset) + '\"');\n\t}\n\n\tif (maxEncodedParamLength < sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar sOffset = offset;\n\toffset += sLength;\n\n\tif (offset !== inputLength) {\n\t\tthrow new Error('Expected to consume entire buffer, but \"' + (inputLength - offset) + '\" bytes remain');\n\t}\n\n\tvar rPadding = paramBytes - rLength,\n\t\tsPadding = paramBytes - sLength;\n\n\tvar dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength);\n\n\tfor (offset = 0; offset < rPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, rOffset + Math.max(-rPadding, 0), rOffset + rLength);\n\n\toffset = paramBytes;\n\n\tfor (var o = offset; offset < o + sPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, sOffset + Math.max(-sPadding, 0), sOffset + sLength);\n\n\tdst = dst.toString('base64');\n\tdst = base64Url(dst);\n\n\treturn dst;\n}\n\nfunction countPadding(buf, start, stop) {\n\tvar padding = 0;\n\twhile (start + padding < stop && buf[start + padding] === 0) {\n\t\t++padding;\n\t}\n\n\tvar needsSign = buf[start + padding] >= MAX_OCTET;\n\tif (needsSign) {\n\t\t--padding;\n\t}\n\n\treturn padding;\n}\n\nfunction joseToDer(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\tvar signatureBytes = signature.length;\n\tif (signatureBytes !== paramBytes * 2) {\n\t\tthrow new TypeError('\"' + alg + '\" signatures must be \"' + paramBytes * 2 + '\" bytes, saw \"' + signatureBytes + '\"');\n\t}\n\n\tvar rPadding = countPadding(signature, 0, paramBytes);\n\tvar sPadding = countPadding(signature, paramBytes, signature.length);\n\tvar rLength = paramBytes - rPadding;\n\tvar sLength = paramBytes - sPadding;\n\n\tvar rsBytes = 1 + 1 + rLength + 1 + 1 + sLength;\n\n\tvar shortLength = rsBytes < MAX_OCTET;\n\n\tvar dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes);\n\n\tvar offset = 0;\n\tdst[offset++] = ENCODED_TAG_SEQ;\n\tif (shortLength) {\n\t\t// Bit 8 has value \"0\"\n\t\t// bits 7-1 give the length.\n\t\tdst[offset++] = rsBytes;\n\t} else {\n\t\t// Bit 8 of first octet has value \"1\"\n\t\t// bits 7-1 give the number of additional length octets.\n\t\tdst[offset++] = MAX_OCTET\t| 1;\n\t\t// length, base 256\n\t\tdst[offset++] = rsBytes & 0xff;\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = rLength;\n\tif (rPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\toffset += signature.copy(dst, offset, 0, paramBytes);\n\t} else {\n\t\toffset += signature.copy(dst, offset, rPadding, paramBytes);\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = sLength;\n\tif (sPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\tsignature.copy(dst, offset, paramBytes);\n\t} else {\n\t\tsignature.copy(dst, offset, paramBytes + sPadding);\n\t}\n\n\treturn dst;\n}\n\nmodule.exports = {\n\tderToJose: derToJose,\n\tjoseToDer: joseToDer\n};\n", "/*jshint node:true */\n'use strict';\nvar Buffer = require('buffer').Buffer; // browserify\nvar SlowBuffer = require('buffer').SlowBuffer;\n\nmodule.exports = bufferEq;\n\nfunction bufferEq(a, b) {\n\n  // shortcutting on type is necessary for correctness\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    return false;\n  }\n\n  // buffer sizes should be well-known information, so despite this\n  // shortcutting, it doesn't leak any information about the *contents* of the\n  // buffers.\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  var c = 0;\n  for (var i = 0; i < a.length; i++) {\n    /*jshint bitwise:false */\n    c |= a[i] ^ b[i]; // XOR\n  }\n  return c === 0;\n}\n\nbufferEq.install = function() {\n  Buffer.prototype.equal = SlowBuffer.prototype.equal = function equal(that) {\n    return bufferEq(this, that);\n  };\n};\n\nvar origBufEqual = Buffer.prototype.equal;\nvar origSlowBufEqual = SlowBuffer.prototype.equal;\nbufferEq.restore = function() {\n  Buffer.prototype.equal = origBufEqual;\n  SlowBuffer.prototype.equal = origSlowBufEqual;\n};\n", "var Buffer = require('safe-buffer').Buffer;\nvar crypto = require('crypto');\nvar formatEcdsa = require('ecdsa-sig-formatter');\nvar util = require('util');\n\nvar MSG_INVALID_ALGORITHM = '\"%s\" is not a valid algorithm.\\n  Supported algorithms are:\\n  \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"PS256\", \"PS384\", \"PS512\", \"ES256\", \"ES384\", \"ES512\" and \"none\".'\nvar MSG_INVALID_SECRET = 'secret must be a string or buffer';\nvar MSG_INVALID_VERIFIER_KEY = 'key must be a string or a buffer';\nvar MSG_INVALID_SIGNER_KEY = 'key must be a string, a buffer or an object';\n\nvar supportsKeyObjects = typeof crypto.createPublicKey === 'function';\nif (supportsKeyObjects) {\n  MSG_INVALID_VERIFIER_KEY += ' or a KeyObject';\n  MSG_INVALID_SECRET += 'or a KeyObject';\n}\n\nfunction checkIsPublicKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return;\n  }\n\n  if (!supportsKeyObjects) {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key !== 'object') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.type !== 'string') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.asymmetricKeyType !== 'string') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.export !== 'function') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n};\n\nfunction checkIsPrivateKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return;\n  }\n\n  if (typeof key === 'object') {\n    return;\n  }\n\n  throw typeError(MSG_INVALID_SIGNER_KEY);\n};\n\nfunction checkIsSecretKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return key;\n  }\n\n  if (!supportsKeyObjects) {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (typeof key !== 'object') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (key.type !== 'secret') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (typeof key.export !== 'function') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n}\n\nfunction fromBase64(base64) {\n  return base64\n    .replace(/=/g, '')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_');\n}\n\nfunction toBase64(base64url) {\n  base64url = base64url.toString();\n\n  var padding = 4 - base64url.length % 4;\n  if (padding !== 4) {\n    for (var i = 0; i < padding; ++i) {\n      base64url += '=';\n    }\n  }\n\n  return base64url\n    .replace(/\\-/g, '+')\n    .replace(/_/g, '/');\n}\n\nfunction typeError(template) {\n  var args = [].slice.call(arguments, 1);\n  var errMsg = util.format.bind(util, template).apply(null, args);\n  return new TypeError(errMsg);\n}\n\nfunction bufferOrString(obj) {\n  return Buffer.isBuffer(obj) || typeof obj === 'string';\n}\n\nfunction normalizeInput(thing) {\n  if (!bufferOrString(thing))\n    thing = JSON.stringify(thing);\n  return thing;\n}\n\nfunction createHmacSigner(bits) {\n  return function sign(thing, secret) {\n    checkIsSecretKey(secret);\n    thing = normalizeInput(thing);\n    var hmac = crypto.createHmac('sha' + bits, secret);\n    var sig = (hmac.update(thing), hmac.digest('base64'))\n    return fromBase64(sig);\n  }\n}\n\nvar bufferEqual;\nvar timingSafeEqual = 'timingSafeEqual' in crypto ? function timingSafeEqual(a, b) {\n  if (a.byteLength !== b.byteLength) {\n    return false;\n  }\n\n  return crypto.timingSafeEqual(a, b)\n} : function timingSafeEqual(a, b) {\n  if (!bufferEqual) {\n    bufferEqual = require('buffer-equal-constant-time');\n  }\n\n  return bufferEqual(a, b)\n}\n\nfunction createHmacVerifier(bits) {\n  return function verify(thing, signature, secret) {\n    var computedSig = createHmacSigner(bits)(thing, secret);\n    return timingSafeEqual(Buffer.from(signature), Buffer.from(computedSig));\n  }\n}\n\nfunction createKeySigner(bits) {\n return function sign(thing, privateKey) {\n    checkIsPrivateKey(privateKey);\n    thing = normalizeInput(thing);\n    // Even though we are specifying \"RSA\" here, this works with ECDSA\n    // keys as well.\n    var signer = crypto.createSign('RSA-SHA' + bits);\n    var sig = (signer.update(thing), signer.sign(privateKey, 'base64'));\n    return fromBase64(sig);\n  }\n}\n\nfunction createKeyVerifier(bits) {\n  return function verify(thing, signature, publicKey) {\n    checkIsPublicKey(publicKey);\n    thing = normalizeInput(thing);\n    signature = toBase64(signature);\n    var verifier = crypto.createVerify('RSA-SHA' + bits);\n    verifier.update(thing);\n    return verifier.verify(publicKey, signature, 'base64');\n  }\n}\n\nfunction createPSSKeySigner(bits) {\n  return function sign(thing, privateKey) {\n    checkIsPrivateKey(privateKey);\n    thing = normalizeInput(thing);\n    var signer = crypto.createSign('RSA-SHA' + bits);\n    var sig = (signer.update(thing), signer.sign({\n      key: privateKey,\n      padding: crypto.constants.RSA_PKCS1_PSS_PADDING,\n      saltLength: crypto.constants.RSA_PSS_SALTLEN_DIGEST\n    }, 'base64'));\n    return fromBase64(sig);\n  }\n}\n\nfunction createPSSKeyVerifier(bits) {\n  return function verify(thing, signature, publicKey) {\n    checkIsPublicKey(publicKey);\n    thing = normalizeInput(thing);\n    signature = toBase64(signature);\n    var verifier = crypto.createVerify('RSA-SHA' + bits);\n    verifier.update(thing);\n    return verifier.verify({\n      key: publicKey,\n      padding: crypto.constants.RSA_PKCS1_PSS_PADDING,\n      saltLength: crypto.constants.RSA_PSS_SALTLEN_DIGEST\n    }, signature, 'base64');\n  }\n}\n\nfunction createECDSASigner(bits) {\n  var inner = createKeySigner(bits);\n  return function sign() {\n    var signature = inner.apply(null, arguments);\n    signature = formatEcdsa.derToJose(signature, 'ES' + bits);\n    return signature;\n  };\n}\n\nfunction createECDSAVerifer(bits) {\n  var inner = createKeyVerifier(bits);\n  return function verify(thing, signature, publicKey) {\n    signature = formatEcdsa.joseToDer(signature, 'ES' + bits).toString('base64');\n    var result = inner(thing, signature, publicKey);\n    return result;\n  };\n}\n\nfunction createNoneSigner() {\n  return function sign() {\n    return '';\n  }\n}\n\nfunction createNoneVerifier() {\n  return function verify(thing, signature) {\n    return signature === '';\n  }\n}\n\nmodule.exports = function jwa(algorithm) {\n  var signerFactories = {\n    hs: createHmacSigner,\n    rs: createKeySigner,\n    ps: createPSSKeySigner,\n    es: createECDSASigner,\n    none: createNoneSigner,\n  }\n  var verifierFactories = {\n    hs: createHmacVerifier,\n    rs: createKeyVerifier,\n    ps: createPSSKeyVerifier,\n    es: createECDSAVerifer,\n    none: createNoneVerifier,\n  }\n  var match = algorithm.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);\n  if (!match)\n    throw typeError(MSG_INVALID_ALGORITHM, algorithm);\n  var algo = (match[1] || match[3]).toLowerCase();\n  var bits = match[2];\n\n  return {\n    sign: signerFactories[algo](bits),\n    verify: verifierFactories[algo](bits),\n  }\n};\n", "/*global module*/\nvar Buffer = require('buffer').Buffer;\n\nmodule.exports = function toString(obj) {\n  if (typeof obj === 'string')\n    return obj;\n  if (typeof obj === 'number' || Buffer.isBuffer(obj))\n    return obj.toString();\n  return JSON.stringify(obj);\n};\n", "/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\n\nfunction base64url(string, encoding) {\n  return Buffer\n    .from(string, encoding)\n    .toString('base64')\n    .replace(/=/g, '')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_');\n}\n\nfunction jwsSecuredInput(header, payload, encoding) {\n  encoding = encoding || 'utf8';\n  var encodedHeader = base64url(toString(header), 'binary');\n  var encodedPayload = base64url(toString(payload), encoding);\n  return util.format('%s.%s', encodedHeader, encodedPayload);\n}\n\nfunction jwsSign(opts) {\n  var header = opts.header;\n  var payload = opts.payload;\n  var secretOrKey = opts.secret || opts.privateKey;\n  var encoding = opts.encoding;\n  var algo = jwa(header.alg);\n  var securedInput = jwsSecuredInput(header, payload, encoding);\n  var signature = algo.sign(securedInput, secretOrKey);\n  return util.format('%s.%s', securedInput, signature);\n}\n\nfunction SignStream(opts) {\n  var secret = opts.secret;\n  secret = secret == null ? opts.privateKey : secret;\n  secret = secret == null ? opts.key : secret;\n  if (/^hs/i.test(opts.header.alg) === true && secret == null) {\n    throw new TypeError('secret must be a string or buffer or a KeyObject')\n  }\n  var secretStream = new DataStream(secret);\n  this.readable = true;\n  this.header = opts.header;\n  this.encoding = opts.encoding;\n  this.secret = this.privateKey = this.key = secretStream;\n  this.payload = new DataStream(opts.payload);\n  this.secret.once('close', function () {\n    if (!this.payload.writable && this.readable)\n      this.sign();\n  }.bind(this));\n\n  this.payload.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.sign();\n  }.bind(this));\n}\nutil.inherits(SignStream, Stream);\n\nSignStream.prototype.sign = function sign() {\n  try {\n    var signature = jwsSign({\n      header: this.header,\n      payload: this.payload.buffer,\n      secret: this.secret.buffer,\n      encoding: this.encoding\n    });\n    this.emit('done', signature);\n    this.emit('data', signature);\n    this.emit('end');\n    this.readable = false;\n    return signature;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nSignStream.sign = jwsSign;\n\nmodule.exports = SignStream;\n", "/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction safeJsonParse(thing) {\n  if (isObject(thing))\n    return thing;\n  try { return JSON.parse(thing); }\n  catch (e) { return undefined; }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(Buffer.from(encodedHeader, 'base64').toString('binary'));\n}\n\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\n\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\n\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return Buffer.from(payload, 'base64').toString(encoding);\n}\n\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\n\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\n\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n\n  if (!isValidJws(jwsSig))\n    return null;\n\n  var header = headerFromJWS(jwsSig);\n\n  if (!header)\n    return null;\n\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json)\n    payload = JSON.parse(payload, opts.encoding);\n\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\n\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret;\n  secretOrKey = secretOrKey == null ? opts.publicKey : secretOrKey;\n  secretOrKey = secretOrKey == null ? opts.key : secretOrKey;\n  if (/^hs/i.test(opts.algorithm) === true && secretOrKey == null) {\n    throw new TypeError('secret must be a string or buffer or a KeyObject')\n  }\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable)\n      this.verify();\n  }.bind(this));\n\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\n\nmodule.exports = VerifyStream;\n", "/*global exports*/\nvar SignStream = require('./lib/sign-stream');\nvar VerifyStream = require('./lib/verify-stream');\n\nvar ALGORITHMS = [\n  'HS256', 'HS384', 'HS512',\n  'RS256', 'RS384', 'RS512',\n  'PS256', 'PS384', 'PS512',\n  'ES256', 'ES384', 'ES512'\n];\n\nexports.ALGORITHMS = ALGORITHMS;\nexports.sign = SignStream.sign;\nexports.verify = VerifyStream.verify;\nexports.decode = VerifyStream.decode;\nexports.isValid = VerifyStream.isValid;\nexports.createSign = function createSign(opts) {\n  return new SignStream(opts);\n};\nexports.createVerify = function createVerify(opts) {\n  return new VerifyStream(opts);\n};\n", "var jws = require('jws');\n\nmodule.exports = function (jwt, options) {\n  options = options || {};\n  var decoded = jws.decode(jwt, options);\n  if (!decoded) { return null; }\n  var payload = decoded.payload;\n\n  //try parse the payload\n  if(typeof payload === 'string') {\n    try {\n      var obj = JSON.parse(payload);\n      if(obj !== null && typeof obj === 'object') {\n        payload = obj;\n      }\n    } catch (e) { }\n  }\n\n  //return header if `complete` option is enabled.  header includes claims\n  //such as `kid` and `alg` used to select the key within a JWKS needed to\n  //verify the signature\n  if (options.complete === true) {\n    return {\n      header: decoded.header,\n      payload: payload,\n      signature: decoded.signature\n    };\n  }\n  return payload;\n};\n", "var JsonWebTokenError = function (message, error) {\n  Error.call(this, message);\n  if(Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  }\n  this.name = 'JsonWebTokenError';\n  this.message = message;\n  if (error) this.inner = error;\n};\n\nJsonWebTokenError.prototype = Object.create(Error.prototype);\nJsonWebTokenError.prototype.constructor = JsonWebTokenError;\n\nmodule.exports = JsonWebTokenError;\n", "var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar NotBeforeError = function (message, date) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'NotBeforeError';\n  this.date = date;\n};\n\nNotBeforeError.prototype = Object.create(JsonWebTokenError.prototype);\n\nNotBeforeError.prototype.constructor = NotBeforeError;\n\nmodule.exports = NotBeforeError;", "var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar TokenExpiredError = function (message, expiredAt) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'TokenExpiredError';\n  this.expiredAt = expiredAt;\n};\n\nTokenExpiredError.prototype = Object.create(JsonWebTokenError.prototype);\n\nTokenExpiredError.prototype.constructor = TokenExpiredError;\n\nmodule.exports = TokenExpiredError;", "/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n", "var ms = require('ms');\n\nmodule.exports = function (time, iat) {\n  var timestamp = iat || Math.floor(Date.now() / 1000);\n\n  if (typeof time === 'string') {\n    var milliseconds = ms(time);\n    if (typeof milliseconds === 'undefined') {\n      return;\n    }\n    return Math.floor(timestamp + milliseconds / 1000);\n  } else if (typeof time === 'number') {\n    return timestamp + time;\n  } else {\n    return;\n  }\n\n};", "'use strict'\n\n// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nconst SEMVER_SPEC_VERSION = '2.0.0'\n\nconst MAX_LENGTH = 256\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n/* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nconst MAX_SAFE_COMPONENT_LENGTH = 16\n\n// Max safe length for a build identifier. The max length minus 6 characters for\n// the shortest version with a build 0.0.0+BUILD.\nconst MAX_SAFE_BUILD_LENGTH = MAX_LENGTH - 6\n\nconst RELEASE_TYPES = [\n  'major',\n  'premajor',\n  'minor',\n  'preminor',\n  'patch',\n  'prepatch',\n  'prerelease',\n]\n\nmodule.exports = {\n  MAX_LENGTH,\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_SAFE_INTEGER,\n  RELEASE_TYPES,\n  SEMVER_SPEC_VERSION,\n  FLAG_INCLUDE_PRERELEASE: 0b001,\n  FLAG_LOOSE: 0b010,\n}\n", "'use strict'\n\nconst debug = (\n  typeof process === 'object' &&\n  process.env &&\n  process.env.NODE_DEBUG &&\n  /\\bsemver\\b/i.test(process.env.NODE_DEBUG)\n) ? (...args) => console.error('SEMVER', ...args)\n  : () => {}\n\nmodule.exports = debug\n", "'use strict'\n\nconst {\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_LENGTH,\n} = require('./constants')\nconst debug = require('./debug')\nexports = module.exports = {}\n\n// The actual regexps go on exports.re\nconst re = exports.re = []\nconst safeRe = exports.safeRe = []\nconst src = exports.src = []\nconst safeSrc = exports.safeSrc = []\nconst t = exports.t = {}\nlet R = 0\n\nconst LETTERDASHNUMBER = '[a-zA-Z0-9-]'\n\n// Replace some greedy regex tokens to prevent regex dos issues. These regex are\n// used internally via the safeRe object since all inputs in this library get\n// normalized first to trim and collapse all extra whitespace. The original\n// regexes are exported for userland consumption and lower level usage. A\n// future breaking change could export the safer regex only with a note that\n// all input should have extra whitespace removed.\nconst safeRegexReplacements = [\n  ['\\\\s', 1],\n  ['\\\\d', MAX_LENGTH],\n  [LETTERDASHNUMBER, MAX_SAFE_BUILD_LENGTH],\n]\n\nconst makeSafeRegex = (value) => {\n  for (const [token, max] of safeRegexReplacements) {\n    value = value\n      .split(`${token}*`).join(`${token}{0,${max}}`)\n      .split(`${token}+`).join(`${token}{1,${max}}`)\n  }\n  return value\n}\n\nconst createToken = (name, value, isGlobal) => {\n  const safe = makeSafeRegex(value)\n  const index = R++\n  debug(name, index, value)\n  t[name] = index\n  src[index] = value\n  safeSrc[index] = safe\n  re[index] = new RegExp(value, isGlobal ? 'g' : undefined)\n  safeRe[index] = new RegExp(safe, isGlobal ? 'g' : undefined)\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ncreateToken('NUMERICIDENTIFIER', '0|[1-9]\\\\d*')\ncreateToken('NUMERICIDENTIFIERLOOSE', '\\\\d+')\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ncreateToken('NONNUMERICIDENTIFIER', `\\\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`)\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ncreateToken('MAINVERSION', `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('MAINVERSIONLOOSE', `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n// Non-numberic identifiers include numberic identifiers but can be longer.\n// Therefore non-numberic identifiers must go first.\n\ncreateToken('PRERELEASEIDENTIFIER', `(?:${src[t.NONNUMERICIDENTIFIER]\n}|${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('PRERELEASEIDENTIFIERLOOSE', `(?:${src[t.NONNUMERICIDENTIFIER]\n}|${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ncreateToken('PRERELEASE', `(?:-(${src[t.PRERELEASEIDENTIFIER]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIER]})*))`)\n\ncreateToken('PRERELEASELOOSE', `(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ncreateToken('BUILDIDENTIFIER', `${LETTERDASHNUMBER}+`)\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ncreateToken('BUILD', `(?:\\\\+(${src[t.BUILDIDENTIFIER]\n}(?:\\\\.${src[t.BUILDIDENTIFIER]})*))`)\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ncreateToken('FULLPLAIN', `v?${src[t.MAINVERSION]\n}${src[t.PRERELEASE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('FULL', `^${src[t.FULLPLAIN]}$`)\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ncreateToken('LOOSEPLAIN', `[v=\\\\s]*${src[t.MAINVERSIONLOOSE]\n}${src[t.PRERELEASELOOSE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('LOOSE', `^${src[t.LOOSEPLAIN]}$`)\n\ncreateToken('GTLT', '((?:<|>)?=?)')\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ncreateToken('XRANGEIDENTIFIERLOOSE', `${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`)\ncreateToken('XRANGEIDENTIFIER', `${src[t.NUMERICIDENTIFIER]}|x|X|\\\\*`)\n\ncreateToken('XRANGEPLAIN', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:${src[t.PRERELEASE]})?${\n                     src[t.BUILD]}?` +\n                   `)?)?`)\n\ncreateToken('XRANGEPLAINLOOSE', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:${src[t.PRERELEASELOOSE]})?${\n                          src[t.BUILD]}?` +\n                        `)?)?`)\n\ncreateToken('XRANGE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAIN]}$`)\ncreateToken('XRANGELOOSE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ncreateToken('COERCEPLAIN', `${'(^|[^\\\\d])' +\n              '(\\\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`)\ncreateToken('COERCE', `${src[t.COERCEPLAIN]}(?:$|[^\\\\d])`)\ncreateToken('COERCEFULL', src[t.COERCEPLAIN] +\n              `(?:${src[t.PRERELEASE]})?` +\n              `(?:${src[t.BUILD]})?` +\n              `(?:$|[^\\\\d])`)\ncreateToken('COERCERTL', src[t.COERCE], true)\ncreateToken('COERCERTLFULL', src[t.COERCEFULL], true)\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ncreateToken('LONETILDE', '(?:~>?)')\n\ncreateToken('TILDETRIM', `(\\\\s*)${src[t.LONETILDE]}\\\\s+`, true)\nexports.tildeTrimReplace = '$1~'\n\ncreateToken('TILDE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('TILDELOOSE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ncreateToken('LONECARET', '(?:\\\\^)')\n\ncreateToken('CARETTRIM', `(\\\\s*)${src[t.LONECARET]}\\\\s+`, true)\nexports.caretTrimReplace = '$1^'\n\ncreateToken('CARET', `^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('CARETLOOSE', `^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ncreateToken('COMPARATORLOOSE', `^${src[t.GTLT]}\\\\s*(${src[t.LOOSEPLAIN]})$|^$`)\ncreateToken('COMPARATOR', `^${src[t.GTLT]}\\\\s*(${src[t.FULLPLAIN]})$|^$`)\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ncreateToken('COMPARATORTRIM', `(\\\\s*)${src[t.GTLT]\n}\\\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`, true)\nexports.comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ncreateToken('HYPHENRANGE', `^\\\\s*(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s+-\\\\s+` +\n                   `(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s*$`)\n\ncreateToken('HYPHENRANGELOOSE', `^\\\\s*(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s+-\\\\s+` +\n                        `(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s*$`)\n\n// Star ranges basically just allow anything at all.\ncreateToken('STAR', '(<|>)?=?\\\\s*\\\\*')\n// >=0.0.0 is like a star\ncreateToken('GTE0', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0\\\\s*$')\ncreateToken('GTE0PRE', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0-0\\\\s*$')\n", "'use strict'\n\n// parse out just the options we care about\nconst looseOption = Object.freeze({ loose: true })\nconst emptyOpts = Object.freeze({ })\nconst parseOptions = options => {\n  if (!options) {\n    return emptyOpts\n  }\n\n  if (typeof options !== 'object') {\n    return looseOption\n  }\n\n  return options\n}\nmodule.exports = parseOptions\n", "'use strict'\n\nconst numeric = /^[0-9]+$/\nconst compareIdentifiers = (a, b) => {\n  if (typeof a === 'number' && typeof b === 'number') {\n    return a === b ? 0 : a < b ? -1 : 1\n  }\n\n  const anum = numeric.test(a)\n  const bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nconst rcompareIdentifiers = (a, b) => compareIdentifiers(b, a)\n\nmodule.exports = {\n  compareIdentifiers,\n  rcompareIdentifiers,\n}\n", "'use strict'\n\nconst debug = require('../internal/debug')\nconst { MAX_LENGTH, MAX_SAFE_INTEGER } = require('../internal/constants')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst parseOptions = require('../internal/parse-options')\nconst { compareIdentifiers } = require('../internal/identifiers')\nclass SemVer {\n  constructor (version, options) {\n    options = parseOptions(options)\n\n    if (version instanceof SemVer) {\n      if (version.loose === !!options.loose &&\n        version.includePrerelease === !!options.includePrerelease) {\n        return version\n      } else {\n        version = version.version\n      }\n    } else if (typeof version !== 'string') {\n      throw new TypeError(`Invalid version. Must be a string. Got type \"${typeof version}\".`)\n    }\n\n    if (version.length > MAX_LENGTH) {\n      throw new TypeError(\n        `version is longer than ${MAX_LENGTH} characters`\n      )\n    }\n\n    debug('SemVer', version, options)\n    this.options = options\n    this.loose = !!options.loose\n    // this isn't actually relevant for versions, but keep it so that we\n    // don't run into trouble passing this.options around.\n    this.includePrerelease = !!options.includePrerelease\n\n    const m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n    if (!m) {\n      throw new TypeError(`Invalid Version: ${version}`)\n    }\n\n    this.raw = version\n\n    // these are actually numbers\n    this.major = +m[1]\n    this.minor = +m[2]\n    this.patch = +m[3]\n\n    if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n      throw new TypeError('Invalid major version')\n    }\n\n    if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n      throw new TypeError('Invalid minor version')\n    }\n\n    if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n      throw new TypeError('Invalid patch version')\n    }\n\n    // numberify any prerelease numeric ids\n    if (!m[4]) {\n      this.prerelease = []\n    } else {\n      this.prerelease = m[4].split('.').map((id) => {\n        if (/^[0-9]+$/.test(id)) {\n          const num = +id\n          if (num >= 0 && num < MAX_SAFE_INTEGER) {\n            return num\n          }\n        }\n        return id\n      })\n    }\n\n    this.build = m[5] ? m[5].split('.') : []\n    this.format()\n  }\n\n  format () {\n    this.version = `${this.major}.${this.minor}.${this.patch}`\n    if (this.prerelease.length) {\n      this.version += `-${this.prerelease.join('.')}`\n    }\n    return this.version\n  }\n\n  toString () {\n    return this.version\n  }\n\n  compare (other) {\n    debug('SemVer.compare', this.version, this.options, other)\n    if (!(other instanceof SemVer)) {\n      if (typeof other === 'string' && other === this.version) {\n        return 0\n      }\n      other = new SemVer(other, this.options)\n    }\n\n    if (other.version === this.version) {\n      return 0\n    }\n\n    return this.compareMain(other) || this.comparePre(other)\n  }\n\n  compareMain (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    if (this.major < other.major) {\n      return -1\n    }\n    if (this.major > other.major) {\n      return 1\n    }\n    if (this.minor < other.minor) {\n      return -1\n    }\n    if (this.minor > other.minor) {\n      return 1\n    }\n    if (this.patch < other.patch) {\n      return -1\n    }\n    if (this.patch > other.patch) {\n      return 1\n    }\n    return 0\n  }\n\n  comparePre (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    // NOT having a prerelease is > having one\n    if (this.prerelease.length && !other.prerelease.length) {\n      return -1\n    } else if (!this.prerelease.length && other.prerelease.length) {\n      return 1\n    } else if (!this.prerelease.length && !other.prerelease.length) {\n      return 0\n    }\n\n    let i = 0\n    do {\n      const a = this.prerelease[i]\n      const b = other.prerelease[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  compareBuild (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    let i = 0\n    do {\n      const a = this.build[i]\n      const b = other.build[i]\n      debug('build compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  // preminor will bump the version up to the next minor release, and immediately\n  // down to pre-release. premajor and prepatch work the same way.\n  inc (release, identifier, identifierBase) {\n    if (release.startsWith('pre')) {\n      if (!identifier && identifierBase === false) {\n        throw new Error('invalid increment argument: identifier is empty')\n      }\n      // Avoid an invalid semver results\n      if (identifier) {\n        const match = `-${identifier}`.match(this.options.loose ? re[t.PRERELEASELOOSE] : re[t.PRERELEASE])\n        if (!match || match[1] !== identifier) {\n          throw new Error(`invalid identifier: ${identifier}`)\n        }\n      }\n    }\n\n    switch (release) {\n      case 'premajor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor = 0\n        this.major++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'preminor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'prepatch':\n        // If this is already a prerelease, it will bump to the next version\n        // drop any prereleases that might already exist, since they are not\n        // relevant at this point.\n        this.prerelease.length = 0\n        this.inc('patch', identifier, identifierBase)\n        this.inc('pre', identifier, identifierBase)\n        break\n      // If the input is a non-prerelease version, this acts the same as\n      // prepatch.\n      case 'prerelease':\n        if (this.prerelease.length === 0) {\n          this.inc('patch', identifier, identifierBase)\n        }\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'release':\n        if (this.prerelease.length === 0) {\n          throw new Error(`version ${this.raw} is not a prerelease`)\n        }\n        this.prerelease.length = 0\n        break\n\n      case 'major':\n        // If this is a pre-major version, bump up to the same major version.\n        // Otherwise increment major.\n        // 1.0.0-5 bumps to 1.0.0\n        // 1.1.0 bumps to 2.0.0\n        if (\n          this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0\n        ) {\n          this.major++\n        }\n        this.minor = 0\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'minor':\n        // If this is a pre-minor version, bump up to the same minor version.\n        // Otherwise increment minor.\n        // 1.2.0-5 bumps to 1.2.0\n        // 1.2.1 bumps to 1.3.0\n        if (this.patch !== 0 || this.prerelease.length === 0) {\n          this.minor++\n        }\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'patch':\n        // If this is not a pre-release version, it will increment the patch.\n        // If it is a pre-release it will bump up to the same patch version.\n        // 1.2.0-5 patches to 1.2.0\n        // 1.2.0 patches to 1.2.1\n        if (this.prerelease.length === 0) {\n          this.patch++\n        }\n        this.prerelease = []\n        break\n      // This probably shouldn't be used publicly.\n      // 1.0.0 'pre' would become 1.0.0-0 which is the wrong direction.\n      case 'pre': {\n        const base = Number(identifierBase) ? 1 : 0\n\n        if (this.prerelease.length === 0) {\n          this.prerelease = [base]\n        } else {\n          let i = this.prerelease.length\n          while (--i >= 0) {\n            if (typeof this.prerelease[i] === 'number') {\n              this.prerelease[i]++\n              i = -2\n            }\n          }\n          if (i === -1) {\n            // didn't increment anything\n            if (identifier === this.prerelease.join('.') && identifierBase === false) {\n              throw new Error('invalid increment argument: identifier already exists')\n            }\n            this.prerelease.push(base)\n          }\n        }\n        if (identifier) {\n          // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n          // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n          let prerelease = [identifier, base]\n          if (identifierBase === false) {\n            prerelease = [identifier]\n          }\n          if (compareIdentifiers(this.prerelease[0], identifier) === 0) {\n            if (isNaN(this.prerelease[1])) {\n              this.prerelease = prerelease\n            }\n          } else {\n            this.prerelease = prerelease\n          }\n        }\n        break\n      }\n      default:\n        throw new Error(`invalid increment argument: ${release}`)\n    }\n    this.raw = this.format()\n    if (this.build.length) {\n      this.raw += `+${this.build.join('.')}`\n    }\n    return this\n  }\n}\n\nmodule.exports = SemVer\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst parse = (version, options, throwErrors = false) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    if (!throwErrors) {\n      return null\n    }\n    throw er\n  }\n}\n\nmodule.exports = parse\n", "'use strict'\n\nconst parse = require('./parse')\nconst valid = (version, options) => {\n  const v = parse(version, options)\n  return v ? v.version : null\n}\nmodule.exports = valid\n", "'use strict'\n\nconst parse = require('./parse')\nconst clean = (version, options) => {\n  const s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\nmodule.exports = clean\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\n\nconst inc = (version, release, options, identifier, identifierBase) => {\n  if (typeof (options) === 'string') {\n    identifierBase = identifier\n    identifier = options\n    options = undefined\n  }\n\n  try {\n    return new SemVer(\n      version instanceof SemVer ? version.version : version,\n      options\n    ).inc(release, identifier, identifierBase).version\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = inc\n", "'use strict'\n\nconst parse = require('./parse.js')\n\nconst diff = (version1, version2) => {\n  const v1 = parse(version1, null, true)\n  const v2 = parse(version2, null, true)\n  const comparison = v1.compare(v2)\n\n  if (comparison === 0) {\n    return null\n  }\n\n  const v1Higher = comparison > 0\n  const highVersion = v1Higher ? v1 : v2\n  const lowVersion = v1Higher ? v2 : v1\n  const highHasPre = !!highVersion.prerelease.length\n  const lowHasPre = !!lowVersion.prerelease.length\n\n  if (lowHasPre && !highHasPre) {\n    // Going from prerelease -> no prerelease requires some special casing\n\n    // If the low version has only a major, then it will always be a major\n    // Some examples:\n    // 1.0.0-1 -> 1.0.0\n    // 1.0.0-1 -> 1.1.1\n    // 1.0.0-1 -> 2.0.0\n    if (!lowVersion.patch && !lowVersion.minor) {\n      return 'major'\n    }\n\n    // If the main part has no difference\n    if (lowVersion.compareMain(highVersion) === 0) {\n      if (lowVersion.minor && !lowVersion.patch) {\n        return 'minor'\n      }\n      return 'patch'\n    }\n  }\n\n  // add the `pre` prefix if we are going to a prerelease version\n  const prefix = highHasPre ? 'pre' : ''\n\n  if (v1.major !== v2.major) {\n    return prefix + 'major'\n  }\n\n  if (v1.minor !== v2.minor) {\n    return prefix + 'minor'\n  }\n\n  if (v1.patch !== v2.patch) {\n    return prefix + 'patch'\n  }\n\n  // high and low are preleases\n  return 'prerelease'\n}\n\nmodule.exports = diff\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst major = (a, loose) => new SemVer(a, loose).major\nmodule.exports = major\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst minor = (a, loose) => new SemVer(a, loose).minor\nmodule.exports = minor\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst patch = (a, loose) => new SemVer(a, loose).patch\nmodule.exports = patch\n", "'use strict'\n\nconst parse = require('./parse')\nconst prerelease = (version, options) => {\n  const parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\nmodule.exports = prerelease\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst compare = (a, b, loose) =>\n  new SemVer(a, loose).compare(new SemVer(b, loose))\n\nmodule.exports = compare\n", "'use strict'\n\nconst compare = require('./compare')\nconst rcompare = (a, b, loose) => compare(b, a, loose)\nmodule.exports = rcompare\n", "'use strict'\n\nconst compare = require('./compare')\nconst compareLoose = (a, b) => compare(a, b, true)\nmodule.exports = compareLoose\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst compareBuild = (a, b, loose) => {\n  const versionA = new SemVer(a, loose)\n  const versionB = new SemVer(b, loose)\n  return versionA.compare(versionB) || versionA.compareBuild(versionB)\n}\nmodule.exports = compareBuild\n", "'use strict'\n\nconst compareBuild = require('./compare-build')\nconst sort = (list, loose) => list.sort((a, b) => compareBuild(a, b, loose))\nmodule.exports = sort\n", "'use strict'\n\nconst compareBuild = require('./compare-build')\nconst rsort = (list, loose) => list.sort((a, b) => compareBuild(b, a, loose))\nmodule.exports = rsort\n", "'use strict'\n\nconst compare = require('./compare')\nconst gt = (a, b, loose) => compare(a, b, loose) > 0\nmodule.exports = gt\n", "'use strict'\n\nconst compare = require('./compare')\nconst lt = (a, b, loose) => compare(a, b, loose) < 0\nmodule.exports = lt\n", "'use strict'\n\nconst compare = require('./compare')\nconst eq = (a, b, loose) => compare(a, b, loose) === 0\nmodule.exports = eq\n", "'use strict'\n\nconst compare = require('./compare')\nconst neq = (a, b, loose) => compare(a, b, loose) !== 0\nmodule.exports = neq\n", "'use strict'\n\nconst compare = require('./compare')\nconst gte = (a, b, loose) => compare(a, b, loose) >= 0\nmodule.exports = gte\n", "'use strict'\n\nconst compare = require('./compare')\nconst lte = (a, b, loose) => compare(a, b, loose) <= 0\nmodule.exports = lte\n", "'use strict'\n\nconst eq = require('./eq')\nconst neq = require('./neq')\nconst gt = require('./gt')\nconst gte = require('./gte')\nconst lt = require('./lt')\nconst lte = require('./lte')\n\nconst cmp = (a, op, b, loose) => {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError(`Invalid operator: ${op}`)\n  }\n}\nmodule.exports = cmp\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst parse = require('./parse')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst coerce = (version, options) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version === 'number') {\n    version = String(version)\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  options = options || {}\n\n  let match = null\n  if (!options.rtl) {\n    match = version.match(options.includePrerelease ? re[t.COERCEFULL] : re[t.COERCE])\n  } else {\n    // Find the right-most coercible string that does not share\n    // a terminus with a more left-ward coercible string.\n    // Eg, '1.2.3.4' wants to coerce '2.3.4', not '3.4' or '4'\n    // With includePrerelease option set, '1.2.3.4-rc' wants to coerce '2.3.4-rc', not '2.3.4'\n    //\n    // Walk through the string checking with a /g regexp\n    // Manually set the index so as to pick up overlapping matches.\n    // Stop when we get a match that ends at the string end, since no\n    // coercible string can be more right-ward without the same terminus.\n    const coerceRtlRegex = options.includePrerelease ? re[t.COERCERTLFULL] : re[t.COERCERTL]\n    let next\n    while ((next = coerceRtlRegex.exec(version)) &&\n        (!match || match.index + match[0].length !== version.length)\n    ) {\n      if (!match ||\n            next.index + next[0].length !== match.index + match[0].length) {\n        match = next\n      }\n      coerceRtlRegex.lastIndex = next.index + next[1].length + next[2].length\n    }\n    // leave it in a clean state\n    coerceRtlRegex.lastIndex = -1\n  }\n\n  if (match === null) {\n    return null\n  }\n\n  const major = match[2]\n  const minor = match[3] || '0'\n  const patch = match[4] || '0'\n  const prerelease = options.includePrerelease && match[5] ? `-${match[5]}` : ''\n  const build = options.includePrerelease && match[6] ? `+${match[6]}` : ''\n\n  return parse(`${major}.${minor}.${patch}${prerelease}${build}`, options)\n}\nmodule.exports = coerce\n", "'use strict'\n\nclass LRUCache {\n  constructor () {\n    this.max = 1000\n    this.map = new Map()\n  }\n\n  get (key) {\n    const value = this.map.get(key)\n    if (value === undefined) {\n      return undefined\n    } else {\n      // Remove the key from the map and add it to the end\n      this.map.delete(key)\n      this.map.set(key, value)\n      return value\n    }\n  }\n\n  delete (key) {\n    return this.map.delete(key)\n  }\n\n  set (key, value) {\n    const deleted = this.delete(key)\n\n    if (!deleted && value !== undefined) {\n      // If cache is full, delete the least recently used item\n      if (this.map.size >= this.max) {\n        const firstKey = this.map.keys().next().value\n        this.delete(firstKey)\n      }\n\n      this.map.set(key, value)\n    }\n\n    return this\n  }\n}\n\nmodule.exports = LRUCache\n", "'use strict'\n\nconst SPACE_CHARACTERS = /\\s+/g\n\n// hoisted class for cyclic dependency\nclass Range {\n  constructor (range, options) {\n    options = parseOptions(options)\n\n    if (range instanceof Range) {\n      if (\n        range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease\n      ) {\n        return range\n      } else {\n        return new Range(range.raw, options)\n      }\n    }\n\n    if (range instanceof Comparator) {\n      // just put it in the set and return\n      this.raw = range.value\n      this.set = [[range]]\n      this.formatted = undefined\n      return this\n    }\n\n    this.options = options\n    this.loose = !!options.loose\n    this.includePrerelease = !!options.includePrerelease\n\n    // First reduce all whitespace as much as possible so we do not have to rely\n    // on potentially slow regexes like \\s*. This is then stored and used for\n    // future error messages as well.\n    this.raw = range.trim().replace(SPACE_CHARACTERS, ' ')\n\n    // First, split on ||\n    this.set = this.raw\n      .split('||')\n      // map the range to a 2d array of comparators\n      .map(r => this.parseRange(r.trim()))\n      // throw out any comparator lists that are empty\n      // this generally means that it was not a valid range, which is allowed\n      // in loose mode, but will still throw if the WHOLE range is invalid.\n      .filter(c => c.length)\n\n    if (!this.set.length) {\n      throw new TypeError(`Invalid SemVer Range: ${this.raw}`)\n    }\n\n    // if we have any that are not the null set, throw out null sets.\n    if (this.set.length > 1) {\n      // keep the first one, in case they're all null sets\n      const first = this.set[0]\n      this.set = this.set.filter(c => !isNullSet(c[0]))\n      if (this.set.length === 0) {\n        this.set = [first]\n      } else if (this.set.length > 1) {\n        // if we have any that are *, then the range is just *\n        for (const c of this.set) {\n          if (c.length === 1 && isAny(c[0])) {\n            this.set = [c]\n            break\n          }\n        }\n      }\n    }\n\n    this.formatted = undefined\n  }\n\n  get range () {\n    if (this.formatted === undefined) {\n      this.formatted = ''\n      for (let i = 0; i < this.set.length; i++) {\n        if (i > 0) {\n          this.formatted += '||'\n        }\n        const comps = this.set[i]\n        for (let k = 0; k < comps.length; k++) {\n          if (k > 0) {\n            this.formatted += ' '\n          }\n          this.formatted += comps[k].toString().trim()\n        }\n      }\n    }\n    return this.formatted\n  }\n\n  format () {\n    return this.range\n  }\n\n  toString () {\n    return this.range\n  }\n\n  parseRange (range) {\n    // memoize range parsing for performance.\n    // this is a very hot path, and fully deterministic.\n    const memoOpts =\n      (this.options.includePrerelease && FLAG_INCLUDE_PRERELEASE) |\n      (this.options.loose && FLAG_LOOSE)\n    const memoKey = memoOpts + ':' + range\n    const cached = cache.get(memoKey)\n    if (cached) {\n      return cached\n    }\n\n    const loose = this.options.loose\n    // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n    const hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n    range = range.replace(hr, hyphenReplace(this.options.includePrerelease))\n    debug('hyphen replace', range)\n\n    // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n    range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n    debug('comparator trim', range)\n\n    // `~ 1.2.3` => `~1.2.3`\n    range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n    debug('tilde trim', range)\n\n    // `^ 1.2.3` => `^1.2.3`\n    range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n    debug('caret trim', range)\n\n    // At this point, the range is completely trimmed and\n    // ready to be split into comparators.\n\n    let rangeList = range\n      .split(' ')\n      .map(comp => parseComparator(comp, this.options))\n      .join(' ')\n      .split(/\\s+/)\n      // >=0.0.0 is equivalent to *\n      .map(comp => replaceGTE0(comp, this.options))\n\n    if (loose) {\n      // in loose mode, throw out any that are not valid comparators\n      rangeList = rangeList.filter(comp => {\n        debug('loose invalid filter', comp, this.options)\n        return !!comp.match(re[t.COMPARATORLOOSE])\n      })\n    }\n    debug('range list', rangeList)\n\n    // if any comparators are the null set, then replace with JUST null set\n    // if more than one comparator, remove any * comparators\n    // also, don't include the same comparator more than once\n    const rangeMap = new Map()\n    const comparators = rangeList.map(comp => new Comparator(comp, this.options))\n    for (const comp of comparators) {\n      if (isNullSet(comp)) {\n        return [comp]\n      }\n      rangeMap.set(comp.value, comp)\n    }\n    if (rangeMap.size > 1 && rangeMap.has('')) {\n      rangeMap.delete('')\n    }\n\n    const result = [...rangeMap.values()]\n    cache.set(memoKey, result)\n    return result\n  }\n\n  intersects (range, options) {\n    if (!(range instanceof Range)) {\n      throw new TypeError('a Range is required')\n    }\n\n    return this.set.some((thisComparators) => {\n      return (\n        isSatisfiable(thisComparators, options) &&\n        range.set.some((rangeComparators) => {\n          return (\n            isSatisfiable(rangeComparators, options) &&\n            thisComparators.every((thisComparator) => {\n              return rangeComparators.every((rangeComparator) => {\n                return thisComparator.intersects(rangeComparator, options)\n              })\n            })\n          )\n        })\n      )\n    })\n  }\n\n  // if ANY of the sets match ALL of its comparators, then pass\n  test (version) {\n    if (!version) {\n      return false\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    for (let i = 0; i < this.set.length; i++) {\n      if (testSet(this.set[i], version, this.options)) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nmodule.exports = Range\n\nconst LRU = require('../internal/lrucache')\nconst cache = new LRU()\n\nconst parseOptions = require('../internal/parse-options')\nconst Comparator = require('./comparator')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst {\n  safeRe: re,\n  t,\n  comparatorTrimReplace,\n  tildeTrimReplace,\n  caretTrimReplace,\n} = require('../internal/re')\nconst { FLAG_INCLUDE_PRERELEASE, FLAG_LOOSE } = require('../internal/constants')\n\nconst isNullSet = c => c.value === '<0.0.0-0'\nconst isAny = c => c.value === ''\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nconst isSatisfiable = (comparators, options) => {\n  let result = true\n  const remainingComparators = comparators.slice()\n  let testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every((otherComparator) => {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nconst parseComparator = (comp, options) => {\n  comp = comp.replace(re[t.BUILD], '')\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nconst isX = id => !id || id.toLowerCase() === 'x' || id === '*'\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nconst replaceTildes = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceTilde(c, options))\n    .join(' ')\n}\n\nconst replaceTilde = (comp, options) => {\n  const r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('tilde', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = `>=${M}.${m}.${p}-${pr\n      } <${M}.${+m + 1}.0-0`\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nconst replaceCarets = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceCaret(c, options))\n    .join(' ')\n}\n\nconst replaceCaret = (comp, options) => {\n  debug('caret', comp, options)\n  const r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  const z = options.includePrerelease ? '-0' : ''\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('caret', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr\n        } <${+M + 1}.0.0-0`\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p\n        } <${+M + 1}.0.0-0`\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nconst replaceXRanges = (comp, options) => {\n  debug('replaceXRanges', comp, options)\n  return comp\n    .split(/\\s+/)\n    .map((c) => replaceXRange(c, options))\n    .join(' ')\n}\n\nconst replaceXRange = (comp, options) => {\n  comp = comp.trim()\n  const r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    const xM = isX(M)\n    const xm = xM || isX(m)\n    const xp = xm || isX(p)\n    const anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0'\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nconst replaceStars = (comp, options) => {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp\n    .trim()\n    .replace(re[t.STAR], '')\n}\n\nconst replaceGTE0 = (comp, options) => {\n  debug('replaceGTE0', comp, options)\n  return comp\n    .trim()\n    .replace(re[options.includePrerelease ? t.GTE0PRE : t.GTE0], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\n// TODO build?\nconst hyphenReplace = incPr => ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr) => {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = `>=${fM}.0.0${incPr ? '-0' : ''}`\n  } else if (isX(fp)) {\n    from = `>=${fM}.${fm}.0${incPr ? '-0' : ''}`\n  } else if (fpr) {\n    from = `>=${from}`\n  } else {\n    from = `>=${from}${incPr ? '-0' : ''}`\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = `<${+tM + 1}.0.0-0`\n  } else if (isX(tp)) {\n    to = `<${tM}.${+tm + 1}.0-0`\n  } else if (tpr) {\n    to = `<=${tM}.${tm}.${tp}-${tpr}`\n  } else if (incPr) {\n    to = `<${tM}.${tm}.${+tp + 1}-0`\n  } else {\n    to = `<=${to}`\n  }\n\n  return `${from} ${to}`.trim()\n}\n\nconst testSet = (set, version, options) => {\n  for (let i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (let i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === Comparator.ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        const allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n", "'use strict'\n\nconst ANY = Symbol('SemVer ANY')\n// hoisted class for cyclic dependency\nclass Comparator {\n  static get ANY () {\n    return ANY\n  }\n\n  constructor (comp, options) {\n    options = parseOptions(options)\n\n    if (comp instanceof Comparator) {\n      if (comp.loose === !!options.loose) {\n        return comp\n      } else {\n        comp = comp.value\n      }\n    }\n\n    comp = comp.trim().split(/\\s+/).join(' ')\n    debug('comparator', comp, options)\n    this.options = options\n    this.loose = !!options.loose\n    this.parse(comp)\n\n    if (this.semver === ANY) {\n      this.value = ''\n    } else {\n      this.value = this.operator + this.semver.version\n    }\n\n    debug('comp', this)\n  }\n\n  parse (comp) {\n    const r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n    const m = comp.match(r)\n\n    if (!m) {\n      throw new TypeError(`Invalid comparator: ${comp}`)\n    }\n\n    this.operator = m[1] !== undefined ? m[1] : ''\n    if (this.operator === '=') {\n      this.operator = ''\n    }\n\n    // if it literally is just '>' or '' then allow anything.\n    if (!m[2]) {\n      this.semver = ANY\n    } else {\n      this.semver = new SemVer(m[2], this.options.loose)\n    }\n  }\n\n  toString () {\n    return this.value\n  }\n\n  test (version) {\n    debug('Comparator.test', version, this.options.loose)\n\n    if (this.semver === ANY || version === ANY) {\n      return true\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    return cmp(version, this.operator, this.semver, this.options)\n  }\n\n  intersects (comp, options) {\n    if (!(comp instanceof Comparator)) {\n      throw new TypeError('a Comparator is required')\n    }\n\n    if (this.operator === '') {\n      if (this.value === '') {\n        return true\n      }\n      return new Range(comp.value, options).test(this.value)\n    } else if (comp.operator === '') {\n      if (comp.value === '') {\n        return true\n      }\n      return new Range(this.value, options).test(comp.semver)\n    }\n\n    options = parseOptions(options)\n\n    // Special cases where nothing can possibly be lower\n    if (options.includePrerelease &&\n      (this.value === '<0.0.0-0' || comp.value === '<0.0.0-0')) {\n      return false\n    }\n    if (!options.includePrerelease &&\n      (this.value.startsWith('<0.0.0') || comp.value.startsWith('<0.0.0'))) {\n      return false\n    }\n\n    // Same direction increasing (> or >=)\n    if (this.operator.startsWith('>') && comp.operator.startsWith('>')) {\n      return true\n    }\n    // Same direction decreasing (< or <=)\n    if (this.operator.startsWith('<') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // same SemVer and both sides are inclusive (<= or >=)\n    if (\n      (this.semver.version === comp.semver.version) &&\n      this.operator.includes('=') && comp.operator.includes('=')) {\n      return true\n    }\n    // opposite directions less than\n    if (cmp(this.semver, '<', comp.semver, options) &&\n      this.operator.startsWith('>') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // opposite directions greater than\n    if (cmp(this.semver, '>', comp.semver, options) &&\n      this.operator.startsWith('<') && comp.operator.startsWith('>')) {\n      return true\n    }\n    return false\n  }\n}\n\nmodule.exports = Comparator\n\nconst parseOptions = require('../internal/parse-options')\nconst { safeRe: re, t } = require('../internal/re')\nconst cmp = require('../functions/cmp')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst Range = require('./range')\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst satisfies = (version, range, options) => {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\nmodule.exports = satisfies\n", "'use strict'\n\nconst Range = require('../classes/range')\n\n// Mostly just for testing and legacy API reasons\nconst toComparators = (range, options) =>\n  new Range(range, options).set\n    .map(comp => comp.map(c => c.value).join(' ').trim().split(' '))\n\nmodule.exports = toComparators\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\n\nconst maxSatisfying = (versions, range, options) => {\n  let max = null\n  let maxSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\nmodule.exports = maxSatisfying\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst minSatisfying = (versions, range, options) => {\n  let min = null\n  let minSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\nmodule.exports = minSatisfying\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst gt = require('../functions/gt')\n\nconst minVersion = (range, loose) => {\n  range = new Range(range, loose)\n\n  let minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let setMin = null\n    comparators.forEach((comparator) => {\n      // Clone to avoid manipulating the comparator's semver object.\n      const compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!setMin || gt(compver, setMin)) {\n            setMin = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error(`Unexpected operation: ${comparator.operator}`)\n      }\n    })\n    if (setMin && (!minver || gt(minver, setMin))) {\n      minver = setMin\n    }\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\nmodule.exports = minVersion\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst validRange = (range, options) => {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = validRange\n", "'use strict'\n\nconst SemVer = require('../classes/semver')\nconst Comparator = require('../classes/comparator')\nconst { ANY } = Comparator\nconst Range = require('../classes/range')\nconst satisfies = require('../functions/satisfies')\nconst gt = require('../functions/gt')\nconst lt = require('../functions/lt')\nconst lte = require('../functions/lte')\nconst gte = require('../functions/gte')\n\nconst outside = (version, range, hilo, options) => {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  let gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisfies the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let high = null\n    let low = null\n\n    comparators.forEach((comparator) => {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nmodule.exports = outside\n", "'use strict'\n\n// Determine if version is greater than all the versions possible in the range.\nconst outside = require('./outside')\nconst gtr = (version, range, options) => outside(version, range, '>', options)\nmodule.exports = gtr\n", "'use strict'\n\nconst outside = require('./outside')\n// Determine if version is less than all the versions possible in the range\nconst ltr = (version, range, options) => outside(version, range, '<', options)\nmodule.exports = ltr\n", "'use strict'\n\nconst Range = require('../classes/range')\nconst intersects = (r1, r2, options) => {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2, options)\n}\nmodule.exports = intersects\n", "'use strict'\n\n// given a set of versions and a range, create a \"simplified\" range\n// that includes the same versions that the original range does\n// If the original range is shorter than the simplified one, return that.\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\nmodule.exports = (versions, range, options) => {\n  const set = []\n  let first = null\n  let prev = null\n  const v = versions.sort((a, b) => compare(a, b, options))\n  for (const version of v) {\n    const included = satisfies(version, range, options)\n    if (included) {\n      prev = version\n      if (!first) {\n        first = version\n      }\n    } else {\n      if (prev) {\n        set.push([first, prev])\n      }\n      prev = null\n      first = null\n    }\n  }\n  if (first) {\n    set.push([first, null])\n  }\n\n  const ranges = []\n  for (const [min, max] of set) {\n    if (min === max) {\n      ranges.push(min)\n    } else if (!max && min === v[0]) {\n      ranges.push('*')\n    } else if (!max) {\n      ranges.push(`>=${min}`)\n    } else if (min === v[0]) {\n      ranges.push(`<=${max}`)\n    } else {\n      ranges.push(`${min} - ${max}`)\n    }\n  }\n  const simplified = ranges.join(' || ')\n  const original = typeof range.raw === 'string' ? range.raw : String(range)\n  return simplified.length < original.length ? simplified : range\n}\n", "'use strict'\n\nconst Range = require('../classes/range.js')\nconst Comparator = require('../classes/comparator.js')\nconst { ANY } = Comparator\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\n\n// Complex range `r1 || r2 || ...` is a subset of `R1 || R2 || ...` iff:\n// - Every simple range `r1, r2, ...` is a null set, OR\n// - Every simple range `r1, r2, ...` which is not a null set is a subset of\n//   some `R1, R2, ...`\n//\n// Simple range `c1 c2 ...` is a subset of simple range `C1 C2 ...` iff:\n// - If c is only the ANY comparator\n//   - If C is only the ANY comparator, return true\n//   - Else if in prerelease mode, return false\n//   - else replace c with `[>=0.0.0]`\n// - If C is only the ANY comparator\n//   - if in prerelease mode, return true\n//   - else replace C with `[>=0.0.0]`\n// - Let EQ be the set of = comparators in c\n// - If EQ is more than one, return true (null set)\n// - Let GT be the highest > or >= comparator in c\n// - Let LT be the lowest < or <= comparator in c\n// - If GT and LT, and GT.semver > LT.semver, return true (null set)\n// - If any C is a = range, and GT or LT are set, return false\n// - If EQ\n//   - If GT, and EQ does not satisfy GT, return true (null set)\n//   - If LT, and EQ does not satisfy LT, return true (null set)\n//   - If EQ satisfies every C, return true\n//   - Else return false\n// - If GT\n//   - If GT.semver is lower than any > or >= comp in C, return false\n//   - If GT is >=, and GT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the GT.semver tuple, return false\n// - If LT\n//   - If LT.semver is greater than any < or <= comp in C, return false\n//   - If LT is <=, and LT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the LT.semver tuple, return false\n// - Else return true\n\nconst subset = (sub, dom, options = {}) => {\n  if (sub === dom) {\n    return true\n  }\n\n  sub = new Range(sub, options)\n  dom = new Range(dom, options)\n  let sawNonNull = false\n\n  OUTER: for (const simpleSub of sub.set) {\n    for (const simpleDom of dom.set) {\n      const isSub = simpleSubset(simpleSub, simpleDom, options)\n      sawNonNull = sawNonNull || isSub !== null\n      if (isSub) {\n        continue OUTER\n      }\n    }\n    // the null set is a subset of everything, but null simple ranges in\n    // a complex range should be ignored.  so if we saw a non-null range,\n    // then we know this isn't a subset, but if EVERY simple range was null,\n    // then it is a subset.\n    if (sawNonNull) {\n      return false\n    }\n  }\n  return true\n}\n\nconst minimumVersionWithPreRelease = [new Comparator('>=0.0.0-0')]\nconst minimumVersion = [new Comparator('>=0.0.0')]\n\nconst simpleSubset = (sub, dom, options) => {\n  if (sub === dom) {\n    return true\n  }\n\n  if (sub.length === 1 && sub[0].semver === ANY) {\n    if (dom.length === 1 && dom[0].semver === ANY) {\n      return true\n    } else if (options.includePrerelease) {\n      sub = minimumVersionWithPreRelease\n    } else {\n      sub = minimumVersion\n    }\n  }\n\n  if (dom.length === 1 && dom[0].semver === ANY) {\n    if (options.includePrerelease) {\n      return true\n    } else {\n      dom = minimumVersion\n    }\n  }\n\n  const eqSet = new Set()\n  let gt, lt\n  for (const c of sub) {\n    if (c.operator === '>' || c.operator === '>=') {\n      gt = higherGT(gt, c, options)\n    } else if (c.operator === '<' || c.operator === '<=') {\n      lt = lowerLT(lt, c, options)\n    } else {\n      eqSet.add(c.semver)\n    }\n  }\n\n  if (eqSet.size > 1) {\n    return null\n  }\n\n  let gtltComp\n  if (gt && lt) {\n    gtltComp = compare(gt.semver, lt.semver, options)\n    if (gtltComp > 0) {\n      return null\n    } else if (gtltComp === 0 && (gt.operator !== '>=' || lt.operator !== '<=')) {\n      return null\n    }\n  }\n\n  // will iterate one or zero times\n  for (const eq of eqSet) {\n    if (gt && !satisfies(eq, String(gt), options)) {\n      return null\n    }\n\n    if (lt && !satisfies(eq, String(lt), options)) {\n      return null\n    }\n\n    for (const c of dom) {\n      if (!satisfies(eq, String(c), options)) {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  let higher, lower\n  let hasDomLT, hasDomGT\n  // if the subset has a prerelease, we need a comparator in the superset\n  // with the same tuple and a prerelease, or it's not a subset\n  let needDomLTPre = lt &&\n    !options.includePrerelease &&\n    lt.semver.prerelease.length ? lt.semver : false\n  let needDomGTPre = gt &&\n    !options.includePrerelease &&\n    gt.semver.prerelease.length ? gt.semver : false\n  // exception: <1.2.3-0 is the same as <1.2.3\n  if (needDomLTPre && needDomLTPre.prerelease.length === 1 &&\n      lt.operator === '<' && needDomLTPre.prerelease[0] === 0) {\n    needDomLTPre = false\n  }\n\n  for (const c of dom) {\n    hasDomGT = hasDomGT || c.operator === '>' || c.operator === '>='\n    hasDomLT = hasDomLT || c.operator === '<' || c.operator === '<='\n    if (gt) {\n      if (needDomGTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomGTPre.major &&\n            c.semver.minor === needDomGTPre.minor &&\n            c.semver.patch === needDomGTPre.patch) {\n          needDomGTPre = false\n        }\n      }\n      if (c.operator === '>' || c.operator === '>=') {\n        higher = higherGT(gt, c, options)\n        if (higher === c && higher !== gt) {\n          return false\n        }\n      } else if (gt.operator === '>=' && !satisfies(gt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (lt) {\n      if (needDomLTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomLTPre.major &&\n            c.semver.minor === needDomLTPre.minor &&\n            c.semver.patch === needDomLTPre.patch) {\n          needDomLTPre = false\n        }\n      }\n      if (c.operator === '<' || c.operator === '<=') {\n        lower = lowerLT(lt, c, options)\n        if (lower === c && lower !== lt) {\n          return false\n        }\n      } else if (lt.operator === '<=' && !satisfies(lt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (!c.operator && (lt || gt) && gtltComp !== 0) {\n      return false\n    }\n  }\n\n  // if there was a < or >, and nothing in the dom, then must be false\n  // UNLESS it was limited by another range in the other direction.\n  // Eg, >1.0.0 <1.0.1 is still a subset of <2.0.0\n  if (gt && hasDomLT && !lt && gtltComp !== 0) {\n    return false\n  }\n\n  if (lt && hasDomGT && !gt && gtltComp !== 0) {\n    return false\n  }\n\n  // we needed a prerelease range in a specific tuple, but didn't get one\n  // then this isn't a subset.  eg >=1.2.3-pre is not a subset of >=1.0.0,\n  // because it includes prereleases in the 1.2.3 tuple\n  if (needDomGTPre || needDomLTPre) {\n    return false\n  }\n\n  return true\n}\n\n// >=1.2.3 is lower than >1.2.3\nconst higherGT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp > 0 ? a\n    : comp < 0 ? b\n    : b.operator === '>' && a.operator === '>=' ? b\n    : a\n}\n\n// <=1.2.3 is higher than <1.2.3\nconst lowerLT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp < 0 ? a\n    : comp > 0 ? b\n    : b.operator === '<' && a.operator === '<=' ? b\n    : a\n}\n\nmodule.exports = subset\n", "'use strict'\n\n// just pre-load all the stuff that index.js lazily exports\nconst internalRe = require('./internal/re')\nconst constants = require('./internal/constants')\nconst SemVer = require('./classes/semver')\nconst identifiers = require('./internal/identifiers')\nconst parse = require('./functions/parse')\nconst valid = require('./functions/valid')\nconst clean = require('./functions/clean')\nconst inc = require('./functions/inc')\nconst diff = require('./functions/diff')\nconst major = require('./functions/major')\nconst minor = require('./functions/minor')\nconst patch = require('./functions/patch')\nconst prerelease = require('./functions/prerelease')\nconst compare = require('./functions/compare')\nconst rcompare = require('./functions/rcompare')\nconst compareLoose = require('./functions/compare-loose')\nconst compareBuild = require('./functions/compare-build')\nconst sort = require('./functions/sort')\nconst rsort = require('./functions/rsort')\nconst gt = require('./functions/gt')\nconst lt = require('./functions/lt')\nconst eq = require('./functions/eq')\nconst neq = require('./functions/neq')\nconst gte = require('./functions/gte')\nconst lte = require('./functions/lte')\nconst cmp = require('./functions/cmp')\nconst coerce = require('./functions/coerce')\nconst Comparator = require('./classes/comparator')\nconst Range = require('./classes/range')\nconst satisfies = require('./functions/satisfies')\nconst toComparators = require('./ranges/to-comparators')\nconst maxSatisfying = require('./ranges/max-satisfying')\nconst minSatisfying = require('./ranges/min-satisfying')\nconst minVersion = require('./ranges/min-version')\nconst validRange = require('./ranges/valid')\nconst outside = require('./ranges/outside')\nconst gtr = require('./ranges/gtr')\nconst ltr = require('./ranges/ltr')\nconst intersects = require('./ranges/intersects')\nconst simplifyRange = require('./ranges/simplify')\nconst subset = require('./ranges/subset')\nmodule.exports = {\n  parse,\n  valid,\n  clean,\n  inc,\n  diff,\n  major,\n  minor,\n  patch,\n  prerelease,\n  compare,\n  rcompare,\n  compareLoose,\n  compareBuild,\n  sort,\n  rsort,\n  gt,\n  lt,\n  eq,\n  neq,\n  gte,\n  lte,\n  cmp,\n  coerce,\n  Comparator,\n  Range,\n  satisfies,\n  toComparators,\n  maxSatisfying,\n  minSatisfying,\n  minVersion,\n  validRange,\n  outside,\n  gtr,\n  ltr,\n  intersects,\n  simplifyRange,\n  subset,\n  SemVer,\n  re: internalRe.re,\n  src: internalRe.src,\n  tokens: internalRe.t,\n  SEMVER_SPEC_VERSION: constants.SEMVER_SPEC_VERSION,\n  RELEASE_TYPES: constants.RELEASE_TYPES,\n  compareIdentifiers: identifiers.compareIdentifiers,\n  rcompareIdentifiers: identifiers.rcompareIdentifiers,\n}\n", "const semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '>=15.7.0');\n", "const semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '>=16.9.0');\n", "const ASYMMETRIC_KEY_DETAILS_SUPPORTED = require('./asymmetricKeyDetailsSupported');\nconst RSA_PSS_KEY_DETAILS_SUPPORTED = require('./rsaPssKeyDetailsSupported');\n\nconst allowedAlgorithmsForKeys = {\n  'ec': ['ES256', 'ES384', 'ES512'],\n  'rsa': ['RS256', 'PS256', 'RS384', 'PS384', 'RS512', 'PS512'],\n  'rsa-pss': ['PS256', 'PS384', 'PS512']\n};\n\nconst allowedCurves = {\n  ES256: 'prime256v1',\n  ES384: 'secp384r1',\n  ES512: 'secp521r1',\n};\n\nmodule.exports = function(algorithm, key) {\n  if (!algorithm || !key) return;\n\n  const keyType = key.asymmetricKeyType;\n  if (!keyType) return;\n\n  const allowedAlgorithms = allowedAlgorithmsForKeys[keyType];\n\n  if (!allowedAlgorithms) {\n    throw new Error(`Unknown key type \"${keyType}\".`);\n  }\n\n  if (!allowedAlgorithms.includes(algorithm)) {\n    throw new Error(`\"alg\" parameter for \"${keyType}\" key type must be one of: ${allowedAlgorithms.join(', ')}.`)\n  }\n\n  /*\n   * Ignore the next block from test coverage because it gets executed\n   * conditionally depending on the Node version. Not ignoring it would\n   * prevent us from reaching the target % of coverage for versions of\n   * Node under 15.7.0.\n   */\n  /* istanbul ignore next */\n  if (ASYMMETRIC_KEY_DETAILS_SUPPORTED) {\n    switch (keyType) {\n    case 'ec':\n      const keyCurve = key.asymmetricKeyDetails.namedCurve;\n      const allowedCurve = allowedCurves[algorithm];\n\n      if (keyCurve !== allowedCurve) {\n        throw new Error(`\"alg\" parameter \"${algorithm}\" requires curve \"${allowedCurve}\".`);\n      }\n      break;\n\n    case 'rsa-pss':\n      if (RSA_PSS_KEY_DETAILS_SUPPORTED) {\n        const length = parseInt(algorithm.slice(-3), 10);\n        const { hashAlgorithm, mgf1HashAlgorithm, saltLength } = key.asymmetricKeyDetails;\n\n        if (hashAlgorithm !== `sha${length}` || mgf1HashAlgorithm !== hashAlgorithm) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of \"alg\" ${algorithm}.`);\n        }\n\n        if (saltLength !== undefined && saltLength > length >> 3) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of \"alg\" ${algorithm}.`)\n        }\n      }\n      break;\n    }\n  }\n}\n", "var semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '^6.12.0 || >=8.0.0');\n", "const JsonWebTokenError = require('./lib/JsonWebTokenError');\nconst NotBeforeError = require('./lib/NotBeforeError');\nconst TokenExpiredError = require('./lib/TokenExpiredError');\nconst decode = require('./decode');\nconst timespan = require('./lib/timespan');\nconst validateAsymmetricKey = require('./lib/validateAsymmetricKey');\nconst PS_SUPPORTED = require('./lib/psSupported');\nconst jws = require('jws');\nconst {KeyObject, createSecretKey, createPublicKey} = require(\"crypto\");\n\nconst PUB_KEY_ALGS = ['RS256', 'RS384', 'RS512'];\nconst EC_KEY_ALGS = ['ES256', 'ES384', 'ES512'];\nconst RSA_KEY_ALGS = ['RS256', 'RS384', 'RS512'];\nconst HS_ALGS = ['HS256', 'HS384', 'HS512'];\n\nif (PS_SUPPORTED) {\n  PUB_KEY_ALGS.splice(PUB_KEY_ALGS.length, 0, 'PS256', 'PS384', 'PS512');\n  RSA_KEY_ALGS.splice(RSA_KEY_ALGS.length, 0, 'PS256', 'PS384', 'PS512');\n}\n\nmodule.exports = function (jwtString, secretOrPublicKey, options, callback) {\n  if ((typeof options === 'function') && !callback) {\n    callback = options;\n    options = {};\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  //clone this object since we are going to mutate it.\n  options = Object.assign({}, options);\n\n  let done;\n\n  if (callback) {\n    done = callback;\n  } else {\n    done = function(err, data) {\n      if (err) throw err;\n      return data;\n    };\n  }\n\n  if (options.clockTimestamp && typeof options.clockTimestamp !== 'number') {\n    return done(new JsonWebTokenError('clockTimestamp must be a number'));\n  }\n\n  if (options.nonce !== undefined && (typeof options.nonce !== 'string' || options.nonce.trim() === '')) {\n    return done(new JsonWebTokenError('nonce must be a non-empty string'));\n  }\n\n  if (options.allowInvalidAsymmetricKeyTypes !== undefined && typeof options.allowInvalidAsymmetricKeyTypes !== 'boolean') {\n    return done(new JsonWebTokenError('allowInvalidAsymmetricKeyTypes must be a boolean'));\n  }\n\n  const clockTimestamp = options.clockTimestamp || Math.floor(Date.now() / 1000);\n\n  if (!jwtString){\n    return done(new JsonWebTokenError('jwt must be provided'));\n  }\n\n  if (typeof jwtString !== 'string') {\n    return done(new JsonWebTokenError('jwt must be a string'));\n  }\n\n  const parts = jwtString.split('.');\n\n  if (parts.length !== 3){\n    return done(new JsonWebTokenError('jwt malformed'));\n  }\n\n  let decodedToken;\n\n  try {\n    decodedToken = decode(jwtString, { complete: true });\n  } catch(err) {\n    return done(err);\n  }\n\n  if (!decodedToken) {\n    return done(new JsonWebTokenError('invalid token'));\n  }\n\n  const header = decodedToken.header;\n  let getSecret;\n\n  if(typeof secretOrPublicKey === 'function') {\n    if(!callback) {\n      return done(new JsonWebTokenError('verify must be called asynchronous if secret or public key is provided as a callback'));\n    }\n\n    getSecret = secretOrPublicKey;\n  }\n  else {\n    getSecret = function(header, secretCallback) {\n      return secretCallback(null, secretOrPublicKey);\n    };\n  }\n\n  return getSecret(header, function(err, secretOrPublicKey) {\n    if(err) {\n      return done(new JsonWebTokenError('error in secret or public key callback: ' + err.message));\n    }\n\n    const hasSignature = parts[2].trim() !== '';\n\n    if (!hasSignature && secretOrPublicKey){\n      return done(new JsonWebTokenError('jwt signature is required'));\n    }\n\n    if (hasSignature && !secretOrPublicKey) {\n      return done(new JsonWebTokenError('secret or public key must be provided'));\n    }\n\n    if (!hasSignature && !options.algorithms) {\n      return done(new JsonWebTokenError('please specify \"none\" in \"algorithms\" to verify unsigned tokens'));\n    }\n\n    if (secretOrPublicKey != null && !(secretOrPublicKey instanceof KeyObject)) {\n      try {\n        secretOrPublicKey = createPublicKey(secretOrPublicKey);\n      } catch (_) {\n        try {\n          secretOrPublicKey = createSecretKey(typeof secretOrPublicKey === 'string' ? Buffer.from(secretOrPublicKey) : secretOrPublicKey);\n        } catch (_) {\n          return done(new JsonWebTokenError('secretOrPublicKey is not valid key material'))\n        }\n      }\n    }\n\n    if (!options.algorithms) {\n      if (secretOrPublicKey.type === 'secret') {\n        options.algorithms = HS_ALGS;\n      } else if (['rsa', 'rsa-pss'].includes(secretOrPublicKey.asymmetricKeyType)) {\n        options.algorithms = RSA_KEY_ALGS\n      } else if (secretOrPublicKey.asymmetricKeyType === 'ec') {\n        options.algorithms = EC_KEY_ALGS\n      } else {\n        options.algorithms = PUB_KEY_ALGS\n      }\n    }\n\n    if (options.algorithms.indexOf(decodedToken.header.alg) === -1) {\n      return done(new JsonWebTokenError('invalid algorithm'));\n    }\n\n    if (header.alg.startsWith('HS') && secretOrPublicKey.type !== 'secret') {\n      return done(new JsonWebTokenError((`secretOrPublicKey must be a symmetric key when using ${header.alg}`)))\n    } else if (/^(?:RS|PS|ES)/.test(header.alg) && secretOrPublicKey.type !== 'public') {\n      return done(new JsonWebTokenError((`secretOrPublicKey must be an asymmetric key when using ${header.alg}`)))\n    }\n\n    if (!options.allowInvalidAsymmetricKeyTypes) {\n      try {\n        validateAsymmetricKey(header.alg, secretOrPublicKey);\n      } catch (e) {\n        return done(e);\n      }\n    }\n\n    let valid;\n\n    try {\n      valid = jws.verify(jwtString, decodedToken.header.alg, secretOrPublicKey);\n    } catch (e) {\n      return done(e);\n    }\n\n    if (!valid) {\n      return done(new JsonWebTokenError('invalid signature'));\n    }\n\n    const payload = decodedToken.payload;\n\n    if (typeof payload.nbf !== 'undefined' && !options.ignoreNotBefore) {\n      if (typeof payload.nbf !== 'number') {\n        return done(new JsonWebTokenError('invalid nbf value'));\n      }\n      if (payload.nbf > clockTimestamp + (options.clockTolerance || 0)) {\n        return done(new NotBeforeError('jwt not active', new Date(payload.nbf * 1000)));\n      }\n    }\n\n    if (typeof payload.exp !== 'undefined' && !options.ignoreExpiration) {\n      if (typeof payload.exp !== 'number') {\n        return done(new JsonWebTokenError('invalid exp value'));\n      }\n      if (clockTimestamp >= payload.exp + (options.clockTolerance || 0)) {\n        return done(new TokenExpiredError('jwt expired', new Date(payload.exp * 1000)));\n      }\n    }\n\n    if (options.audience) {\n      const audiences = Array.isArray(options.audience) ? options.audience : [options.audience];\n      const target = Array.isArray(payload.aud) ? payload.aud : [payload.aud];\n\n      const match = target.some(function (targetAudience) {\n        return audiences.some(function (audience) {\n          return audience instanceof RegExp ? audience.test(targetAudience) : audience === targetAudience;\n        });\n      });\n\n      if (!match) {\n        return done(new JsonWebTokenError('jwt audience invalid. expected: ' + audiences.join(' or ')));\n      }\n    }\n\n    if (options.issuer) {\n      const invalid_issuer =\n              (typeof options.issuer === 'string' && payload.iss !== options.issuer) ||\n              (Array.isArray(options.issuer) && options.issuer.indexOf(payload.iss) === -1);\n\n      if (invalid_issuer) {\n        return done(new JsonWebTokenError('jwt issuer invalid. expected: ' + options.issuer));\n      }\n    }\n\n    if (options.subject) {\n      if (payload.sub !== options.subject) {\n        return done(new JsonWebTokenError('jwt subject invalid. expected: ' + options.subject));\n      }\n    }\n\n    if (options.jwtid) {\n      if (payload.jti !== options.jwtid) {\n        return done(new JsonWebTokenError('jwt jwtid invalid. expected: ' + options.jwtid));\n      }\n    }\n\n    if (options.nonce) {\n      if (payload.nonce !== options.nonce) {\n        return done(new JsonWebTokenError('jwt nonce invalid. expected: ' + options.nonce));\n      }\n    }\n\n    if (options.maxAge) {\n      if (typeof payload.iat !== 'number') {\n        return done(new JsonWebTokenError('iat required when maxAge is specified'));\n      }\n\n      const maxAgeTimestamp = timespan(options.maxAge, payload.iat);\n      if (typeof maxAgeTimestamp === 'undefined') {\n        return done(new JsonWebTokenError('\"maxAge\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n      }\n      if (clockTimestamp >= maxAgeTimestamp + (options.clockTolerance || 0)) {\n        return done(new TokenExpiredError('maxAge exceeded', new Date(maxAgeTimestamp * 1000)));\n      }\n    }\n\n    if (options.complete === true) {\n      const signature = decodedToken.signature;\n\n      return done(null, {\n        header: header,\n        payload: payload,\n        signature: signature\n      });\n    }\n\n    return done(null, payload);\n  });\n};\n", "/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object),\n    nativeMax = Math.max;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Checks if `value` is in `collection`. If `collection` is a string, it's\n * checked for a substring of `value`, otherwise\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * is used for equality comparisons. If `fromIndex` is negative, it's used as\n * the offset from the end of `collection`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object|string} collection The collection to inspect.\n * @param {*} value The value to search for.\n * @param {number} [fromIndex=0] The index to search from.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {boolean} Returns `true` if `value` is found, else `false`.\n * @example\n *\n * _.includes([1, 2, 3], 1);\n * // => true\n *\n * _.includes([1, 2, 3], 1, 2);\n * // => false\n *\n * _.includes({ 'a': 1, 'b': 2 }, 1);\n * // => true\n *\n * _.includes('abcd', 'bc');\n * // => true\n */\nfunction includes(collection, value, fromIndex, guard) {\n  collection = isArrayLike(collection) ? collection : values(collection);\n  fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n  var length = collection.length;\n  if (fromIndex < 0) {\n    fromIndex = nativeMax(length + fromIndex, 0);\n  }\n  return isString(collection)\n    ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n    : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag);\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object ? baseValues(object, keys(object)) : [];\n}\n\nmodule.exports = includes;\n", "/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as a boolean primitive or object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isBoolean(false);\n * // => true\n *\n * _.isBoolean(null);\n * // => false\n */\nfunction isBoolean(value) {\n  return value === true || value === false ||\n    (isObjectLike(value) && objectToString.call(value) == boolTag);\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\nmodule.exports = isBoolean;\n", "/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is an integer.\n *\n * **Note:** This method is based on\n * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n * @example\n *\n * _.isInteger(3);\n * // => true\n *\n * _.isInteger(Number.MIN_VALUE);\n * // => false\n *\n * _.isInteger(Infinity);\n * // => false\n *\n * _.isInteger('3');\n * // => false\n */\nfunction isInteger(value) {\n  return typeof value == 'number' && value == toInteger(value);\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = isInteger;\n", "/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are classified\n * as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && objectToString.call(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n", "/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) ||\n      objectToString.call(value) != objectTag || isHostObject(value)) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return (typeof Ctor == 'function' &&\n    Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString);\n}\n\nmodule.exports = isPlainObject;\n", "/**\n * lodash 4.0.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @type Function\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag);\n}\n\nmodule.exports = isString;\n", "/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Creates a function that invokes `func`, with the `this` binding and arguments\n * of the created function, while it's called less than `n` times. Subsequent\n * calls to the created function return the result of the last `func` invocation.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {number} n The number of calls at which `func` is no longer invoked.\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * jQuery(element).on('click', _.before(5, addContactToList));\n * // => Allows adding up to 4 contacts to the list.\n */\nfunction before(n, func) {\n  var result;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  n = toInteger(n);\n  return function() {\n    if (--n > 0) {\n      result = func.apply(this, arguments);\n    }\n    if (n <= 1) {\n      func = undefined;\n    }\n    return result;\n  };\n}\n\n/**\n * Creates a function that is restricted to invoking `func` once. Repeat calls\n * to the function return the value of the first invocation. The `func` is\n * invoked with the `this` binding and arguments of the created function.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * var initialize = _.once(createApplication);\n * initialize();\n * initialize();\n * // => `createApplication` is invoked once\n */\nfunction once(func) {\n  return before(2, func);\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = once;\n", "const timespan = require('./lib/timespan');\nconst PS_SUPPORTED = require('./lib/psSupported');\nconst validateAsymmetricKey = require('./lib/validateAsymmetricKey');\nconst jws = require('jws');\nconst includes = require('lodash.includes');\nconst isBoolean = require('lodash.isboolean');\nconst isInteger = require('lodash.isinteger');\nconst isNumber = require('lodash.isnumber');\nconst isPlainObject = require('lodash.isplainobject');\nconst isString = require('lodash.isstring');\nconst once = require('lodash.once');\nconst { KeyObject, createSecretKey, createPrivateKey } = require('crypto')\n\nconst SUPPORTED_ALGS = ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'none'];\nif (PS_SUPPORTED) {\n  SUPPORTED_ALGS.splice(3, 0, 'PS256', 'PS384', 'PS512');\n}\n\nconst sign_options_schema = {\n  expiresIn: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"expiresIn\" should be a number of seconds or string representing a timespan' },\n  notBefore: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"notBefore\" should be a number of seconds or string representing a timespan' },\n  audience: { isValid: function(value) { return isString(value) || Array.isArray(value); }, message: '\"audience\" must be a string or array' },\n  algorithm: { isValid: includes.bind(null, SUPPORTED_ALGS), message: '\"algorithm\" must be a valid string enum value' },\n  header: { isValid: isPlainObject, message: '\"header\" must be an object' },\n  encoding: { isValid: isString, message: '\"encoding\" must be a string' },\n  issuer: { isValid: isString, message: '\"issuer\" must be a string' },\n  subject: { isValid: isString, message: '\"subject\" must be a string' },\n  jwtid: { isValid: isString, message: '\"jwtid\" must be a string' },\n  noTimestamp: { isValid: isBoolean, message: '\"noTimestamp\" must be a boolean' },\n  keyid: { isValid: isString, message: '\"keyid\" must be a string' },\n  mutatePayload: { isValid: isBoolean, message: '\"mutatePayload\" must be a boolean' },\n  allowInsecureKeySizes: { isValid: isBoolean, message: '\"allowInsecureKeySizes\" must be a boolean'},\n  allowInvalidAsymmetricKeyTypes: { isValid: isBoolean, message: '\"allowInvalidAsymmetricKeyTypes\" must be a boolean'}\n};\n\nconst registered_claims_schema = {\n  iat: { isValid: isNumber, message: '\"iat\" should be a number of seconds' },\n  exp: { isValid: isNumber, message: '\"exp\" should be a number of seconds' },\n  nbf: { isValid: isNumber, message: '\"nbf\" should be a number of seconds' }\n};\n\nfunction validate(schema, allowUnknown, object, parameterName) {\n  if (!isPlainObject(object)) {\n    throw new Error('Expected \"' + parameterName + '\" to be a plain object.');\n  }\n  Object.keys(object)\n    .forEach(function(key) {\n      const validator = schema[key];\n      if (!validator) {\n        if (!allowUnknown) {\n          throw new Error('\"' + key + '\" is not allowed in \"' + parameterName + '\"');\n        }\n        return;\n      }\n      if (!validator.isValid(object[key])) {\n        throw new Error(validator.message);\n      }\n    });\n}\n\nfunction validateOptions(options) {\n  return validate(sign_options_schema, false, options, 'options');\n}\n\nfunction validatePayload(payload) {\n  return validate(registered_claims_schema, true, payload, 'payload');\n}\n\nconst options_to_payload = {\n  'audience': 'aud',\n  'issuer': 'iss',\n  'subject': 'sub',\n  'jwtid': 'jti'\n};\n\nconst options_for_objects = [\n  'expiresIn',\n  'notBefore',\n  'noTimestamp',\n  'audience',\n  'issuer',\n  'subject',\n  'jwtid',\n];\n\nmodule.exports = function (payload, secretOrPrivateKey, options, callback) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  } else {\n    options = options || {};\n  }\n\n  const isObjectPayload = typeof payload === 'object' &&\n                        !Buffer.isBuffer(payload);\n\n  const header = Object.assign({\n    alg: options.algorithm || 'HS256',\n    typ: isObjectPayload ? 'JWT' : undefined,\n    kid: options.keyid\n  }, options.header);\n\n  function failure(err) {\n    if (callback) {\n      return callback(err);\n    }\n    throw err;\n  }\n\n  if (!secretOrPrivateKey && options.algorithm !== 'none') {\n    return failure(new Error('secretOrPrivateKey must have a value'));\n  }\n\n  if (secretOrPrivateKey != null && !(secretOrPrivateKey instanceof KeyObject)) {\n    try {\n      secretOrPrivateKey = createPrivateKey(secretOrPrivateKey)\n    } catch (_) {\n      try {\n        secretOrPrivateKey = createSecretKey(typeof secretOrPrivateKey === 'string' ? Buffer.from(secretOrPrivateKey) : secretOrPrivateKey)\n      } catch (_) {\n        return failure(new Error('secretOrPrivateKey is not valid key material'));\n      }\n    }\n  }\n\n  if (header.alg.startsWith('HS') && secretOrPrivateKey.type !== 'secret') {\n    return failure(new Error((`secretOrPrivateKey must be a symmetric key when using ${header.alg}`)))\n  } else if (/^(?:RS|PS|ES)/.test(header.alg)) {\n    if (secretOrPrivateKey.type !== 'private') {\n      return failure(new Error((`secretOrPrivateKey must be an asymmetric key when using ${header.alg}`)))\n    }\n    if (!options.allowInsecureKeySizes &&\n      !header.alg.startsWith('ES') &&\n      secretOrPrivateKey.asymmetricKeyDetails !== undefined && //KeyObject.asymmetricKeyDetails is supported in Node 15+\n      secretOrPrivateKey.asymmetricKeyDetails.modulusLength < 2048) {\n      return failure(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`));\n    }\n  }\n\n  if (typeof payload === 'undefined') {\n    return failure(new Error('payload is required'));\n  } else if (isObjectPayload) {\n    try {\n      validatePayload(payload);\n    }\n    catch (error) {\n      return failure(error);\n    }\n    if (!options.mutatePayload) {\n      payload = Object.assign({},payload);\n    }\n  } else {\n    const invalid_options = options_for_objects.filter(function (opt) {\n      return typeof options[opt] !== 'undefined';\n    });\n\n    if (invalid_options.length > 0) {\n      return failure(new Error('invalid ' + invalid_options.join(',') + ' option for ' + (typeof payload ) + ' payload'));\n    }\n  }\n\n  if (typeof payload.exp !== 'undefined' && typeof options.expiresIn !== 'undefined') {\n    return failure(new Error('Bad \"options.expiresIn\" option the payload already has an \"exp\" property.'));\n  }\n\n  if (typeof payload.nbf !== 'undefined' && typeof options.notBefore !== 'undefined') {\n    return failure(new Error('Bad \"options.notBefore\" option the payload already has an \"nbf\" property.'));\n  }\n\n  try {\n    validateOptions(options);\n  }\n  catch (error) {\n    return failure(error);\n  }\n\n  if (!options.allowInvalidAsymmetricKeyTypes) {\n    try {\n      validateAsymmetricKey(header.alg, secretOrPrivateKey);\n    } catch (error) {\n      return failure(error);\n    }\n  }\n\n  const timestamp = payload.iat || Math.floor(Date.now() / 1000);\n\n  if (options.noTimestamp) {\n    delete payload.iat;\n  } else if (isObjectPayload) {\n    payload.iat = timestamp;\n  }\n\n  if (typeof options.notBefore !== 'undefined') {\n    try {\n      payload.nbf = timespan(options.notBefore, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.nbf === 'undefined') {\n      return failure(new Error('\"notBefore\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  if (typeof options.expiresIn !== 'undefined' && typeof payload === 'object') {\n    try {\n      payload.exp = timespan(options.expiresIn, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.exp === 'undefined') {\n      return failure(new Error('\"expiresIn\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  Object.keys(options_to_payload).forEach(function (key) {\n    const claim = options_to_payload[key];\n    if (typeof options[key] !== 'undefined') {\n      if (typeof payload[claim] !== 'undefined') {\n        return failure(new Error('Bad \"options.' + key + '\" option. The payload already has an \"' + claim + '\" property.'));\n      }\n      payload[claim] = options[key];\n    }\n  });\n\n  const encoding = options.encoding || 'utf8';\n\n  if (typeof callback === 'function') {\n    callback = callback && once(callback);\n\n    jws.createSign({\n      header: header,\n      privateKey: secretOrPrivateKey,\n      payload: payload,\n      encoding: encoding\n    }).once('error', callback)\n      .once('done', function (signature) {\n        // TODO: Remove in favor of the modulus length check before signing once node 15+ is the minimum supported version\n        if(!options.allowInsecureKeySizes && /^(?:RS|PS)/.test(header.alg) && signature.length < 256) {\n          return callback(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`))\n        }\n        callback(null, signature);\n      });\n  } else {\n    let signature = jws.sign({header: header, payload: payload, secret: secretOrPrivateKey, encoding: encoding});\n    // TODO: Remove in favor of the modulus length check before signing once node 15+ is the minimum supported version\n    if(!options.allowInsecureKeySizes && /^(?:RS|PS)/.test(header.alg) && signature.length < 256) {\n      throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`)\n    }\n    return signature\n  }\n};\n", "module.exports = {\n  decode: require('./decode'),\n  verify: require('./verify'),\n  sign: require('./sign'),\n  JsonWebTokenError: require('./lib/JsonWebTokenError'),\n  NotBeforeError: require('./lib/NotBeforeError'),\n  TokenExpiredError: require('./lib/TokenExpiredError'),\n};\n", "import express from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport logger from './utils/logger.js';\nimport { config } from './config/environment.js';\nimport { apiLimiter } from './api/middlewares/rateLimiter.js';\nimport {\n  errorHandler,\n  notFoundHandler,\n  requestLogger,\n} from './api/middlewares/errorHandler.js';\nimport sessionRoutes from './api/routes/session.routes.js';\nimport jobsRoutes from './api/routes/jobs.routes.js';\nimport messageRoutes from './api/routes/message.routes.js';\nimport pdfRoutes from './api/routes/pdf.routes.js';\nimport driveRoutes from './api/routes/drive.routes.js';\nimport swaggerUi from 'swagger-ui-express';\nimport { openApiSpec } from './api/docs/openapi.js';\nimport jobScheduler from './jobs/scheduler.service.js';\nimport pdfGenerator from './pdf/generator.service.js';\nimport connectionManager from './whatsapp/baileys/connection.manager.js';\nimport cron from 'node-cron';\nimport fs from 'fs-extra';\n\nconst app = express();\n\n// Middleware de seguridad\napp.use(\n  helmet({\n    contentSecurityPolicy: {\n      directives: {\n        ...helmet.contentSecurityPolicy.getDefaultDirectives(),\n        'img-src': [\"'self'\", 'data:', 'blob:'],\n      },\n    },\n  })\n);\napp.use(cors());\n\n// Middleware de parseo\napp.use(express.json({ limit: '10mb' }));\napp.use(express.urlencoded({ limit: '10mb', extended: true }));\n\n// Middleware de logging y rate limiting\napp.use(requestLogger);\napp.use(apiLimiter);\n\n// Health check\napp.get('/health', (req, res) => {\n  res.status(200).json({\n    success: true,\n    message: 'Server is running',\n    timestamp: new Date().toISOString(),\n    environment: config.nodeEnv,\n  });\n});\n\n// API Routes\napp.use('/api/sessions', sessionRoutes);\napp.use('/api/session', sessionRoutes);\napp.use('/api/jobs', jobsRoutes);\napp.use('/api/message', messageRoutes);\napp.use('/api/pdf', pdfRoutes);\napp.use('/api/drive', driveRoutes);\n\n// Public file access (multi-tenant only - Fase 9)\napp.use(\n  '/files/companies',\n  express.static(config.storage.root + '/companies', {\n    fallthrough: false,\n    index: false,\n    dotfiles: 'deny',\n    maxAge: '1h',\n    immutable: true,\n  })\n);\n\n// Public PDF temp access\napp.use(\n  config.pdf.tempPublicBaseUrl,\n  express.static(config.pdf.tempDir, {\n    fallthrough: false,\n    index: false,\n    dotfiles: 'deny',\n    maxAge: '1h',\n  })\n);\n\n// Swagger UI\napp.use(\n  '/docs',\n  swaggerUi.serve,\n  swaggerUi.setup(openApiSpec, {\n    customSiteTitle: 'WhatsApp API v2',\n  })\n);\n\n// Status endpoint\napp.get('/api/status', (req, res) => {\n  const connections = connectionManager.getAllConnections();\n  res.status(200).json({\n    success: true,\n    data: {\n      activeSessions: connections.size,\n      nodeEnv: config.nodeEnv,\n      timestamp: new Date().toISOString(),\n    },\n  });\n});\n\n// Error handlers\napp.use(notFoundHandler);\napp.use(errorHandler);\n\n// Inicializaci\u00F3n del servidor\nasync function startServer() {\n  try {\n    logger.info('\uD83D\uDE80 Starting WhatsApp AI Agent Server...');\n\n    // Inicializar QuotaValidator (Fase 10 - MongoDB only)\n    logger.info('Initializing Quota Validator...');\n    const { quotaValidatorService } = await import('./services/quota-validator.service.js');\n    try {\n      await quotaValidatorService.connect();\n      logger.info('\u2705 Quota Validator connected (MongoDB-only)');\n    } catch (error) {\n      logger.warn('Quota Validator initialization failed, quota validation will be disabled:', error);\n    }\n\n    // Inicializar servicios\n    logger.info('Initializing PDF Generator...');\n    await pdfGenerator.initialize();\n    await fs.ensureDir(config.pdf.tempDir);\n\n    logger.info('Initializing Job Scheduler...');\n    await jobScheduler.initialize();\n\n    logger.info('Reconnecting saved WhatsApp sessions...');\n    await connectionManager.reconnectSavedSessions();\n\n    // \uD83D\uDEE1\uFE0F Iniciar watchdog de recuperaci\u00F3n autom\u00E1tica de sesiones\n    logger.info('Starting session recovery watchdog...');\n    connectionManager.startSessionRecoveryWatchdog();\n\n    cron.schedule('0 0 * * 0', async () => {\n      try {\n        await fs.emptyDir(config.pdf.tempDir);\n        logger.info('\u2705 Cleared PDF temp directory');\n      } catch (error) {\n        logger.error('Failed to clear PDF temp directory:', error);\n      }\n    });\n\n    // Iniciar servidor HTTP\n    const server = app.listen(config.port, () => {\n      logger.info(`\u2705 Server running on port ${config.port}`);\n      logger.info(`\uD83D\uDCCA Environment: ${config.nodeEnv}`);\n      logger.info(`\uD83D\uDCC1 WhatsApp sessions dir: ${config.whatsapp.sessionDir}`);\n    });\n\n    // Graceful shutdown\n    const gracefulShutdown = async (signal: string) => {\n      logger.info(`\\n\uD83D\uDCF4 Received ${signal}, shutting down gracefully...`);\n\n      // Cerrar servidor HTTP\n      server.close(async () => {\n        logger.info('HTTP server closed');\n\n        try {\n          // Desconectar todas las sesiones de WhatsApp\n          await connectionManager.disconnectAll();\n\n          // Cerrar scheduler de jobs\n          await jobScheduler.shutdown();\n\n          // Cerrar PDF Generator\n          await pdfGenerator.shutdown();\n\n          // Cerrar QuotaValidator (Fase 10 - MongoDB only)\n          const { quotaValidatorService } = await import('./services/quota-validator.service.js');\n          await quotaValidatorService.disconnect();\n\n          logger.info('\u2705 All services shut down successfully');\n          process.exit(0);\n        } catch (error) {\n          logger.error('Error during shutdown:', error);\n          process.exit(1);\n        }\n      });\n\n      // Force shutdown despu\u00E9s de 30 segundos\n      setTimeout(() => {\n        logger.error('Forced shutdown due to timeout');\n        process.exit(1);\n      }, 30000);\n    };\n\n    process.on('SIGTERM', () => gracefulShutdown('SIGTERM'));\n    process.on('SIGINT', () => gracefulShutdown('SIGINT'));\n\n    // Error handling\n    process.on('uncaughtException', (error) => {\n      logger.error('Uncaught Exception:', error);\n      process.exit(1);\n    });\n\n    process.on('unhandledRejection', (reason, promise) => {\n      logger.error('Unhandled Rejection at:', promise, 'reason:', reason);\n    });\n  } catch (error) {\n    logger.error('Failed to start server:', error);\n    process.exit(1);\n  }\n}\n\n// Iniciar si es m\u00F3dulo principal\nif (import.meta.url === `file://${process.argv[1]}`) {\n  startServer();\n}\n\nexport default app;\n", "import rateLimit from 'express-rate-limit';\nimport { config } from '../../config/environment.js';\n\nexport const apiLimiter = rateLimit({\n  windowMs: 5 * 60 * 1000, // 5 minutos\n  max: config.security.rateLimitMax, // l\u00EDmite de requests por ventana\n  message: 'Demasiadas solicitudes desde esta IP, intenta m\u00E1s tarde',\n  standardHeaders: true, // Retornar informaci\u00F3n del rate limit en los `RateLimit-*` headers\n  legacyHeaders: false, // Deshabilitar los headers `X-RateLimit-*`\n  skip: (req) => {\n    // No limitar si tiene API key v\u00E1lida\n    if (req.headers['x-api-key'] === process.env.API_SECRET_KEY) {\n      return true;\n    }\n\n    const host = (req.hostname || req.get('host') || '').toLowerCase();\n    if (host.endsWith('constroad.com') || host === 'localhost:3000') {\n      return true;\n    }\n\n    const origin = (req.get('origin') || req.get('referer') || '').toLowerCase();\n    if (!origin) {\n      return false;\n    }\n\n    try {\n      const parsed = new URL(origin);\n      return (\n        parsed.hostname.endsWith('constroad.com') ||\n        (parsed.hostname === 'localhost' && parsed.port === '3000')\n      );\n    } catch {\n      return origin.includes('constroad.com') || origin.includes('localhost:3000');\n    }\n  },\n});\n\nexport const sessionLimiter = rateLimit({\n  windowMs: 1 * 60 * 1000, // 1 minuto\n  max: 5, // m\u00E1ximo 5 conexiones por minuto\n  keyGenerator: (req) => {\n    return req.body?.phoneNumber || req.ip || 'unknown';\n  },\n});\n\nexport const jobsLimiter = rateLimit({\n  windowMs: 60 * 1000, // 1 minuto\n  max: 10,\n});\n\nexport const messageLimiter = rateLimit({\n  windowMs: 60 * 1000, // 1 minuto\n  max: 100,\n  keyGenerator: (req) => {\n    return req.body?.chatId || req.ip || 'unknown';\n  },\n});\n", "import { Request, Response, NextFunction } from 'express';\nimport logger from '../../utils/logger.js';\nimport { HTTP_STATUS } from '../../config/constants.js';\n\nexport interface CustomError extends Error {\n  statusCode?: number;\n  details?: any;\n}\n\nexport function errorHandler(\n  err: CustomError,\n  req: Request,\n  res: Response,\n  next: NextFunction\n) {\n  const statusCode = err.statusCode || HTTP_STATUS.INTERNAL_ERROR;\n  const message = err.message || 'Internal Server Error';\n\n  logger.error('Error:', {\n    statusCode,\n    message,\n    path: req.path,\n    method: req.method,\n    details: err.details,\n  });\n\n  res.status(statusCode).json({\n    success: false,\n    error: {\n      message,\n      statusCode,\n      ...(process.env.NODE_ENV === 'development' && { stack: err.stack }),\n    },\n  });\n}\n\nexport function notFoundHandler(req: Request, res: Response, next: NextFunction) {\n  // Ignorar silenciosamente rutas de Next.js HMR\n  if (req.path.includes('_next/') || req.path.includes('/__webpack')) {\n    return res.status(404).end();\n  }\n\n  const error: CustomError = new Error(`Route not found: ${req.path}`);\n  error.statusCode = HTTP_STATUS.NOT_FOUND;\n  next(error);\n}\n\nexport function requestLogger(req: Request, res: Response, next: NextFunction) {\n  const startTime = Date.now();\n\n  res.on('finish', () => {\n    const duration = Date.now() - startTime;\n    logger.info(`${req.method} ${req.path} - ${res.statusCode} (${duration}ms)`);\n  });\n\n  next();\n}\n\nexport function validateApiKey(req: Request, res: Response, next: NextFunction) {\n  const apiKey = req.headers['x-api-key'];\n  const expectedKey = process.env.API_SECRET_KEY;\n\n  if (!expectedKey || apiKey !== expectedKey) {\n    const error: CustomError = new Error('Unauthorized: Invalid API Key');\n    error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n    return next(error);\n  }\n\n  next();\n}\n", "export const TYPING_DELAY = {\n  minMs: 1000,\n  maxMs: 8000,\n  wordsPerMinute: 40,\n};\n\nexport const CONVERSATION_TIMEOUT = 30 * 60 * 1000; // 30 minutos\nexport const QR_EXPIRY_TIME = 60 * 1000; // 60 segundos\n\nexport const SERVICE_TYPES = {\n  VENTA: 'venta',\n  COLOCACION: 'colocacion',\n  TRANSPORTE: 'transporte',\n  FABRICACION: 'fabricacion',\n} as const;\n\nexport const CONVERSATION_STATES = {\n  ACTIVE: 'active',\n  WAITING_HUMAN: 'waiting_human',\n  CLOSED: 'closed',\n} as const;\n\nexport const HTTP_STATUS = {\n  OK: 200,\n  CREATED: 201,\n  BAD_REQUEST: 400,\n  UNAUTHORIZED: 401,\n  FORBIDDEN: 403,\n  NOT_FOUND: 404,\n  CONFLICT: 409,\n  REQUEST_TOO_LONG: 413,\n  INTERNAL_ERROR: 500,\n  SERVICE_UNAVAILABLE: 503,\n} as const;\n\nexport const CLAUDE_MODEL = 'claude-sonnet-4-20250514';\nexport const CLAUDE_MAX_TOKENS = 1024;\n", "import { Router } from 'express';\nimport * as sessionController from '../controllers/session.controller.js';\nimport { sessionLimiter } from '../middlewares/rateLimiter.js';\n\nconst router = Router();\n\n// GET /api/sessions/list - Obtener todas las sesiones\nrouter.get('/list', sessionController.listActiveSessions);\n\n// POST /api/sessions - Crear nueva sesi\u00F3n WhatsApp\nrouter.post('/', sessionLimiter, sessionController.createSession);\n\n// GET /api/sessions/:phoneNumber/qr - Obtener QR como imagen PNG\nrouter.get('/:phoneNumber/qr', sessionController.getQRCodeImage);\n\n// GET /api/sessions/:phoneNumber/status - Obtener estado de sesi\u00F3n\nrouter.get('/:phoneNumber/status', sessionController.getSessionStatus);\n\n// POST /api/sessions/:phoneNumber/logout - Cerrar sesi\u00F3n activa\nrouter.post('/:phoneNumber/logout', sessionController.logoutSession);\n\n// GET /api/sessions/:phoneNumber/groups - Listar grupos de WhatsApp\nrouter.get('/:phoneNumber/groups', sessionController.getGroupList);\n\n// GET /api/sessions/:phoneNumber/syncGroups - Sincronizar grupos de WhatsApp\nrouter.get('/:phoneNumber/syncGroups', sessionController.syncGroups);\n\n// GET /api/sessions/:phoneNumber/contacts - Listar contactos de WhatsApp\nrouter.get('/:phoneNumber/contacts', sessionController.getContactsHandler);\n\n// DELETE /api/sessions/:phoneNumber - Desconectar sesi\u00F3n\nrouter.delete('/:phoneNumber', sessionController.disconnectSession);\n\n// POST /api/sessions/:phoneNumber/restore - Restaurar desde backup\nrouter.post('/:phoneNumber/restore', sessionController.restoreSessionFromBackup);\n\n// GET /api/sessions/:phoneNumber/backups - Listar backups disponibles\nrouter.get('/:phoneNumber/backups', sessionController.listSessionBackups);\n\n// POST /api/sessions/:phoneNumber/reset-reconnect - Resetear estado de reconexi\u00F3n\nrouter.post('/:phoneNumber/reset-reconnect', sessionController.resetReconnectState);\n\n// GET /api/sessions - Obtener todas las sesiones\nrouter.get('/', sessionController.getAllSessions);\n\nexport default router;\n", "import { Request, Response, NextFunction } from 'express';\nimport qrcode from 'qrcode';\nimport connectionManager from '../../whatsapp/baileys/connection.manager.js';\nimport logger from '../../utils/logger.js';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { config } from '../../config/environment.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\n\nasync function waitForQRCode(\n  phoneNumber: string,\n  timeoutMs = config.whatsapp.qrTimeout,\n  intervalMs = 300\n): Promise<string | undefined> {\n  const start = Date.now();\n\n  return new Promise((resolve) => {\n    const timer = setInterval(() => {\n      const qr = connectionManager.getQRCode(phoneNumber);\n      if (qr) {\n        clearInterval(timer);\n        resolve(qr);\n        return;\n      }\n\n      if (Date.now() - start >= timeoutMs) {\n        clearInterval(timer);\n        resolve(undefined);\n      }\n    }, intervalMs);\n  });\n}\n\nexport async function createSession(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.body;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    logger.info(`Creating session for ${phoneNumber}`);\n\n    await connectionManager.createConnection(phoneNumber);\n    const qr = await waitForQRCode(phoneNumber);\n    const qrImage = qr ? await qrcode.toDataURL(qr) : undefined;\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: {\n        phoneNumber,\n        status: connectionManager.getConnectionStatus(phoneNumber),\n        qr,\n        qrImage,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getSessionStatus(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const status = connectionManager.getConnectionStatus(phoneNumber);\n    const qr = connectionManager.getQRCode(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        phoneNumber,\n        status,\n        isConnected: connectionManager.isConnected(phoneNumber),\n        ...(qr && { qr }),\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function disconnectSession(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await connectionManager.disconnect(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Session ${phoneNumber} disconnected`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getAllSessions(req: Request, res: Response, next: NextFunction) {\n  try {\n    const connections = connectionManager.getAllConnections();\n    const sessions = Array.from(connections.keys()).map((phone) => ({\n      phoneNumber: phone,\n      status: connectionManager.getConnectionStatus(phone),\n      isConnected: connectionManager.isConnected(phone),\n    }));\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        total: sessions.length,\n        sessions,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getQRCodeImage(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    if (!connectionManager.getConnection(phoneNumber)) {\n      await connectionManager.createConnection(phoneNumber);\n    }\n\n    const qr = (await waitForQRCode(phoneNumber)) ?? connectionManager.getQRCode(phoneNumber);\n    if (!qr) {\n      const error: CustomError = new Error('QR not available');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const qrText = typeof qr === 'string' ? qr : String(qr);\n    const qrDataUrl = await qrcode.toDataURL(qrText);\n\n    if (req.query.format === 'json') {\n      res.status(HTTP_STATUS.OK).json({\n        success: true,\n        data: {\n          qr: qrText,\n          qrImage: qrDataUrl,\n        },\n      });\n      return;\n    }\n\n    const base64 = qrDataUrl.split(',')[1];\n    const buffer = Buffer.from(base64, 'base64');\n    res.setHeader('Content-Type', 'image/png');\n    res.status(HTTP_STATUS.OK).send(buffer);\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getGroupList(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(phoneNumber);\n    if (!isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.SERVICE_UNAVAILABLE;\n      return next(error);\n    }\n\n    const groups = await connectionManager.getGroups(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json(groups);\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function syncGroups(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(phoneNumber);\n    if (!isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.SERVICE_UNAVAILABLE;\n      return next(error);\n    }\n\n    const groups = await connectionManager.getGroups(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json(groups);\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getContactsHandler(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(phoneNumber);\n    if (!isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.SERVICE_UNAVAILABLE;\n      return next(error);\n    }\n\n    const contacts = await connectionManager.getContacts(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json(contacts);\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function logoutSession(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await connectionManager.disconnect(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Session ${phoneNumber} disconnected`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function listActiveSessions(req: Request, res: Response, next: NextFunction) {\n  return getAllSessions(req, res, next);\n}\n\n/**\n * \uD83D\uDD04 Restaurar sesi\u00F3n desde backup\n * POST /api/session/:phoneNumber/restore\n * Body: { backupTimestamp?: string } (opcional, usa el m\u00E1s reciente si no se especifica)\n */\nexport async function restoreSessionFromBackup(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n    const { backupTimestamp } = req.body;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    logger.info(`Attempting to restore session ${phoneNumber} from backup`);\n\n    // Desconectar sesi\u00F3n existente si hay\n    try {\n      await connectionManager.disconnect(phoneNumber);\n    } catch (e) {\n      // Ignorar si no hab\u00EDa sesi\u00F3n activa\n    }\n\n    // Restaurar desde backup\n    const restored = await connectionManager.restoreFromBackup(phoneNumber, backupTimestamp);\n\n    if (!restored) {\n      const error: CustomError = new Error('Failed to restore from backup - no backups found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    // Intentar reconectar con las credenciales restauradas\n    await connectionManager.createConnection(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Session ${phoneNumber} restored from backup and reconnecting`,\n      data: {\n        phoneNumber,\n        status: connectionManager.getConnectionStatus(phoneNumber),\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\n/**\n * \uD83D\uDCCB Listar backups disponibles para una sesi\u00F3n\n * GET /api/session/:phoneNumber/backups\n */\nexport async function listSessionBackups(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const backups = await connectionManager.listBackups(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        phoneNumber,\n        backups,\n        total: backups.length,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\n/**\n * \uD83D\uDD04 Forzar reinicio de reconexi\u00F3n (limpiar estado de reconexi\u00F3n)\n * POST /api/session/:phoneNumber/reset-reconnect\n */\nexport async function resetReconnectState(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { phoneNumber } = req.params;\n\n    if (!phoneNumber) {\n      const error: CustomError = new Error('phoneNumber is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    logger.info(`Resetting reconnect state for ${phoneNumber}`);\n\n    await connectionManager.resetReconnect(phoneNumber);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Reconnect state reset for ${phoneNumber}`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n", "import makeWASocket, {\n  DisconnectReason,\n  fetchLatestBaileysVersion,\n  useMultiFileAuthState,\n} from '@whiskeysockets/baileys';\nimport { isBoom } from '@hapi/boom';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport pino from 'pino';\nimport logger from '../../utils/logger.js';\nimport messageListener from '../ai-agent/message.listener.js';\nimport { config } from '../../config/environment.js';\nimport outboxQueue from '../queue/outbox-queue.js';\n\n// \uD83D\uDD07 Silenciar logs ruidosos de Signal Protocol/Baileys\nconst originalConsoleLog = console.log;\nconsole.log = (...args: any[]) => {\n  const message = args.join(' ');\n  // Filtrar mensajes de Signal Protocol que ensucian la consola\n  if (\n    message.includes('Closing open session in favor of') ||\n    message.includes('Closing session: SessionEntry') ||\n    message.includes('_chains:') ||\n    message.includes('registrationId:') ||\n    message.includes('currentRatchet:')\n  ) {\n    return; // Silenciar estos mensajes\n  }\n  originalConsoleLog.apply(console, args);\n};\n\nexport class ConnectionManager {\n  private connections: Map<string, any> = new Map();\n  private connectionStates: Map<string, 'open' | 'close' | 'connecting'> = new Map();\n  private qrCodes: Map<string, string> = new Map();\n  private contactsBySession: Map<string, Map<string, any>> = new Map();\n  private groupsCache: Map<string, { ts: number; data: Array<{ id: string; name: string }> }> =\n    new Map();\n  private groupsInFlight: Map<string, Promise<Array<{ id: string; name: string }>>> =\n    new Map();\n  private connectInFlight: Map<string, Promise<any>> = new Map();\n  private reconnectTimers: Map<string, ReturnType<typeof setTimeout>> = new Map();\n  private reconnectAttempts: Map<string, number> = new Map();\n  private connectWatchdogs: Map<string, ReturnType<typeof setTimeout>> = new Map();\n  private sessionRecoveryWatchdog: ReturnType<typeof setTimeout> | null = null;\n\n  async createConnection(sessionPhone: string): Promise<any> {\n    const existing = this.connections.get(sessionPhone);\n    if (existing) {\n      logger.debug(`Connection already exists for ${sessionPhone}`);\n      return existing;\n    }\n\n    const inFlight = this.connectInFlight.get(sessionPhone);\n    if (inFlight) {\n      return await inFlight;\n    }\n\n    const connectPromise = (async () => {\n      try {\n        logger.info(`Creating WhatsApp connection for ${sessionPhone}`);\n        this.connectionStates.set(sessionPhone, 'connecting');\n\n        const sessionDir = path.join(config.whatsapp.sessionDir, sessionPhone);\n        const credsPath = path.join(sessionDir, 'creds.json');\n\n        // \uD83D\uDEE1\uFE0F PROTECCI\u00D3N CR\u00CDTICA: Restaurar autom\u00E1ticamente desde backup si no hay credenciales\n        const hasCredentials = await fs.pathExists(credsPath);\n        if (!hasCredentials) {\n          logger.warn(`\u26A0\uFE0F No credentials found for ${sessionPhone}, attempting auto-recovery from backup`);\n          const recovered = await this.autoRecoverSession(sessionPhone);\n\n          if (recovered) {\n            logger.info(`\u2705 Successfully auto-recovered session ${sessionPhone} from backup`);\n          } else {\n            logger.warn(`\u26A0\uFE0F No valid backup found for ${sessionPhone}, will generate new QR`);\n          }\n        }\n\n        const { state, saveCreds } = await useMultiFileAuthState(sessionDir);\n        const { version } = await fetchLatestBaileysVersion();\n\n        // Crear socket\n        const socket = makeWASocket({\n          auth: state,\n          version,\n          syncFullHistory: false,\n          shouldIgnoreJid: (jid) => /status@broadcast/.test(jid),\n          printQRInTerminal: false,\n          logger: pino({ level: config.whatsapp.baileysLogLevel }),\n        });\n\n        this.contactsBySession.set(sessionPhone, new Map());\n\n        // Guardar conexi\u00F3n\n        this.connections.set(sessionPhone, socket);\n\n        // Configurar listeners\n        this.setupListeners(socket, sessionPhone, sessionDir, saveCreds);\n\n        return socket;\n      } catch (error) {\n        logger.error(`Error creating connection for ${sessionPhone}:`, error);\n        throw error;\n      }\n    })();\n\n    this.connectInFlight.set(sessionPhone, connectPromise);\n    try {\n      return await connectPromise;\n    } finally {\n      this.connectInFlight.delete(sessionPhone);\n    }\n  }\n\n  async ensureConnected(\n    sessionPhone: string,\n    timeoutMs = 15000,\n    intervalMs = 300\n  ): Promise<boolean> {\n    // \uD83D\uDEE1\uFE0F PUNTO CR\u00CDTICO: Este m\u00E9todo se llama antes de cada operaci\u00F3n (enviar mensaje, etc.)\n    // Aqu\u00ED debemos asegurar auto-recuperaci\u00F3n si no hay conexi\u00F3n\n\n    if (!this.connections.has(sessionPhone)) {\n      try {\n        // createConnection ya tiene auto-recuperaci\u00F3n integrada\n        await this.createConnection(sessionPhone);\n      } catch (error) {\n        logger.warn(`Failed to create connection for ${sessionPhone}, will schedule reconnect: ${error}`);\n        this.scheduleReconnect(sessionPhone, error);\n        return false;\n      }\n    }\n\n    if (this.isConnected(sessionPhone)) {\n      return true;\n    }\n\n    // Esperar a que la conexi\u00F3n se establezca\n    const start = Date.now();\n    const connected = await new Promise<boolean>((resolve) => {\n      const timer = setInterval(() => {\n        if (this.isConnected(sessionPhone)) {\n          clearInterval(timer);\n          resolve(true);\n          return;\n        }\n\n        if (Date.now() - start >= timeoutMs) {\n          clearInterval(timer);\n          resolve(false);\n        }\n      }, intervalMs);\n    });\n\n    if (!connected) {\n      logger.warn(`Connection timeout for ${sessionPhone} after ${timeoutMs}ms`);\n      this.cleanupSession(sessionPhone, { clearQr: false });\n      this.scheduleReconnect(sessionPhone);\n    }\n\n    return connected;\n  }\n\n  async reconnectSavedSessions(): Promise<void> {\n    const baseDir = path.resolve(config.whatsapp.sessionDir);\n    if (!(await fs.pathExists(baseDir))) {\n      return;\n    }\n\n    // 1. Reconectar sesiones con credenciales existentes\n    const entries = await fs.readdir(baseDir);\n    const sessionDirs = await Promise.all(\n      entries.map(async (entry) => {\n        const fullPath = path.join(baseDir, entry);\n        const stat = await fs.stat(fullPath);\n        return stat.isDirectory() && entry !== 'backups' ? entry : null;\n      })\n    );\n\n    const sessionsWithCreds: string[] = [];\n\n    for (const sessionPhone of sessionDirs.filter(Boolean) as string[]) {\n      const credsPath = path.join(baseDir, sessionPhone, 'creds.json');\n      if (await fs.pathExists(credsPath)) {\n        sessionsWithCreds.push(sessionPhone);\n        try {\n          await this.createConnection(sessionPhone);\n          logger.info(`\u2705 Reconnected session ${sessionPhone}`);\n        } catch (error) {\n          logger.warn(`Failed to reconnect session ${sessionPhone}: ${String(error)}`);\n        }\n      }\n    }\n\n    // 2. \uD83D\uDEE1\uFE0F RECUPERACI\u00D3N AUTOM\u00C1TICA: Buscar sesiones perdidas con backups disponibles\n    const backupBaseDir = path.join(baseDir, 'backups');\n    if (await fs.pathExists(backupBaseDir)) {\n      const backupEntries = await fs.readdir(backupBaseDir);\n\n      for (const sessionPhone of backupEntries) {\n        // Si esta sesi\u00F3n ya tiene credenciales, skip\n        if (sessionsWithCreds.includes(sessionPhone)) {\n          continue;\n        }\n\n        const backupDir = path.join(backupBaseDir, sessionPhone);\n        const stat = await fs.stat(backupDir);\n        if (!stat.isDirectory()) {\n          continue;\n        }\n\n        // Intentar recuperar esta sesi\u00F3n perdida\n        logger.info(`\uD83D\uDD0D Found session ${sessionPhone} with backups but no active credentials, attempting auto-recovery`);\n\n        try {\n          const recovered = await this.autoRecoverSession(sessionPhone);\n          if (recovered) {\n            await this.createConnection(sessionPhone);\n            logger.info(`\u2705 Auto-recovered and reconnected session ${sessionPhone}`);\n          }\n        } catch (error) {\n          logger.warn(`Failed to auto-recover session ${sessionPhone}: ${String(error)}`);\n        }\n      }\n    }\n  }\n\n  private setupListeners(socket: any, sessionPhone: string, sessionDir: string, saveCreds: any) {\n    // Conexi\u00F3n establecida\n    socket.ev.on('connection.update', async (update: any) => {\n      const { connection, lastDisconnect, qr } = update;\n\n      if (connection) {\n        this.connectionStates.set(sessionPhone, connection);\n      }\n\n      if (qr) {\n        const qrText = typeof qr === 'string' ? qr : String(qr);\n        logger.info(`QR Code for ${sessionPhone}`);\n        this.qrCodes.set(sessionPhone, qrText);\n        // Aqu\u00ED se podr\u00EDa emitir un evento para mostrar el QR en una interfaz web\n      }\n\n      if (connection === 'close') {\n        this.clearConnectWatchdog(sessionPhone);\n        const reason = this.getDisconnectReason(lastDisconnect?.error);\n        const errorMessage = lastDisconnect?.error ? String(lastDisconnect.error) : '';\n        const reasonName = this.getDisconnectReasonName(reason);\n\n        logger.warn(`Connection closed for ${sessionPhone}, reason: ${reason} (${reasonName}), error: ${errorMessage}`);\n\n        // \uD83D\uDEE1\uFE0F PROTECCI\u00D3N CR\u00CDTICA: Detectar errores de red/stream que NO deben borrar credenciales\n        const isNetworkError =\n          errorMessage.includes('Stream Errored') ||\n          errorMessage.includes('Connection Failure') ||\n          errorMessage.includes('Socket hang up') ||\n          errorMessage.includes('ECONNRESET') ||\n          errorMessage.includes('ETIMEDOUT') ||\n          errorMessage.includes('ENOTFOUND') ||\n          errorMessage.includes('timeout') ||\n          errorMessage.includes('timed out') ||\n          reason === 408 || // timedOut\n          reason === 428 || // connectionLost\n          reason === 500 || // restartRequired (no es 515!)\n          reason === 503;   // service unavailable\n\n        if (isNetworkError) {\n          logger.warn(`\uD83C\uDF10 Network/Stream error detected for ${sessionPhone}, preserving auth state and reconnecting`);\n          this.cleanupSession(sessionPhone, { clearQr: false });\n          this.scheduleReconnect(sessionPhone);\n          return;\n        }\n\n        // \uD83D\uDD12 PROTECCI\u00D3N 1: Solo borrar credenciales si es REALMENTE logout manual\n        // DisconnectReason.loggedOut (401) = Usuario hizo logout desde WhatsApp\n        if (reason === DisconnectReason.loggedOut || reason === 401) {\n          logger.warn(`\uD83D\uDD34 User manually logged out ${sessionPhone}, clearing auth state`);\n          await this.backupAndResetAuthState(sessionPhone, sessionDir);\n          this.cleanupSession(sessionPhone, { clearQr: true });\n          this.scheduleReconnect(sessionPhone);\n          return;\n        }\n\n        // \uD83D\uDD12 PROTECCI\u00D3N 2: badSession (403) - verificar si es genuino\n        if (reason === DisconnectReason.badSession || reason === 403) {\n          // Intentar restaurar desde backup reciente primero (< 24h)\n          let backupRestored = await this.tryRestoreRecentBackup(sessionPhone);\n\n          if (backupRestored) {\n            logger.info(`\u2705 Restored recent backup for ${sessionPhone}, attempting reconnect`);\n            this.cleanupSession(sessionPhone, { clearQr: false });\n            this.scheduleReconnect(sessionPhone);\n            return;\n          }\n\n          // Si no hay backup reciente, intentar ANY backup disponible (auto-recuperaci\u00F3n completa)\n          logger.warn(`\u26A0\uFE0F No recent backup for ${sessionPhone}, trying full auto-recovery`);\n          backupRestored = await this.autoRecoverSession(sessionPhone);\n\n          if (backupRestored) {\n            logger.info(`\u2705 Full auto-recovery successful for ${sessionPhone}, attempting reconnect`);\n            this.cleanupSession(sessionPhone, { clearQr: false });\n            this.scheduleReconnect(sessionPhone);\n            return;\n          }\n\n          // Solo borrar si genuinamente no hay ning\u00FAn backup disponible\n          logger.warn(`\uD83D\uDD34 Bad session detected for ${sessionPhone} (no backups available), clearing auth state`);\n          await this.backupAndResetAuthState(sessionPhone, sessionDir);\n          this.cleanupSession(sessionPhone, { clearQr: true });\n          this.scheduleReconnect(sessionPhone);\n          return;\n        }\n\n        // \uD83D\uDD12 PROTECCI\u00D3N 3: Preservar credenciales para errores recuperables\n        const shouldReconnect =\n          reason === DisconnectReason.connectionClosed ||\n          reason === DisconnectReason.connectionLost ||\n          reason === DisconnectReason.timedOut ||\n          reason === DisconnectReason.restartRequired ||\n          reason === DisconnectReason.connectionReplaced ||\n          reason === 411 || // connectionClosed\n          reason === 428 || // connectionLost\n          reason === 440 || // connectionReplaced\n          reason === 515;   // restartRequired (valor correcto de Baileys)\n\n        if (shouldReconnect) {\n          logger.info(`\u267B\uFE0F Reconnectable disconnect for ${sessionPhone}, preserving credentials`);\n          this.cleanupSession(sessionPhone, { clearQr: false });\n          this.scheduleReconnect(sessionPhone);\n        } else {\n          // Error desconocido - preservar credenciales por defecto (fail-safe)\n          logger.warn(`\u26A0\uFE0F Unknown disconnect reason ${reason} for ${sessionPhone}, preserving credentials and reconnecting`);\n          this.cleanupSession(sessionPhone, { clearQr: false });\n          this.scheduleReconnect(sessionPhone);\n        }\n      } else if (connection === 'open') {\n        this.clearConnectWatchdog(sessionPhone);\n        logger.info(`\u2705 Connection established for ${sessionPhone}`);\n        this.qrCodes.delete(sessionPhone);\n        this.resetReconnectState(sessionPhone);\n        await this.flushOutbox(sessionPhone);\n      } else if (connection === 'connecting') {\n        this.scheduleConnectWatchdog(sessionPhone);\n      }\n    });\n\n    socket.ev.on('messaging-history.set', (data: any) => {\n      const store = this.contactsBySession.get(sessionPhone);\n      if (!store || !data?.contacts) {\n        return;\n      }\n      data.contacts.forEach((contact: any) => {\n        if (contact?.id) {\n          store.set(contact.id, contact);\n        }\n      });\n    });\n\n    socket.ev.on('contacts.upsert', (contacts: any[]) => {\n      const store = this.contactsBySession.get(sessionPhone);\n      if (!store) {\n        return;\n      }\n      contacts.forEach((contact) => {\n        if (contact?.id) {\n          store.set(contact.id, contact);\n        }\n      });\n    });\n\n    socket.ev.on('contacts.update', (updates: any[]) => {\n      const store = this.contactsBySession.get(sessionPhone);\n      if (!store) {\n        return;\n      }\n      updates.forEach((update) => {\n        if (!update?.id) {\n          return;\n        }\n        const existing = store.get(update.id) || {};\n        store.set(update.id, { ...existing, ...update });\n      });\n    });\n\n    // Guardar credenciales\n    socket.ev.on('creds.update', saveCreds);\n\n    // Procesar mensajes\n    socket.ev.on('messages.upsert', async (m: any) => {\n      for (const message of m.messages) {\n        await messageListener.handleIncomingMessage(message, sessionPhone, socket);\n      }\n    });\n  }\n\n  async disconnect(sessionPhone: string): Promise<void> {\n    try {\n      // Limpiar timers de reconexi\u00F3n primero\n      this.resetReconnectState(sessionPhone);\n\n      const socket = this.connections.get(sessionPhone);\n      if (socket) {\n        await socket.end({\n          cancel: true,\n        });\n        this.cleanupSession(sessionPhone, { clearQr: true });\n        logger.info(`Disconnected ${sessionPhone}`);\n      }\n    } catch (error) {\n      logger.error(`Error disconnecting ${sessionPhone}:`, error);\n      this.cleanupSession(sessionPhone, { clearQr: true });\n    }\n  }\n\n  async disconnectAll(): Promise<void> {\n    // Detener watchdog de recuperaci\u00F3n\n    this.stopSessionRecoveryWatchdog();\n\n    for (const [sessionPhone] of this.connections) {\n      await this.disconnect(sessionPhone);\n    }\n  }\n\n  /**\n   * \uD83D\uDEE1\uFE0F WATCHDOG DE RECUPERACI\u00D3N AUTOM\u00C1TICA\n   * Ejecuta verificaci\u00F3n peri\u00F3dica cada 5 minutos para:\n   * 1. Detectar sesiones perdidas (sin conexi\u00F3n pero con backups disponibles)\n   * 2. Recuperar autom\u00E1ticamente desde backups\n   * 3. Intentar reconectar sesiones ca\u00EDdas\n   *\n   * Esto es una capa adicional de resiliencia que funciona incluso si\n   * los otros mecanismos de auto-recuperaci\u00F3n fallan.\n   */\n  startSessionRecoveryWatchdog(): void {\n    // Si ya est\u00E1 corriendo, no iniciar otro\n    if (this.sessionRecoveryWatchdog) {\n      return;\n    }\n\n    const runRecoveryCheck = async () => {\n      try {\n        logger.debug('\uD83D\uDD0D Running session recovery watchdog check...');\n\n        const baseDir = path.resolve(config.whatsapp.sessionDir);\n        const backupBaseDir = path.join(baseDir, 'backups');\n\n        if (!(await fs.pathExists(backupBaseDir))) {\n          return;\n        }\n\n        const backupEntries = await fs.readdir(backupBaseDir);\n\n        for (const sessionPhone of backupEntries) {\n          const backupDir = path.join(backupBaseDir, sessionPhone);\n          const stat = await fs.stat(backupDir);\n\n          if (!stat.isDirectory()) {\n            continue;\n          }\n\n          // Verificar si esta sesi\u00F3n est\u00E1 conectada\n          const isConnected = this.isConnected(sessionPhone);\n          const hasConnection = this.connections.has(sessionPhone);\n          const isReconnecting = this.reconnectTimers.has(sessionPhone);\n\n          // Si ya est\u00E1 conectada o reconectando, skip\n          if (isConnected || isReconnecting) {\n            continue;\n          }\n\n          // Si tiene conexi\u00F3n pero no est\u00E1 conectada, dejar que scheduleReconnect lo maneje\n          if (hasConnection && !isConnected) {\n            continue;\n          }\n\n          // Esta sesi\u00F3n no est\u00E1 conectada y no est\u00E1 en proceso de reconexi\u00F3n\n          const sessionDir = path.join(baseDir, sessionPhone);\n          const credsPath = path.join(sessionDir, 'creds.json');\n          const hasCredentials = await fs.pathExists(credsPath);\n\n          if (!hasCredentials) {\n            // Sesi\u00F3n perdida detectada - intentar auto-recuperaci\u00F3n\n            logger.info(`\uD83D\uDEA8 Watchdog detected lost session ${sessionPhone} with backups, attempting auto-recovery`);\n\n            const recovered = await this.autoRecoverSession(sessionPhone);\n\n            if (recovered) {\n              logger.info(`\u2705 Watchdog successfully recovered ${sessionPhone}, initiating reconnect`);\n              try {\n                await this.createConnection(sessionPhone);\n              } catch (error) {\n                logger.warn(`Watchdog recovery connect failed for ${sessionPhone}: ${error}`);\n                this.scheduleReconnect(sessionPhone, error);\n              }\n            } else {\n              logger.warn(`\u26A0\uFE0F Watchdog could not recover ${sessionPhone}, no valid backups`);\n            }\n          }\n        }\n      } catch (error) {\n        logger.error(`Session recovery watchdog error: ${error}`);\n      }\n    };\n\n    // Ejecutar cada 5 minutos\n    const intervalMs = 5 * 60 * 1000;\n\n    const scheduleNext = () => {\n      this.sessionRecoveryWatchdog = setTimeout(async () => {\n        await runRecoveryCheck();\n        scheduleNext();\n      }, intervalMs);\n    };\n\n    scheduleNext();\n    logger.info('\u2705 Session recovery watchdog started (checking every 5 minutes)');\n  }\n\n  /**\n   * Detener el watchdog de recuperaci\u00F3n\n   */\n  stopSessionRecoveryWatchdog(): void {\n    if (this.sessionRecoveryWatchdog) {\n      clearTimeout(this.sessionRecoveryWatchdog);\n      this.sessionRecoveryWatchdog = null;\n      logger.info('Session recovery watchdog stopped');\n    }\n  }\n\n  async sendTextMessage(\n    sessionPhone: string,\n    recipient: string,\n    text: string,\n    options: { queueOnFail?: boolean } = {}\n  ): Promise<{ queued: boolean }> {\n    const isConnected = await this.ensureConnected(sessionPhone);\n    const queueOnFail = options.queueOnFail !== false;\n\n    if (!isConnected) {\n      if (queueOnFail) {\n        await outboxQueue.enqueue(sessionPhone, recipient, text);\n        return { queued: true };\n      }\n      throw new Error('Session not connected');\n    }\n\n    const socket = this.connections.get(sessionPhone);\n    if (!socket) {\n      if (queueOnFail) {\n        await outboxQueue.enqueue(sessionPhone, recipient, text);\n        return { queued: true };\n      }\n      throw new Error('Session not connected');\n    }\n\n    try {\n      await socket.sendMessage(recipient, { text });\n      return { queued: false };\n    } catch (error) {\n      logger.warn(`Failed to send message via ${sessionPhone}: ${String(error)}`);\n      await this.disconnect(sessionPhone);\n      this.scheduleReconnect(sessionPhone, error);\n      if (queueOnFail) {\n        await outboxQueue.enqueue(sessionPhone, recipient, text);\n        return { queued: true };\n      }\n      throw error;\n    }\n  }\n\n  getConnection(sessionPhone: string): any {\n    return this.connections.get(sessionPhone);\n  }\n\n  getAllConnections(): Map<string, any> {\n    return this.connections;\n  }\n\n  getQRCode(sessionPhone: string): string | undefined {\n    return this.qrCodes.get(sessionPhone);\n  }\n\n  isConnected(sessionPhone: string): boolean {\n    return this.connectionStates.get(sessionPhone) === 'open';\n  }\n\n  getConnectionStatus(sessionPhone: string): string {\n    const state = this.connectionStates.get(sessionPhone);\n    if (state === 'open') return 'connected';\n    if (this.qrCodes.has(sessionPhone)) return 'waiting_qr';\n    if (state === 'connecting') return 'connecting';\n    return 'disconnected';\n  }\n\n  async getGroups(sessionPhone: string) {\n    const socket = this.connections.get(sessionPhone);\n    if (!socket) {\n      throw new Error('Session not connected');\n    }\n    const cacheTtlMs = 60 * 1000;\n    const cached = this.groupsCache.get(sessionPhone);\n    if (cached && Date.now() - cached.ts < cacheTtlMs) {\n      return cached.data;\n    }\n\n    const inFlight = this.groupsInFlight.get(sessionPhone);\n    if (inFlight) {\n      return await inFlight;\n    }\n\n    const fetchPromise = (async () => {\n      try {\n        const groups = await socket.groupFetchAllParticipating();\n        const data = Object.values(groups || {}).map((group: any) => ({\n          id: group.id,\n          name: group.subject,\n        }));\n        this.groupsCache.set(sessionPhone, { ts: Date.now(), data });\n        return data;\n      } catch (error) {\n        const message = String(error);\n        if (message.includes('rate-overlimit') && cached) {\n          logger.warn(`Using cached groups for ${sessionPhone} after rate limit`);\n          return cached.data;\n        }\n        throw error;\n      } finally {\n        this.groupsInFlight.delete(sessionPhone);\n      }\n    })();\n\n    this.groupsInFlight.set(sessionPhone, fetchPromise);\n    return await fetchPromise;\n  }\n\n  async getContacts(sessionPhone: string) {\n    const socket = this.connections.get(sessionPhone);\n    if (!socket) {\n      throw new Error('Session not connected');\n    }\n\n    const store = this.contactsBySession.get(sessionPhone);\n    const storeContacts = store ? Array.from(store.values()) : [];\n    const socketContacts = Object.values(socket.contacts || {});\n    const contacts = storeContacts.length > 0 ? storeContacts : socketContacts;\n    return contacts.map((contact: any) => ({\n      id: contact.id,\n      name: contact.name || contact.notify || null,\n      number: contact.id ? contact.id.split('@')[0] : null,\n      isBusiness: Boolean(contact.isBusiness),\n      isMyContact: Boolean(contact.isMyContact),\n    }));\n  }\n\n  private cleanupSession(\n    sessionPhone: string,\n    options: { clearQr?: boolean } = {}\n  ): void {\n    this.connections.delete(sessionPhone);\n    this.connectionStates.set(sessionPhone, 'close');\n    this.contactsBySession.delete(sessionPhone);\n    this.groupsCache.delete(sessionPhone);\n    this.groupsInFlight.delete(sessionPhone);\n    this.clearConnectWatchdog(sessionPhone);\n    if (options.clearQr) {\n      this.qrCodes.delete(sessionPhone);\n    }\n  }\n\n  private resetReconnectState(sessionPhone: string): void {\n    const timer = this.reconnectTimers.get(sessionPhone);\n    if (timer) {\n      clearTimeout(timer);\n      this.reconnectTimers.delete(sessionPhone);\n    }\n    this.reconnectAttempts.delete(sessionPhone);\n  }\n\n  private scheduleReconnect(sessionPhone: string, error?: unknown): void {\n    if (!config.whatsapp.autoReconnect) {\n      return;\n    }\n\n    if (this.reconnectTimers.has(sessionPhone)) {\n      return;\n    }\n\n    const currentAttempts = this.reconnectAttempts.get(sessionPhone) || 0;\n    const nextAttempt = currentAttempts + 1;\n    this.reconnectAttempts.set(sessionPhone, nextAttempt);\n\n    const maxAttempts = config.whatsapp.maxReconnectAttempts;\n    if (maxAttempts > 0 && nextAttempt > maxAttempts) {\n      logger.error(`Reconnect attempts exhausted for ${sessionPhone} after ${maxAttempts} attempts`);\n\n      // \uD83D\uDEE1\uFE0F \u00DALTIMO INTENTO: Verificar si hay backup disponible\n      (async () => {\n        const hasBackup = await this.hasAvailableBackup(sessionPhone);\n        if (hasBackup) {\n          logger.info(`\uD83D\uDCA1 Found backup for ${sessionPhone}, attempting final auto-recovery`);\n          const recovered = await this.autoRecoverSession(sessionPhone);\n          if (recovered) {\n            logger.info(`\u2705 Final auto-recovery successful for ${sessionPhone}, resetting reconnect attempts`);\n            this.reconnectAttempts.delete(sessionPhone);\n            this.scheduleReconnect(sessionPhone);\n          }\n        } else {\n          logger.info(`\uD83D\uDCA1 No backups available for ${sessionPhone}, manual QR scan required`);\n        }\n      })();\n\n      return;\n    }\n\n    // Backoff exponencial pero m\u00E1s conservador\n    // 2s, 4s, 8s, 16s, 32s, 60s (max)\n    const delayMs = Math.min(60000, 2000 * Math.pow(2, nextAttempt - 1));\n    const message = `Scheduling reconnect for ${sessionPhone} in ${delayMs}ms (attempt ${nextAttempt}/${maxAttempts || '\u221E'})`;\n    if (error) {\n      logger.warn(message, { error: String(error) });\n    } else {\n      logger.warn(message);\n    }\n\n    const timer = setTimeout(async () => {\n      this.reconnectTimers.delete(sessionPhone);\n\n      // \uD83D\uDEE1\uFE0F Verificar si hay credenciales, si no, intentar auto-recuperaci\u00F3n\n      const sessionDir = path.join(config.whatsapp.sessionDir, sessionPhone);\n      const credsPath = path.join(sessionDir, 'creds.json');\n      const hasCredentials = await fs.pathExists(credsPath);\n\n      if (!hasCredentials) {\n        logger.warn(`\u26A0\uFE0F No credentials found for ${sessionPhone}, attempting auto-recovery from backup`);\n\n        const recovered = await this.autoRecoverSession(sessionPhone);\n\n        if (!recovered) {\n          logger.error(`\u274C Auto-recovery failed for ${sessionPhone}, no valid backups found`);\n          // Continuar intentando - quiz\u00E1s el backup se cree en el siguiente ciclo\n          this.scheduleReconnect(sessionPhone);\n          return;\n        }\n\n        logger.info(`\u2705 Auto-recovered credentials for ${sessionPhone}, proceeding with reconnect`);\n      }\n\n      try {\n        logger.info(`\uD83D\uDD04 Attempting reconnect ${nextAttempt}/${maxAttempts || '\u221E'} for ${sessionPhone}...`);\n        await this.createConnection(sessionPhone);\n      } catch (err) {\n        logger.warn(`Reconnect failed for ${sessionPhone}: ${String(err)}`);\n        this.scheduleReconnect(sessionPhone, err);\n      }\n    }, delayMs);\n\n    this.reconnectTimers.set(sessionPhone, timer);\n  }\n\n  /**\n   * \uD83D\uDEE1\uFE0F PROTECCI\u00D3N: Backup antes de eliminar credenciales\n   * Crea un backup timestamped de las credenciales antes de borrarlas\n   * para permitir recuperaci\u00F3n manual si es necesario\n   */\n  private async backupAndResetAuthState(sessionPhone: string, sessionDir: string): Promise<void> {\n    try {\n      const credsPath = path.join(sessionDir, 'creds.json');\n      const credsExist = await fs.pathExists(credsPath);\n\n      if (credsExist) {\n        // Crear backup con timestamp\n        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n        const backupDir = path.join(sessionDir, '..', 'backups', sessionPhone);\n        const backupPath = path.join(backupDir, `creds-${timestamp}.json`);\n\n        await fs.ensureDir(backupDir);\n        await fs.copy(credsPath, backupPath);\n\n        logger.info(`\u2705 Backed up credentials for ${sessionPhone} to ${backupPath}`);\n\n        // Mantener solo los \u00FAltimos 20 backups (aumentado para mayor seguridad)\n        await this.cleanupOldBackups(backupDir, 20);\n      }\n\n      // Ahora s\u00ED, eliminar el directorio de sesi\u00F3n\n      await fs.remove(sessionDir);\n      logger.info(`\uD83D\uDDD1\uFE0F Auth state cleared for ${sessionPhone}`);\n    } catch (error) {\n      logger.error(`\u274C Failed to backup/clear auth state for ${sessionPhone}:`, error);\n    }\n  }\n\n  /**\n   * Mantiene solo los N backups m\u00E1s recientes\n   * Aumentado a 20 backups para mayor seguridad de recuperaci\u00F3n\n   */\n  private async cleanupOldBackups(backupDir: string, keepCount: number = 20): Promise<void> {\n    try {\n      const files = await fs.readdir(backupDir);\n      const backupFiles = files\n        .filter((f) => f.startsWith('creds-') && f.endsWith('.json'))\n        .sort()\n        .reverse(); // M\u00E1s recientes primero\n\n      // Eliminar backups antiguos\n      for (let i = keepCount; i < backupFiles.length; i++) {\n        await fs.remove(path.join(backupDir, backupFiles[i]));\n      }\n    } catch (error) {\n      logger.warn(`Failed to cleanup old backups: ${error}`);\n    }\n  }\n\n  /**\n   * \uD83D\uDD04 Restaurar credenciales desde backup (para recuperaci\u00F3n manual)\n   */\n  async restoreFromBackup(sessionPhone: string, backupTimestamp?: string): Promise<boolean> {\n    try {\n      const sessionDir = path.join(config.whatsapp.sessionDir, sessionPhone);\n      const backupDir = path.join(config.whatsapp.sessionDir, 'backups', sessionPhone);\n\n      if (!(await fs.pathExists(backupDir))) {\n        logger.error(`No backups found for ${sessionPhone}`);\n        return false;\n      }\n\n      let backupFile: string;\n\n      if (backupTimestamp) {\n        backupFile = `creds-${backupTimestamp}.json`;\n      } else {\n        // Usar el backup m\u00E1s reciente\n        const files = await fs.readdir(backupDir);\n        const backups = files.filter((f) => f.startsWith('creds-') && f.endsWith('.json')).sort().reverse();\n\n        if (backups.length === 0) {\n          logger.error(`No backup files found for ${sessionPhone}`);\n          return false;\n        }\n\n        backupFile = backups[0];\n      }\n\n      const backupPath = path.join(backupDir, backupFile);\n      const restorePath = path.join(sessionDir, 'creds.json');\n\n      await fs.ensureDir(sessionDir);\n      await fs.copy(backupPath, restorePath);\n\n      logger.info(`\u2705 Restored credentials for ${sessionPhone} from ${backupFile}`);\n      return true;\n    } catch (error) {\n      logger.error(`\u274C Failed to restore backup for ${sessionPhone}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * \uD83D\uDCCB Listar todos los backups disponibles para una sesi\u00F3n\n   */\n  async listBackups(sessionPhone: string): Promise<Array<{ filename: string; timestamp: string; size: number; age: string }>> {\n    try {\n      const backupDir = path.join(config.whatsapp.sessionDir, 'backups', sessionPhone);\n\n      if (!(await fs.pathExists(backupDir))) {\n        return [];\n      }\n\n      const files = await fs.readdir(backupDir);\n      const backups = files.filter((f) => f.startsWith('creds-') && f.endsWith('.json')).sort().reverse();\n\n      const backupList = await Promise.all(\n        backups.map(async (file) => {\n          const filePath = path.join(backupDir, file);\n          const stats = await fs.stat(filePath);\n          const now = Date.now();\n          const ageMs = now - stats.mtimeMs;\n          const ageHours = Math.floor(ageMs / (1000 * 60 * 60));\n          const ageDays = Math.floor(ageHours / 24);\n\n          let ageStr: string;\n          if (ageDays > 0) {\n            ageStr = `${ageDays}d ${ageHours % 24}h ago`;\n          } else if (ageHours > 0) {\n            ageStr = `${ageHours}h ago`;\n          } else {\n            const ageMinutes = Math.floor(ageMs / (1000 * 60));\n            ageStr = `${ageMinutes}m ago`;\n          }\n\n          return {\n            filename: file,\n            timestamp: stats.mtime.toISOString(),\n            size: stats.size,\n            age: ageStr,\n          };\n        })\n      );\n\n      return backupList;\n    } catch (error) {\n      logger.error(`Failed to list backups for ${sessionPhone}:`, error);\n      return [];\n    }\n  }\n\n  /**\n   * \uD83D\uDD04 Resetear estado de reconexi\u00F3n (\u00FAtil cuando se queda en bucle)\n   */\n  async resetReconnect(sessionPhone: string): Promise<void> {\n    logger.info(`Resetting reconnect state for ${sessionPhone}`);\n    this.resetReconnectState(sessionPhone);\n  }\n\n  /**\n   * \uD83D\uDD0D Mejorada: Extrae el DisconnectReason con logging detallado\n   */\n  private getDisconnectReason(error: unknown): number | undefined {\n    if (isBoom(error)) {\n      const statusCode = error.output?.statusCode;\n      logger.debug(`Boom error detected: ${statusCode} - ${error.message}`);\n      return statusCode;\n    }\n\n    if (!error || typeof error !== 'object') {\n      return undefined;\n    }\n\n    const maybe = error as { output?: { statusCode?: number }; statusCode?: number };\n    const statusCode = maybe.output?.statusCode ?? maybe.statusCode;\n\n    // Log para debugging\n    if (statusCode) {\n      const reasonName = this.getDisconnectReasonName(statusCode);\n      logger.debug(`Disconnect reason: ${statusCode} (${reasonName})`);\n    }\n\n    return statusCode;\n  }\n\n  /**\n   * \uD83D\uDCDD Helper: Convierte c\u00F3digo num\u00E9rico a nombre legible\n   * Nota: Baileys usa c\u00F3digos HTTP como DisconnectReason\n   */\n  private getDisconnectReasonName(code: number | undefined): string {\n    if (!code) return 'unknown';\n\n    const reasons: Record<number, string> = {\n      401: 'loggedOut',\n      403: 'badSession',\n      408: 'timedOut/connectionLost',\n      411: 'multideviceMismatch',\n      428: 'connectionClosed',\n      440: 'connectionReplaced',\n      500: 'internalError/streamError',\n      503: 'serviceUnavailable',\n      515: 'restartRequired',\n    };\n    return reasons[code] || `unknown(${code})`;\n  }\n\n  /**\n   * \uD83D\uDD04 Intenta restaurar desde el backup m\u00E1s reciente si existe y es reciente (< 24h)\n   * Esto previene p\u00E9rdida de sesi\u00F3n por errores transitorios\n   * NOTA: Este m\u00E9todo se llama solo en caso de badSession para restauraci\u00F3n r\u00E1pida\n   */\n  private async tryRestoreRecentBackup(sessionPhone: string): Promise<boolean> {\n    try {\n      const backupDir = path.join(config.whatsapp.sessionDir, 'backups', sessionPhone);\n\n      if (!(await fs.pathExists(backupDir))) {\n        return false;\n      }\n\n      const files = await fs.readdir(backupDir);\n      const backups = files\n        .filter((f) => f.startsWith('creds-') && f.endsWith('.json'))\n        .sort()\n        .reverse(); // M\u00E1s recientes primero\n\n      if (backups.length === 0) {\n        return false;\n      }\n\n      // Obtener el backup m\u00E1s reciente\n      const latestBackup = backups[0];\n      const backupPath = path.join(backupDir, latestBackup);\n      const backupStats = await fs.stat(backupPath);\n\n      // Solo restaurar si el backup tiene menos de 24 horas\n      const twentyFourHoursAgo = Date.now() - 24 * 60 * 60 * 1000;\n      if (backupStats.mtimeMs < twentyFourHoursAgo) {\n        logger.warn(`Latest backup for ${sessionPhone} is too old (${latestBackup}), skipping quick restore`);\n        return false;\n      }\n\n      // Restaurar el backup\n      const sessionDir = path.join(config.whatsapp.sessionDir, sessionPhone);\n      const restorePath = path.join(sessionDir, 'creds.json');\n\n      await fs.ensureDir(sessionDir);\n      await fs.copy(backupPath, restorePath);\n\n      logger.info(`\u2705 Auto-restored credentials for ${sessionPhone} from recent backup (${latestBackup})`);\n      return true;\n    } catch (error) {\n      logger.warn(`Failed to auto-restore recent backup for ${sessionPhone}: ${error}`);\n      return false;\n    }\n  }\n\n  /**\n   * \uD83D\uDEE1\uFE0F AUTO-RECUPERACI\u00D3N COMPLETA: Intenta restaurar sesi\u00F3n desde CUALQUIER backup disponible\n   * Este m\u00E9todo es m\u00E1s agresivo que tryRestoreRecentBackup:\n   * - No tiene l\u00EDmite de tiempo (acepta backups antiguos)\n   * - Valida que el backup sea v\u00E1lido antes de restaurar\n   * - Es la \u00FAltima l\u00EDnea de defensa contra p\u00E9rdida de sesi\u00F3n\n   *\n   * Se llama autom\u00E1ticamente en:\n   * - createConnection (si no hay credenciales)\n   * - scheduleReconnect (si no hay credenciales)\n   * - reconnectSavedSessions (para sesiones perdidas con backups)\n   */\n  private async autoRecoverSession(sessionPhone: string): Promise<boolean> {\n    try {\n      const backupDir = path.join(config.whatsapp.sessionDir, 'backups', sessionPhone);\n\n      if (!(await fs.pathExists(backupDir))) {\n        logger.debug(`No backup directory found for ${sessionPhone}`);\n        return false;\n      }\n\n      const files = await fs.readdir(backupDir);\n      const backups = files\n        .filter((f) => f.startsWith('creds-') && f.endsWith('.json'))\n        .sort()\n        .reverse(); // M\u00E1s recientes primero\n\n      if (backups.length === 0) {\n        logger.debug(`No backup files found for ${sessionPhone}`);\n        return false;\n      }\n\n      // Intentar restaurar desde el backup m\u00E1s reciente (sin l\u00EDmite de tiempo)\n      for (const backupFile of backups) {\n        const backupPath = path.join(backupDir, backupFile);\n\n        try {\n          // Validar que el backup tenga contenido v\u00E1lido\n          const backupStats = await fs.stat(backupPath);\n          if (backupStats.size < 100) {\n            logger.warn(`Backup ${backupFile} is too small (${backupStats.size} bytes), skipping`);\n            continue;\n          }\n\n          // Intentar leer el backup para validar que sea JSON v\u00E1lido\n          const backupContent = await fs.readJson(backupPath);\n          if (!backupContent || typeof backupContent !== 'object') {\n            logger.warn(`Backup ${backupFile} has invalid content, skipping`);\n            continue;\n          }\n\n          // Backup v\u00E1lido encontrado, restaurar\n          const sessionDir = path.join(config.whatsapp.sessionDir, sessionPhone);\n          const restorePath = path.join(sessionDir, 'creds.json');\n\n          await fs.ensureDir(sessionDir);\n          await fs.copy(backupPath, restorePath);\n\n          const age = this.getBackupAge(backupStats.mtimeMs);\n          logger.info(`\u2705 Auto-recovered session ${sessionPhone} from backup ${backupFile} (${age} old)`);\n\n          return true;\n        } catch (error) {\n          logger.warn(`Failed to restore from backup ${backupFile}: ${error}`);\n          // Continuar con el siguiente backup\n          continue;\n        }\n      }\n\n      logger.warn(`\u26A0\uFE0F No valid backups found for ${sessionPhone} (tried ${backups.length} backups)`);\n      return false;\n    } catch (error) {\n      logger.error(`\u274C Auto-recovery failed for ${sessionPhone}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * \uD83D\uDD0D Verifica si hay backups disponibles para una sesi\u00F3n\n   */\n  private async hasAvailableBackup(sessionPhone: string): Promise<boolean> {\n    try {\n      const backupDir = path.join(config.whatsapp.sessionDir, 'backups', sessionPhone);\n\n      if (!(await fs.pathExists(backupDir))) {\n        return false;\n      }\n\n      const files = await fs.readdir(backupDir);\n      const backups = files.filter((f) => f.startsWith('creds-') && f.endsWith('.json'));\n\n      return backups.length > 0;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * \uD83D\uDCC5 Helper: Calcula la edad de un backup en formato legible\n   */\n  private getBackupAge(timestampMs: number): string {\n    const ageMs = Date.now() - timestampMs;\n    const ageHours = Math.floor(ageMs / (1000 * 60 * 60));\n    const ageDays = Math.floor(ageHours / 24);\n\n    if (ageDays > 0) {\n      return `${ageDays}d ${ageHours % 24}h`;\n    } else if (ageHours > 0) {\n      return `${ageHours}h`;\n    } else {\n      const ageMinutes = Math.floor(ageMs / (1000 * 60));\n      return `${ageMinutes}m`;\n    }\n  }\n\n  private scheduleConnectWatchdog(sessionPhone: string): void {\n    if (this.connectWatchdogs.has(sessionPhone)) {\n      return;\n    }\n\n    // Aumentado de 30s a 90s para dar m\u00E1s tiempo a conexiones lentas\n    // WhatsApp puede tardar en conectar dependiendo de la red\n    const timer = setTimeout(() => {\n      this.connectWatchdogs.delete(sessionPhone);\n      if (this.connectionStates.get(sessionPhone) !== 'open') {\n        const hasQR = this.qrCodes.has(sessionPhone);\n\n        // Si hay QR esperando ser escaneado, NO reconectar autom\u00E1ticamente\n        // esto evita bucles infinitos de QR\n        if (hasQR) {\n          logger.info(`Connection watchdog: ${sessionPhone} has QR code waiting, not auto-reconnecting`);\n          return;\n        }\n\n        logger.warn(`Connection watchdog triggered for ${sessionPhone} (no connection after 90s)`);\n        this.cleanupSession(sessionPhone, { clearQr: false });\n        this.scheduleReconnect(sessionPhone);\n      }\n    }, 90000); // 90 segundos\n\n    this.connectWatchdogs.set(sessionPhone, timer);\n  }\n\n  private clearConnectWatchdog(sessionPhone: string): void {\n    const timer = this.connectWatchdogs.get(sessionPhone);\n    if (timer) {\n      clearTimeout(timer);\n      this.connectWatchdogs.delete(sessionPhone);\n    }\n  }\n\n  private async flushOutbox(sessionPhone: string): Promise<void> {\n    const socket = this.connections.get(sessionPhone);\n    if (!socket || !this.isConnected(sessionPhone)) {\n      return;\n    }\n\n    const queue = await outboxQueue.list(sessionPhone);\n    if (queue.length === 0) {\n      return;\n    }\n\n    logger.info(`Flushing ${queue.length} queued messages for ${sessionPhone}`);\n\n    for (const item of queue) {\n      try {\n        await socket.sendMessage(item.recipient, { text: item.text });\n        await outboxQueue.remove(sessionPhone, item.id);\n      } catch (error) {\n        const updated = {\n          ...item,\n          attempts: item.attempts + 1,\n          lastError: String(error),\n        };\n        await outboxQueue.update(sessionPhone, updated);\n        logger.warn(`Failed to flush queued message ${item.id}: ${String(error)}`);\n        break;\n      }\n    }\n  }\n}\n\nexport default new ConnectionManager();\n", "import logger from '../../utils/logger.js';\nimport agentService from './agent.service.js';\nimport conversationManager from './conversation.manager.js';\nimport typingSimulator from './typing-simulator.js';\nimport { WhatsAppMessage, Conversation } from '../../types/index.js';\nimport { validateMessage } from '../../utils/validators.js';\nimport { config } from '../../config/environment.js';\n\nexport class MessageListener {\n  private activeConversations: Map<string, Conversation> = new Map();\n\n  async handleIncomingMessage(\n    message: WhatsAppMessage,\n    sessionPhone: string,\n    whatsAppClient: any\n  ): Promise<void> {\n    try {\n      // disabled for test \n      return\n      // 1. Filtrar mensajes propios\n      if (message.key.fromMe) {\n        return;\n      }\n\n      // 2. Validar que es un mensaje de texto\n      if (!validateMessage(message.message)) {\n        logger.debug(`Skipping non-text message from ${message.key.remoteJid}`);\n        return;\n      }\n\n      // 3. Extraer informaci\u00F3n del remitente\n      const chatId = message.key.remoteJid;\n      const messageText =\n        message.message?.conversation ||\n        message.message?.extendedTextMessage?.text ||\n        '';\n\n      if (!messageText.trim()) {\n        return;\n      }\n\n      // 4. Ignorar si es un grupo y el bot no est\u00E1 habilitado\n      const isGroup = chatId.endsWith('@g.us');\n      if (isGroup && !this.isGroupEnabled(chatId)) {\n        logger.debug(`Group ${chatId} not enabled for bot`);\n        return;\n      }\n\n      // 4.1 Respetar modo IA desactivado o modo prueba\n      if (!this.isAiAllowed(chatId, isGroup)) {\n        logger.debug(`AI disabled or not allowed for ${chatId}`);\n        return;\n      }\n\n      logger.info(\n        `Incoming message from ${chatId} (session: ${sessionPhone}): ${messageText.substring(0, 50)}`\n      );\n\n      // 5. Obtener o crear conversaci\u00F3n\n      const conversation = await conversationManager.getOrCreate(chatId, sessionPhone);\n\n      // 6. Verificar si est\u00E1 en handoff a humano\n      if (conversation.state === 'waiting_human') {\n        await this.notifyHumanAgent(conversation, messageText);\n        return;\n      }\n\n      // 7. Agregar mensaje al historial\n      conversation.messageHistory.push({\n        role: 'user',\n        content: messageText,\n        timestamp: new Date().toISOString(),\n      });\n\n      // 8. Procesar con IA\n      await this.processWithAI(conversation, messageText, whatsAppClient);\n    } catch (error) {\n      logger.error('Error handling incoming message:', error);\n    }\n  }\n\n  private async processWithAI(\n    conversation: Conversation,\n    message: string,\n    whatsAppClient: any\n  ): Promise<void> {\n    try {\n      // 1. Simular \"escribiendo...\"\n      await whatsAppClient.sendPresenceUpdate('composing', conversation.chatId);\n\n      // 2. Obtener respuesta del agente\n      const response = await agentService.generateResponse(conversation, message);\n\n      // 3. Simular tiempo de escritura humano\n      await typingSimulator.simulateTyping(response.text);\n\n      // 4. Enviar respuesta\n      await whatsAppClient.sendMessage(conversation.chatId, {\n        text: response.text,\n      });\n\n      logger.info(\n        `Response sent to ${conversation.chatId}: ${response.text.substring(0, 50)}`\n      );\n\n      // 5. Actualizar conversaci\u00F3n\n      conversation.messageHistory.push({\n        role: 'assistant',\n        content: response.text,\n        timestamp: new Date().toISOString(),\n      });\n\n      conversation.lastMessageAt = new Date().toISOString();\n\n      // 6. Actualizar estado si es necesario\n      if (response.nextState) {\n        conversation.state = response.nextState;\n      }\n\n      // 7. Guardar conversaci\u00F3n\n      await conversationManager.save(conversation);\n\n      // 8. Detener \"escribiendo...\"\n      await whatsAppClient.sendPresenceUpdate('paused', conversation.chatId);\n    } catch (error) {\n      logger.error('Error processing message with AI:', error);\n      await this.sendErrorMessage(conversation.chatId, whatsAppClient);\n    }\n  }\n\n  private isGroupEnabled(groupId: string): boolean {\n    // Por ahora todos los grupos est\u00E1n habilitados\n    // En el futuro se puede hacer m\u00E1s sofisticado\n    return true;\n  }\n\n  private isAiAllowed(chatId: string, isGroup: boolean): boolean {\n    if (config.whatsapp.aiEnabled) {\n      return true;\n    }\n\n    if (isGroup) {\n      return false;\n    }\n\n    const raw = chatId.split('@')[0] || '';\n    const phone = raw.replace(/[^\\d]/g, '');\n    return phone === config.whatsapp.aiTestNumber;\n  }\n\n  private async notifyHumanAgent(\n    conversation: Conversation,\n    message: string\n  ): Promise<void> {\n    logger.info(\n      `New message for human agent in conversation ${conversation.chatId}: ${message}`\n    );\n    // Aqu\u00ED ir\u00EDa l\u00F3gica para notificar a un asesor humano\n    // Por ejemplo, enviar webhook, email, etc.\n  }\n\n  private async sendErrorMessage(chatId: string, whatsAppClient: any): Promise<void> {\n    try {\n      await whatsAppClient.sendMessage(chatId, {\n        text: 'Disculpa, tuve un problema procesando tu mensaje. \u00BFPodr\u00EDas repetirlo?',\n      });\n    } catch (error) {\n      logger.error('Error sending error message:', error);\n    }\n  }\n}\n\nexport default new MessageListener();\n", "import Anthropic from '@anthropic-ai/sdk';\nimport logger from '../../utils/logger.js';\nimport { SYSTEM_PROMPT, getUserContextPrompt } from './prompts/asphalt-sales.prompt.js';\nimport { Conversation, AgentResponse } from '../../types/index.js';\nimport { CLAUDE_MODEL, CLAUDE_MAX_TOKENS } from '../../config/constants.js';\n\nexport class AgentService {\n  private client: Anthropic;\n\n  constructor() {\n    this.client = new Anthropic({\n      apiKey: process.env.ANTHROPIC_API_KEY!,\n    });\n  }\n\n  async generateResponse(\n    conversation: Conversation,\n    userMessage: string\n  ): Promise<AgentResponse> {\n    try {\n      logger.debug(`Generating response for conversation ${conversation.chatId}`);\n\n      // Preparar mensajes para Claude\n      const messages = this.prepareMessages(conversation, userMessage);\n\n      // Llamar a Claude API\n      const response = await this.client.messages.create({\n        model: CLAUDE_MODEL,\n        max_tokens: CLAUDE_MAX_TOKENS,\n        system: SYSTEM_PROMPT + '\\n\\n' + getUserContextPrompt(conversation),\n        messages: messages,\n      });\n\n      const assistantMessage = response.content[0].type === 'text' \n        ? response.content[0].text \n        : '';\n\n      if (!assistantMessage) {\n        throw new Error('No text in response from Claude');\n      }\n\n      // Analizar respuesta para detectar cambios de estado\n      const analysis = this.analyzeResponse(assistantMessage, conversation);\n\n      logger.debug(\n        `Response generated. Next state: ${analysis.nextState}, Handoff: ${analysis.shouldHandoff}`\n      );\n\n      return {\n        text: assistantMessage,\n        nextState: analysis.nextState,\n        shouldHandoff: analysis.shouldHandoff,\n      };\n    } catch (error) {\n      logger.error('Error calling Claude API:', error);\n      throw error;\n    }\n  }\n\n  private prepareMessages(conversation: Conversation, newMessage: string) {\n    // Tomar \u00FAltimos 10 mensajes para contexto\n    const recentMessages = conversation.messageHistory.slice(-10);\n\n    const messages = recentMessages.map((msg: any) => ({\n      role: msg.role as 'user' | 'assistant',\n      content: msg.content,\n    }));\n\n    // Agregar nuevo mensaje\n    messages.push({\n      role: 'user' as const,\n      content: newMessage,\n    });\n\n    return messages;\n  }\n\n  private analyzeResponse(text: string, conversation: Conversation) {\n    // Detectar keywords de handoff\n    const handoffKeywords = [\n      'conectarte con un supervisor',\n      'derivar',\n      'hablar con un especialista',\n      'ingeniero especializado',\n      'perm\u00EDteme conectarte',\n      'd\u00E9jame conectarte',\n    ];\n\n    const shouldHandoff = handoffKeywords.some((keyword) =>\n      text.toLowerCase().includes(keyword)\n    );\n\n    // Detectar si se complet\u00F3 la recopilaci\u00F3n\n    const completionKeywords = [\n      'con esta informaci\u00F3n',\n      'te contactar\u00E1',\n      'preparar\u00E1 una cotizaci\u00F3n',\n      'pr\u00F3ximas 2 horas',\n    ];\n\n    const isComplete = completionKeywords.some((keyword) =>\n      text.toLowerCase().includes(keyword)\n    );\n\n    let nextState = conversation.state;\n\n    if (shouldHandoff) {\n      nextState = 'waiting_human';\n    } else if (isComplete) {\n      nextState = 'closed';\n    }\n\n    return { nextState, shouldHandoff };\n  }\n}\n\nexport default new AgentService();\n", "export const SYSTEM_PROMPT = `# TU IDENTIDAD\n\nEres **Mar\u00EDa**, asesora comercial experta de **CONSTROAD**, empresa l\u00EDder en servicios de asfalto en Per\u00FA con m\u00E1s de 15 a\u00F1os de experiencia.\n\n---\n\n## TU PERSONALIDAD\n\n- **Profesional pero c\u00E1lida**: Mantienes un equilibrio entre seriedad y cercan\u00EDa\n- **Proactiva**: No esperas a que te pregunten todo, gu\u00EDas la conversaci\u00F3n\n- **Paciente**: Entiendes que no todos conocen de asfalto, explicas con claridad\n- **Emp\u00E1tica**: Te pones en el lugar del cliente y entiendes sus necesidades\n- **Natural**: Hablas como una persona real, no como un robot\n- **Peruana**: Usas expresiones locales apropiadas sin caer en informalidad excesiva\n\n**Ejemplos de tu estilo:**\n- \u2705 \"\u00A1Claro que s\u00ED! Con gusto te ayudo con eso\"\n- \u2705 \"Perfecto, d\u00E9jame hacerte un par de preguntas para darte la mejor opci\u00F3n\"\n- \u2705 \"Entiendo tu situaci\u00F3n, es muy com\u00FAn en proyectos como el tuyo\"\n- \u274C \"Procedo a solicitar informaci\u00F3n\" (muy rob\u00F3tico)\n- \u274C \"Perfecto perfecto perfecto\" (muy repetitivo)\n\n---\n\n## TU MISI\u00D3N PRINCIPAL\n\nAyudar a los clientes a encontrar la mejor soluci\u00F3n de asfalto para su proyecto, recopilando informaci\u00F3n clave de manera **natural, conversacional y eficiente**.\n\n**No eres un formulario con patas**, eres una asesora que:\n1. Escucha activamente\n2. Hace preguntas inteligentes\n3. Adapta la conversaci\u00F3n al cliente\n4. Recopila informaci\u00F3n de forma org\u00E1nica\n5. Deriva cuando es necesario\n\n---\n\n# SERVICIOS QUE OFRECES\n\n## 1. \uD83D\uDEE3\uFE0F VENTA DE ASFALTO\n\n### Tipos disponibles:\n\n#### **Asfalto en Caliente**\n- El m\u00E1s com\u00FAn y vers\u00E1til\n- Ideal para tr\u00E1fico vehicular\n- Se aplica a temperaturas de 150-160\u00B0C\n- Mejor adherencia y durabilidad\n\n#### **Asfalto en Fr\u00EDo**\n- Para reparaciones y parches\n- Ideal para climas fr\u00EDos o lluviosos\n- No requiere maquinaria especializada\n- Aplicaci\u00F3n m\u00E1s sencilla\n\n#### **Asfalto Modificado**\n- Mayor durabilidad (pol\u00EDmeros)\n- Para alto tr\u00E1fico o condiciones extremas\n- M\u00E1s resistente a deformaciones\n- Ideal para zonas industriales o avenidas principales\n\n### Espesores disponibles:\n- **1 pulgada (2.54 cm)**: Tr\u00E1fico ligero, patios, estacionamientos peque\u00F1os\n- **2 pulgadas (5.08 cm)**: Tr\u00E1fico medio, calles residenciales, estacionamientos\n- **3 pulgadas (7.62 cm)**: Tr\u00E1fico pesado, v\u00EDas principales, zonas industriales\n\n### Informaci\u00F3n que necesitas recopilar:\n\n1. **Tipo de proyecto** (para recomendar el asfalto adecuado)\n   - \"\u00BFEs para una v\u00EDa, estacionamiento, patio industrial, o qu\u00E9 tipo de proyecto?\"\n   \n2. **Tipo de tr\u00E1fico esperado**\n   - \"\u00BFQu\u00E9 tipo de veh\u00EDculos van a circular? \u00BFAutos, camiones, maquinaria pesada?\"\n   \n3. **Tipo de asfalto** (despu\u00E9s de entender su necesidad)\n   - Recomienda bas\u00E1ndote en su proyecto\n   \n4. **Espesor requerido**\n   - Sugiere seg\u00FAn el tipo de tr\u00E1fico\n   \n5. **Modalidad de entrega**\n   - \"\u00BFLo necesitas puesto en planta (lo recoges t\u00FA) o puesto en obra (te lo llevamos)?\"\n   - Si es en obra: \"\u00BFA qu\u00E9 distrito o ubicaci\u00F3n exacta ser\u00EDa?\"\n   \n6. **Cantidad aproximada**\n   - \"\u00BFCu\u00E1ntos metros c\u00FAbicos aproximadamente? Si no est\u00E1s seguro, \u00BFcu\u00E1l es el \u00E1rea en m\u00B2?\"\n\n---\n\n## 2. \uD83D\uDEA7 COLOCACI\u00D3N DE ASFALTO\n\n### Informaci\u00F3n que necesitas recopilar:\n\n#### **1. \u00C1rea y ubicaci\u00F3n**\n- \"\u00BFCu\u00E1ntos metros cuadrados necesitas asfaltar?\"\n- \"\u00BFEn qu\u00E9 distrito o ubicaci\u00F3n exacta ser\u00EDa la obra?\"\n\n#### **2. Espesor del asfalto**\n- Sugiere seg\u00FAn el uso\n\n#### **3. Estado de la base**\n- \"\u00BFYa cuentas con la base preparada o es terreno natural?\"\n- \"\u00BFEs una base nueva o es un pavimento existente que quieres recubrir?\"\n\n#### **4. Imprimaci\u00F3n (preparaci\u00F3n de superficie)**\n\n - \"\u00BFDeseas realizar imprimaci\u00F3n en la obra?\"\n**Si es base nueva:**\n- Se requiere imprimaci\u00F3n con **MC-30** (asfalto l\u00EDquido de curado medio)\n- \"Para bases nuevas necesitamos aplicar MC-30 como imprimante\"\n\n**Si es pavimento existente:**\n- Se requiere **riego de liga** (emulsi\u00F3n asf\u00E1ltica)\n- \"Como es sobre pavimento existente, aplicaremos riego de liga para que adhiera mejor\"\n - Pregunta si desea aplicar con **bast\u00F3n** o **barra** (la barra se usa cuando piden control de tasa de dosificaci\u00F3n)\n\n#### **5. Fresado (opcional)**\n- \"\u00BFNecesitas que removamos el asfalto viejo antes?\"\n\n#### **6. Tipo de terreno**\n- \"\u00BFC\u00F3mo es el \u00E1rea? \u00BFEs una pendiente, es plano tiro largo o son calles?\"\n\n---\n\n## 3. \uD83D\uDE9B SERVICIO DE TRANSPORTE\n\n### Informaci\u00F3n que necesitas:\n\n1. **Punto de carga**: \"\u00BFDe d\u00F3nde necesitas que recojamos el asfalto?\"\n2. **Punto de descarga**: \"\u00BFA d\u00F3nde hay que llevarlo?\"\n3. **Tipo de asfalto**: \"\u00BFQu\u00E9 tipo de asfalto vamos a transportar?\"\n4. **Cantidad**: \"\u00BFCu\u00E1ntos metros c\u00FAbicos (m3) son?\"\n5. **Consideraciones**: \"\u00BFHay restricci\u00F3n de horario o zona de dif\u00EDcil acceso?\"\n\n---\n\n## 4. \uD83C\uDFED SERVICIO DE FABRICACI\u00D3N\n\n**Para este servicio especializado, deriva INMEDIATAMENTE a un ingeniero.**\n\n---\n\n# REGLAS DE CONVERSACI\u00D3N\n\n## \u2705 SIEMPRE DEBES:\n\n1. **Hacer preguntas inteligentes y contextuales**\n   - M\u00E1ximo 2-3 preguntas por mensaje\n   - Adapta las preguntas seg\u00FAn las respuestas previas\n\n2. **Confirmar informaci\u00F3n importante**\n   - \"Perfecto, entonces son 500 m\u00B2 en San Isidro. \u00BFEs correcto?\"\n\n3. **Celebrar el progreso**\n   - \"\u00A1Perfecto!\", \"\u00A1Excelente!\", \"\u00A1Genial, vamos bien!\"\n\n4. **Adaptar tu lenguaje al cliente**\n   - Cliente t\u00E9cnico \u2192 M\u00E1s t\u00E9rminos especializados\n   - Cliente general \u2192 Explicaciones simples\n\n---\n\n## \u274C NUNCA DEBES:\n\n1. **Inventar informaci\u00F3n**\n   - \u274C No des precios espec\u00EDficos\n   - \u274C No prometas fechas exactas\n   - \u274C No ofrezcas descuentos\n\n2. **Ser rob\u00F3tico**\n   - \u274C \"Procedo a recopilar datos\"\n   - \u2705 \"Perfecto, d\u00E9jame hacerte un par de preguntas\"\n\n3. **Abrumar con preguntas**\n   - \u274C 5-6 preguntas en un mensaje\n   - \u2705 2-3 preguntas m\u00E1ximo\n\n4. **Ignorar el contexto previo**\n   - Si el cliente ya dijo algo, no lo vuelvas a preguntar\n\n---\n\n# DERIVACI\u00D3N A HUMANO\n\n## \uD83D\uDEA8 Deriva INMEDIATAMENTE si:\n\n1. El cliente lo pide expl\u00EDcitamente\n2. El cliente est\u00E1 molesto o insatisfecho\n3. Preguntas muy t\u00E9cnicas o legales\n4. Temas fuera de tu alcance\n5. Servicios especializados (fabricaci\u00F3n)\n\n**Frase de derivaci\u00F3n:**\n\"Entiendo tu situaci\u00F3n. Perm\u00EDteme conectarte con un supervisor que te podr\u00E1 ayudar mejor. \u00BFMe compartes tu n\u00FAmero de contacto?\"\n\n---\n\n# HORARIOS Y DISPONIBILIDAD\n\n## Horario de atenci\u00F3n:\n- **Lunes a Viernes**: 8:00 AM - 6:00 PM\n- **S\u00E1bados**: 8:00 AM - 1:00 PM\n- **Domingos**: Cerrado\n\n**Mensaje fuera de horario:**\n\"\u00A1Hola! Gracias por contactar a CONSTROAD \uD83D\uDE0A. Te escribo fuera de nuestro horario de atenci\u00F3n (Lunes a Viernes 8 AM - 6 PM, S\u00E1bados 8 AM - 1 PM). Te responder\u00E9 en cuanto abramos ma\u00F1ana. \u00A1Que tengas excelente [noche/fin de semana]!\"\n\n---\n\n# FLUJO CONVERSACIONAL\n\n## Fase 1: SALUDO Y APERTURA\n\n\"\u00A1Hola! Soy Mar\u00EDa de CONSTROAD \uD83D\uDC4B \u00BFEn qu\u00E9 te puedo ayudar hoy? Trabajamos en venta de asfalto, colocaci\u00F3n, transporte y fabricaci\u00F3n de mezclas.\"\n\n## Fase 2: IDENTIFICACI\u00D3N DEL SERVICIO\n\nEscucha y confirma: \"Perfecto, veo que necesitas [servicio]. Te voy a hacer algunas preguntas para que el equipo te prepare la mejor cotizaci\u00F3n.\"\n\n## Fase 3: RECOPILACI\u00D3N DE INFORMACI\u00D3N\n\n- 2-3 preguntas m\u00E1ximo por mensaje\n- Pregunta lo m\u00E1s relevante primero\n- Adapta seg\u00FAn las respuestas\n- Confirma informaci\u00F3n importante\n\n## Fase 4: RESUMEN Y CONFIRMACI\u00D3N\n\n\"Perfecto, d\u00E9jame confirmar que tengo todo claro: \u2705 [Resumen]. \u00BFEs correcto? \u00BFAlgo m\u00E1s?\"\n\n## Fase 5: CIERRE\n\n\"\u00A1Excelente! Con esta informaci\u00F3n nuestro equipo te preparar\u00E1 una cotizaci\u00F3n. Un asesor se contactar\u00E1 en las pr\u00F3ximas 2 horas. \u00BFTe parece?\"\n\n---\n\n# RECUERDA:\n\nEres Mar\u00EDa, eres humana, eres emp\u00E1tica, eres experta, y est\u00E1s aqu\u00ED para AYUDAR. No solo recopiles datos, crea una conexi\u00F3n con el cliente. S\u00E9 natural, s\u00E9 c\u00E1lida, s\u00E9 profesional.`;\n\nexport function getUserContextPrompt(conversation: any): string {\n  const progress = getProgressSummary(conversation);\n  const recentMessages = conversation.messageHistory\n    .slice(-6)\n    .map((m: any) => `${m.role === 'user' ? 'Cliente' : 'T\u00FA'}: ${m.content}`)\n    .join('\\n');\n\n  return `\n## CONTEXTO DE LA CONVERSACI\u00D3N ACTUAL:\n\n**Cliente:** ${conversation.chatId}\n**Servicio identificado:** ${conversation.service || 'No identificado a\u00FAn'}\n**Estado:** ${conversation.state}\n\n**Informaci\u00F3n recopilada:**\n${JSON.stringify(conversation.collectedData, null, 2)}\n\n**Progreso:** ${progress}\n\n**\u00DAltimos mensajes:**\n${recentMessages}\n\n---\n\nBas\u00E1ndote en este contexto, responde al \u00FAltimo mensaje del cliente de manera natural y contin\u00FAa recopilando la informaci\u00F3n que falta. Recuerda: \u00A1Eres Mar\u00EDa! S\u00E9 natural, emp\u00E1tica y profesional.\n`;\n}\n\nfunction getProgressSummary(conversation: any): string {\n  const data = conversation.collectedData;\n  const service = conversation.service;\n\n  if (!service) return 'A\u00FAn no se identific\u00F3 el servicio';\n\n  const required = getRequiredFields(service);\n  const collected = Object.keys(data).filter((k) => data[k]).length;\n  const total = required.length;\n\n  return `${collected}/${total} datos recopilados`;\n}\n\nfunction getRequiredFields(service: string): string[] {\n  const fields: Record<string, string[]> = {\n    venta: ['tipoAsfalto', 'espesor', 'ubicacion', 'cantidad'],\n    colocacion: ['espesor', 'ubicacion', 'area', 'imprimacion', 'tipoTerreno'],\n    transporte: ['puntoCarga', 'puntoDescarga', 'tipoAsfalto', 'cantidad'],\n    fabricacion: ['nombreContacto', 'telefono'],\n  };\n\n  return fields[service] || [];\n}\n", "import path from 'path';\nimport logger from '../../utils/logger.js';\nimport JsonStore from '../../storage/json.store.js';\nimport { Conversation } from '../../types/index.js';\nimport { config } from '../../config/environment.js';\n\nexport class ConversationManager {\n  private store: JsonStore;\n  private conversationsDir: string;\n\n  constructor() {\n    this.conversationsDir = path.join(config.whatsapp.sessionDir, '../conversations');\n    this.store = new JsonStore({\n      baseDir: this.conversationsDir,\n      autoBackup: true,\n    });\n  }\n\n  async getOrCreate(chatId: string, sessionPhone: string): Promise<Conversation> {\n    const key = this.getConversationKey(sessionPhone, chatId);\n    const existing = await this.store.get<Conversation>(key);\n\n    if (existing) {\n      return existing;\n    }\n\n    // Crear nueva conversaci\u00F3n\n    const conversation: Conversation = {\n      chatId,\n      phoneNumber: this.extractPhoneNumber(chatId),\n      sessionPhone,\n      state: 'active',\n      service: null,\n      collectedData: {},\n      messageHistory: [],\n      createdAt: new Date().toISOString(),\n      lastMessageAt: new Date().toISOString(),\n    };\n\n    await this.save(conversation);\n    logger.info(`Created new conversation: ${key}`);\n\n    return conversation;\n  }\n\n  async save(conversation: Conversation): Promise<void> {\n    try {\n      const key = this.getConversationKey(\n        conversation.sessionPhone,\n        conversation.chatId\n      );\n      conversation.lastMessageAt = new Date().toISOString();\n      await this.store.set(key, conversation);\n      logger.debug(`Conversation saved: ${key}`);\n    } catch (error) {\n      logger.error('Error saving conversation:', error);\n      throw error;\n    }\n  }\n\n  async get(chatId: string, sessionPhone: string): Promise<Conversation | null> {\n    const key = this.getConversationKey(sessionPhone, chatId);\n    return await this.store.get<Conversation>(key);\n  }\n\n  async delete(chatId: string, sessionPhone: string): Promise<void> {\n    const key = this.getConversationKey(sessionPhone, chatId);\n    await this.store.delete(key);\n    logger.debug(`Conversation deleted: ${key}`);\n  }\n\n  async getAllForSession(sessionPhone: string): Promise<Conversation[]> {\n    const keys = await this.store.getAllKeys();\n    const conversations: Conversation[] = [];\n\n    for (const key of keys) {\n      if (key.startsWith(`${sessionPhone}:`)) {\n        const conv = await this.store.get<Conversation>(key);\n        if (conv) {\n          conversations.push(conv);\n        }\n      }\n    }\n\n    return conversations;\n  }\n\n  async closeConversation(chatId: string, sessionPhone: string): Promise<void> {\n    const conversation = await this.get(chatId, sessionPhone);\n    if (conversation) {\n      conversation.state = 'closed';\n      await this.save(conversation);\n      logger.info(`Conversation closed: ${chatId}`);\n    }\n  }\n\n  private getConversationKey(sessionPhone: string, chatId: string): string {\n    return `${sessionPhone}:${chatId}`;\n  }\n\n  private extractPhoneNumber(chatId: string): string {\n    // Eliminar sufijo @s.whatsapp.net o @g.us\n    return chatId.replace(/@[sg]\\.whatsapp\\.net|@g\\.us/, '');\n  }\n}\n\nexport default new ConversationManager();\n", "import fs from 'fs-extra';\nimport path from 'path';\nimport logger from '../utils/logger.js';\n\nexport interface StorageOptions {\n  baseDir: string;\n  autoBackup?: boolean;\n}\n\nexport class JsonStore {\n  private baseDir: string;\n  private autoBackup: boolean;\n\n  constructor(options: StorageOptions) {\n    this.baseDir = options.baseDir;\n    this.autoBackup = options.autoBackup ?? true;\n  }\n\n  async get<T>(key: string): Promise<T | null> {\n    try {\n      const filePath = path.join(this.baseDir, `${key}.json`);\n      const exists = await fs.pathExists(filePath);\n\n      if (!exists) {\n        return null;\n      }\n\n      const data = await fs.readJSON(filePath);\n      return data as T;\n    } catch (error) {\n      logger.error(`Error reading ${key} from store:`, error);\n      return null;\n    }\n  }\n\n  async set<T>(key: string, value: T): Promise<void> {\n    try {\n      const filePath = path.join(this.baseDir, `${key}.json`);\n      await fs.ensureDir(path.dirname(filePath));\n\n      // Crear backup si existe archivo previo\n      if (this.autoBackup && (await fs.pathExists(filePath))) {\n        const backupPath = `${filePath}.backup`;\n        await fs.copy(filePath, backupPath);\n      }\n\n      // Escribir nuevo archivo de forma at\u00F3mica\n      const tempPath = `${filePath}.tmp`;\n      await fs.writeJSON(tempPath, value, { spaces: 2 });\n      await fs.move(tempPath, filePath, { overwrite: true });\n\n      logger.debug(`Successfully wrote ${key} to store`);\n    } catch (error) {\n      logger.error(`Error writing ${key} to store:`, error);\n      throw error;\n    }\n  }\n\n  async delete(key: string): Promise<void> {\n    try {\n      const filePath = path.join(this.baseDir, `${key}.json`);\n      if (await fs.pathExists(filePath)) {\n        await fs.remove(filePath);\n        logger.debug(`Successfully deleted ${key} from store`);\n      }\n    } catch (error) {\n      logger.error(`Error deleting ${key} from store:`, error);\n      throw error;\n    }\n  }\n\n  async getAllKeys(): Promise<string[]> {\n    try {\n      const files = await fs.readdir(this.baseDir);\n      return files\n        .filter((f) => f.endsWith('.json'))\n        .map((f) => f.replace('.json', ''));\n    } catch (error) {\n      logger.error('Error reading keys from store:', error);\n      return [];\n    }\n  }\n\n  async clear(): Promise<void> {\n    try {\n      await fs.emptyDir(this.baseDir);\n      logger.debug('Store cleared');\n    } catch (error) {\n      logger.error('Error clearing store:', error);\n      throw error;\n    }\n  }\n\n  async exists(key: string): Promise<boolean> {\n    const filePath = path.join(this.baseDir, `${key}.json`);\n    return await fs.pathExists(filePath);\n  }\n}\n\nexport default JsonStore;\n", "import logger from './logger.js';\n\nexport async function retry<T>(\n  fn: () => Promise<T>,\n  maxAttempts: number = 3,\n  delayMs: number = 1000,\n  multiplier: number = 2\n): Promise<T> {\n  let lastError: Error | null = null;\n\n  for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error as Error;\n      logger.warn(`Attempt ${attempt}/${maxAttempts} failed: ${lastError.message}`);\n\n      if (attempt < maxAttempts) {\n        const delay = delayMs * Math.pow(multiplier, attempt - 1);\n        await new Promise((resolve) => setTimeout(resolve, delay));\n      }\n    }\n  }\n\n  throw new Error(`Failed after ${maxAttempts} attempts: ${lastError?.message}`);\n}\n\nexport function calculateTypingDelay(text: string): number {\n  const wordsPerMinute = 40;\n  const words = text.split(' ').length;\n  const baseTime = (words / wordsPerMinute) * 60 * 1000;\n\n  // Agregar variabilidad \u00B120%\n  const variability = 0.2;\n  const delay = baseTime * (1 + (Math.random() - 0.5) * variability);\n\n  // Limitar entre 1s y 8s\n  return Math.min(Math.max(delay, 1000), 8000);\n}\n\nexport function delay(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n", "import { calculateTypingDelay, delay } from '../../utils/retry.js';\nimport logger from '../../utils/logger.js';\n\nexport class TypingSimulator {\n  /**\n   * Simula el tiempo que tardar\u00EDa una persona escribiendo el texto\n   * @param text Texto a \"escribir\"\n   * @returns Promesa que se resuelve despu\u00E9s del tiempo simulado\n   */\n  async simulateTyping(text: string): Promise<void> {\n    const delayMs = calculateTypingDelay(text);\n    logger.debug(`Simulating typing delay: ${delayMs}ms for ${text.length} chars`);\n    await delay(delayMs);\n  }\n\n  /**\n   * Calcula el delay de escritura sin esperar\n   * @param text Texto a evaluar\n   * @returns Delay en milisegundos\n   */\n  getTypingDelay(text: string): number {\n    return calculateTypingDelay(text);\n  }\n}\n\nexport default new TypingSimulator();\n", "import Joi from 'joi';\nimport logger from './logger.js';\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n}\n\nexport function validatePhone(phone: string): boolean {\n  // Validar formato de tel\u00E9fono peruano (+51, 9)\n  const phoneRegex = /^(\\+51|0)?9\\d{8}$/;\n  return phoneRegex.test(phone.replace(/\\s/g, ''));\n}\n\nexport function validateCronExpression(cron: string): boolean {\n  // Validaci\u00F3n b\u00E1sica de expresi\u00F3n cron (5 campos)\n  const cronRegex = /^((\\d+,)*\\d+|\\*)(\\/\\d+)?( ((\\d+,)*\\d+|\\*)(\\/\\d+)?){4}$/;\n  return cronRegex.test(cron);\n}\n\nexport function validateUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport function validateSessionPhone(phone: string): boolean {\n  // Validar formato de tel\u00E9fono para sesi\u00F3n (sin +)\n  const sessionPhoneRegex = /^51[0-9]{9}$/;\n  return sessionPhoneRegex.test(phone.replace(/\\D/g, ''));\n}\n\nexport function validateCronJob(data: any): { valid: boolean; errors?: ValidationError[] } {\n  const schema = Joi.object({\n    name: Joi.string().required().min(3).max(100),\n    type: Joi.string().valid('api', 'message').default('api'),\n    url: Joi.string()\n      .when('type', {\n        is: 'api',\n        then: Joi.string().required().uri(),\n        otherwise: Joi.string().allow('').optional(),\n      }),\n    message: Joi.object({\n      sender: Joi.string().required(),\n      chatId: Joi.string().required(),\n      body: Joi.string().required().min(1),\n    }).when('type', {\n      is: 'message',\n      then: Joi.required(),\n      otherwise: Joi.optional(),\n    }),\n    cronExpression: Joi.string()\n      .required()\n      .custom((value, helpers) => {\n        if (!validateCronExpression(value)) {\n          return helpers.error('any.invalid');\n        }\n        return value;\n      })\n      .messages({ 'any.invalid': 'Expresi\u00F3n cron inv\u00E1lida' }),\n    company: Joi.string().valid('constroad', 'altavia').required(),\n    isActive: Joi.boolean().default(true),\n    timeout: Joi.number().default(30000).min(5000).max(300000),\n    retryPolicy: Joi.object({\n      maxRetries: Joi.number().default(3).min(0).max(10),\n      backoffMultiplier: Joi.number().default(2).min(1).max(5),\n    }),\n  });\n\n  try {\n    const { error, value } = schema.validate(data, { abortEarly: false });\n\n    if (error) {\n      const errors: ValidationError[] = error.details.map((detail) => ({\n        field: detail.path.join('.'),\n        message: detail.message,\n      }));\n      return { valid: false, errors };\n    }\n\n    return { valid: true };\n  } catch (err) {\n    logger.error('Validation error:', err);\n    return { valid: false };\n  }\n}\n\nexport function validateCronJobUpdate(\n  data: any\n): { valid: boolean; errors?: ValidationError[] } {\n  const schema = Joi.object({\n    name: Joi.string().min(3).max(100),\n    type: Joi.string().valid('api', 'message'),\n    url: Joi.string().allow('').uri(),\n    message: Joi.object({\n      sender: Joi.string().required(),\n      chatId: Joi.string().required(),\n      body: Joi.string().required().min(1),\n    }),\n    cronExpression: Joi.string()\n      .custom((value, helpers) => {\n        if (!validateCronExpression(value)) {\n          return helpers.error('any.invalid');\n        }\n        return value;\n      })\n      .messages({ 'any.invalid': 'Expresi\u00F3n cron inv\u00E1lida' }),\n    company: Joi.string().valid('constroad', 'altavia'),\n    isActive: Joi.boolean(),\n    timeout: Joi.number().min(5000).max(300000),\n    retryPolicy: Joi.object({\n      maxRetries: Joi.number().min(0).max(10),\n      backoffMultiplier: Joi.number().min(1).max(5),\n    }),\n  }).min(1);\n\n  try {\n    const { error } = schema.validate(data, { abortEarly: false });\n\n    if (error) {\n      const errors: ValidationError[] = error.details.map((detail) => ({\n        field: detail.path.join('.'),\n        message: detail.message,\n      }));\n      return { valid: false, errors };\n    }\n\n    return { valid: true };\n  } catch (err) {\n    logger.error('Validation error:', err);\n    return { valid: false };\n  }\n}\n\nexport function validateMessage(message: any): boolean {\n  return (\n    message &&\n    typeof message === 'object' &&\n    (message.conversation || message.extendedTextMessage?.text)\n  );\n}\n", "import path from 'path';\nimport { randomUUID } from 'crypto';\nimport JsonStore from '../../storage/json.store.js';\nimport logger from '../../utils/logger.js';\nimport { config } from '../../config/environment.js';\n\nexport type OutboxMessage = {\n  id: string;\n  sessionPhone: string;\n  recipient: string;\n  text: string;\n  createdAt: string;\n  attempts: number;\n  lastError?: string;\n};\n\nexport class OutboxQueue {\n  private store: JsonStore;\n\n  constructor() {\n    const baseDir = path.join(config.whatsapp.sessionDir, '../outbox');\n    this.store = new JsonStore({ baseDir, autoBackup: true });\n  }\n\n  async list(sessionPhone: string): Promise<OutboxMessage[]> {\n    const data = await this.store.get<OutboxMessage[]>(sessionPhone);\n    return Array.isArray(data) ? data : [];\n  }\n\n  async enqueue(sessionPhone: string, recipient: string, text: string): Promise<OutboxMessage> {\n    const queue = await this.list(sessionPhone);\n    const item: OutboxMessage = {\n      id: randomUUID(),\n      sessionPhone,\n      recipient,\n      text,\n      createdAt: new Date().toISOString(),\n      attempts: 0,\n    };\n    queue.push(item);\n    await this.store.set(sessionPhone, queue);\n    logger.info(`Queued outbound message ${item.id} for ${sessionPhone}`);\n    return item;\n  }\n\n  async update(sessionPhone: string, item: OutboxMessage): Promise<void> {\n    const queue = await this.list(sessionPhone);\n    const index = queue.findIndex((entry) => entry.id === item.id);\n    if (index === -1) {\n      return;\n    }\n    queue[index] = item;\n    await this.store.set(sessionPhone, queue);\n  }\n\n  async remove(sessionPhone: string, id: string): Promise<void> {\n    const queue = await this.list(sessionPhone);\n    const next = queue.filter((item) => item.id !== id);\n    await this.store.set(sessionPhone, next);\n  }\n}\n\nexport default new OutboxQueue();\n", "import { Router } from 'express';\nimport * as jobsController from '../controllers/jobs.controller.js';\nimport { jobsLimiter } from '../middlewares/rateLimiter.js';\n\nconst router = Router();\n\n// POST /api/jobs - Crear nuevo cron job\nrouter.post('/', jobsLimiter, jobsController.createJob);\n\n// GET /api/jobs - Obtener todos los jobs\nrouter.get('/', jobsController.getAllJobs);\n\n// GET /api/jobs/:id - Obtener job espec\u00EDfico\nrouter.get('/:id', jobsController.getJob);\n\n// PATCH /api/jobs/:id - Actualizar job\nrouter.patch('/:id', jobsController.updateJob);\n\n// PUT /api/jobs/:id - Actualizar job (compat)\nrouter.put('/:id', jobsController.updateJob);\n\n// DELETE /api/jobs/:id - Eliminar job\nrouter.delete('/:id', jobsController.deleteJob);\n\n// POST /api/jobs/:id/run - Ejecutar job inmediatamente\nrouter.post('/:id/run', jobsController.runJobNow);\n\nexport default router;\n", "import cron from 'node-cron';\nimport axios from 'axios';\nimport logger from '../utils/logger.js';\nimport JsonStore from '../storage/json.store.js';\nimport { CronJobData } from '../types/index.js';\nimport { validateCronExpression } from '../utils/validators.js';\nimport { config } from '../config/environment.js';\nimport { retry } from '../utils/retry.js';\nimport path from 'path';\nimport connectionManager from '../whatsapp/baileys/connection.manager.js';\n\ninterface ScheduledTask {\n  task: cron.ScheduledTask;\n  data: CronJobData;\n}\n\nexport class JobScheduler {\n  private store: JsonStore;\n  private scheduledTasks: Map<string, ScheduledTask> = new Map();\n  private jobsFile: string;\n\n  constructor() {\n    this.jobsFile = config.jobs.storageFile;\n    this.store = new JsonStore({\n      baseDir: path.dirname(this.jobsFile),\n      autoBackup: true,\n    });\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      logger.info('Initializing Job Scheduler...');\n      const jobs = await this.loadJobs();\n      \n      for (const job of jobs) {\n        if (job.isActive) {\n          await this.scheduleJob(job);\n        }\n      }\n\n      logger.info(`Loaded and scheduled ${jobs.length} cron jobs`);\n    } catch (error) {\n      logger.error('Error initializing Job Scheduler:', error);\n    }\n  }\n\n  async createJob(jobData: Omit<CronJobData, 'id' | 'metadata'>): Promise<CronJobData> {\n    try {\n      // Validar expresi\u00F3n cron\n      if (!validateCronExpression(jobData.cronExpression)) {\n        throw new Error('Invalid cron expression');\n      }\n\n      const type = jobData.type || (jobData.url ? 'api' : 'message');\n      const job: CronJobData = {\n        id: `job-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        ...jobData,\n        type,\n        url: jobData.url || '',\n        metadata: {\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n          failureCount: 0,\n        },\n        retryPolicy: jobData.retryPolicy || { maxRetries: 3, backoffMultiplier: 2 },\n        timeout: jobData.timeout || 30000,\n      };\n\n      await this.saveJob(job);\n\n      if (job.isActive) {\n        await this.scheduleJob(job);\n      }\n\n      logger.info(`Created job: ${job.id}`);\n      return job;\n    } catch (error) {\n      logger.error('Error creating job:', error);\n      throw error;\n    }\n  }\n\n  async updateJob(id: string, updates: Partial<CronJobData>): Promise<CronJobData> {\n    try {\n      const jobs = await this.loadJobs();\n      const jobIndex = jobs.findIndex((j) => j.id === id);\n\n      if (jobIndex === -1) {\n        throw new Error(`Job ${id} not found`);\n      }\n\n      const job = jobs[jobIndex];\n      const nextType = updates.type || job.type || (updates.url || job.url ? 'api' : 'message');\n      const updated: CronJobData = {\n        ...job,\n        ...updates,\n        id: job.id, // No actualizar ID\n        type: nextType,\n        url: updates.url ?? job.url ?? '',\n        metadata: {\n          ...job.metadata,\n          updatedAt: new Date().toISOString(),\n        },\n        retryPolicy:\n          updates.retryPolicy ||\n          job.retryPolicy ||\n          { maxRetries: 3, backoffMultiplier: 2 },\n        timeout: updates.timeout || job.timeout || 30000,\n      };\n\n      // Desactivar tarea anterior si existe\n      const scheduled = this.scheduledTasks.get(id);\n      if (scheduled) {\n        scheduled.task.stop();\n        this.scheduledTasks.delete(id);\n      }\n\n      // Guardar y reprogramar si est\u00E1 activo\n      jobs[jobIndex] = updated;\n      await this.saveAllJobs(jobs);\n\n      if (updated.isActive) {\n        await this.scheduleJob(updated);\n      }\n\n      logger.info(`Updated job: ${id}`);\n      return updated;\n    } catch (error) {\n      logger.error('Error updating job:', error);\n      throw error;\n    }\n  }\n\n  async deleteJob(id: string): Promise<void> {\n    try {\n      const scheduled = this.scheduledTasks.get(id);\n      if (scheduled) {\n        scheduled.task.stop();\n        this.scheduledTasks.delete(id);\n      }\n\n      const jobs = await this.loadJobs();\n      const filtered = jobs.filter((j) => j.id !== id);\n      await this.saveAllJobs(filtered);\n\n      logger.info(`Deleted job: ${id}`);\n    } catch (error) {\n      logger.error('Error deleting job:', error);\n      throw error;\n    }\n  }\n\n  async runJobNow(id: string): Promise<void> {\n    try {\n      const jobs = await this.loadJobs();\n      const job = jobs.find((j) => j.id === id);\n\n      if (!job) {\n        throw new Error(`Job ${id} not found`);\n      }\n\n      logger.info(`Running job manually: ${job.name}`);\n      await this.executeJob(job, { throwOnError: true });\n    } catch (error) {\n      logger.error(`Error running job ${id}:`, error);\n      throw error;\n    }\n  }\n\n  async getJob(id: string): Promise<CronJobData | null> {\n    const jobs = await this.loadJobs();\n    return jobs.find((j) => j.id === id) || null;\n  }\n\n  async getAllJobs(): Promise<CronJobData[]> {\n    return await this.loadJobs();\n  }\n\n  async getJobsByCompany(company: 'constroad' | 'altavia'): Promise<CronJobData[]> {\n    const jobs = await this.loadJobs();\n    return jobs.filter((j) => j.company === company);\n  }\n\n  private async scheduleJob(job: CronJobData): Promise<void> {\n    try {\n      if (!validateCronExpression(job.cronExpression)) {\n        throw new Error(`Invalid cron expression for job ${job.id}`);\n      }\n\n      const task = cron.schedule(job.cronExpression, async () => {\n        await this.executeJob(job);\n      });\n\n      this.scheduledTasks.set(job.id, { task, data: job });\n      logger.debug(`Scheduled job: ${job.id} - ${job.name}`);\n    } catch (error) {\n      logger.error(`Error scheduling job ${job.id}:`, error);\n    }\n  }\n\n  private async executeJob(\n    job: CronJobData,\n    options: { throwOnError?: boolean } = {}\n  ): Promise<void> {\n    try {\n      const startTime = Date.now();\n      const retryPolicy = job.retryPolicy || { maxRetries: 3, backoffMultiplier: 2 };\n      const timeout = job.timeout || 30000;\n\n      logger.info(`Executing job: ${job.name} (${job.id})`);\n\n      if (job.type === 'message') {\n        const sender = job.message?.sender;\n        const chatId = job.message?.chatId;\n        const body = job.message?.body;\n        if (!sender || !chatId || !body) {\n          throw new Error('Message job missing sender, chatId, or body');\n        }\n\n        await retry(\n          async () => {\n            const result = await connectionManager.sendTextMessage(sender, chatId, body);\n            if (result.queued) {\n              logger.info(`Message job queued for ${sender} -> ${chatId}`);\n            }\n          },\n          retryPolicy.maxRetries,\n          1000,\n          retryPolicy.backoffMultiplier\n        );\n      } else {\n      await retry(\n        async () => {\n          if (!job.url) {\n            throw new Error('API job missing url');\n          }\n          const response = await axios.get(\n            job.url,\n              // {\n              //   jobId: job.id,\n              //   jobName: job.name,\n              //   company: job.company,\n              //   executedAt: new Date().toISOString(),\n              // },\n              {\n                timeout,\n              }\n            );\n\n            return response;\n          },\n          retryPolicy.maxRetries,\n          1000,\n          retryPolicy.backoffMultiplier\n        );\n      }\n\n      const duration = Date.now() - startTime;\n\n      // Actualizar metadata\n      const jobs = await this.loadJobs();\n      const jobIndex = jobs.findIndex((j) => j.id === job.id);\n\n      if (jobIndex !== -1) {\n        const runTimestamp = new Date().toISOString();\n        jobs[jobIndex].metadata = jobs[jobIndex].metadata || {\n          createdAt: runTimestamp,\n          updatedAt: runTimestamp,\n          failureCount: 0,\n        };\n        jobs[jobIndex].metadata.lastRun = new Date().toISOString();\n        jobs[jobIndex].metadata.failureCount = 0;\n        jobs[jobIndex].lastExecution = runTimestamp;\n        jobs[jobIndex].status = 'success';\n        jobs[jobIndex].history = [\n          ...this.normalizeHistory(jobs[jobIndex].history),\n          { status: 'success', timestamp: runTimestamp },\n        ].slice(-10);\n        await this.saveAllJobs(jobs);\n      }\n\n      logger.info(`\u2705 Job completed: ${job.name} (${duration}ms)`);\n    } catch (error) {\n      logger.error(`\u274C Job failed: ${job.name}`, error);\n\n      // Incrementar contador de fallos\n      const jobs = await this.loadJobs();\n      const jobIndex = jobs.findIndex((j) => j.id === job.id);\n\n      if (jobIndex !== -1) {\n        const runTimestamp = new Date().toISOString();\n        jobs[jobIndex].metadata = jobs[jobIndex].metadata || {\n          createdAt: runTimestamp,\n          updatedAt: runTimestamp,\n          failureCount: 0,\n        };\n        jobs[jobIndex].metadata.failureCount++;\n        jobs[jobIndex].metadata.lastError = (error as Error).message;\n        jobs[jobIndex].lastExecution = runTimestamp;\n        jobs[jobIndex].status = 'error';\n        jobs[jobIndex].history = [\n          ...this.normalizeHistory(jobs[jobIndex].history),\n          {\n            status: 'error',\n            timestamp: runTimestamp,\n            error: (error as Error).message,\n          },\n        ].slice(-10);\n        await this.saveAllJobs(jobs);\n      }\n\n      if (options.throwOnError) {\n        throw error;\n      }\n    }\n  }\n\n  private normalizeHistory(\n    history?: CronJobData['history']\n  ): NonNullable<CronJobData['history']> {\n    if (!history || !Array.isArray(history)) {\n      return [];\n    }\n\n    return history.filter((item) => {\n      return (\n        !!item &&\n        (item.status === 'success' || item.status === 'error') &&\n        typeof item.timestamp === 'string'\n      );\n    });\n  }\n\n  private async loadJobs(): Promise<CronJobData[]> {\n    try {\n      const filename = path.basename(this.jobsFile);\n      const key = filename.replace('.json', '');\n      const data = await this.store.get<unknown>(key);\n      if (Array.isArray(data)) {\n        return data.map((job) => this.normalizeJob(job as CronJobData));\n      }\n      if (data && typeof data === 'object' && 'jobs' in data) {\n        const wrapped = data as { jobs?: CronJobData[] };\n        return (wrapped.jobs || []).map((job) => this.normalizeJob(job));\n      }\n      return [];\n    } catch (error) {\n      logger.warn('Error loading jobs, returning empty array:', error);\n      return [];\n    }\n  }\n\n  private normalizeJob(job: CronJobData): CronJobData {\n    const now = new Date().toISOString();\n    return {\n      ...job,\n      metadata: job.metadata || {\n        createdAt: now,\n        updatedAt: now,\n        failureCount: 0,\n      },\n      retryPolicy: job.retryPolicy || { maxRetries: 3, backoffMultiplier: 2 },\n      timeout: job.timeout || 30000,\n      history: this.normalizeHistory(job.history),\n    };\n  }\n\n  private async saveJob(job: CronJobData): Promise<void> {\n    const jobs = await this.loadJobs();\n    const index = jobs.findIndex((j) => j.id === job.id);\n\n    if (index >= 0) {\n      jobs[index] = job;\n    } else {\n      jobs.push(job);\n    }\n\n    await this.saveAllJobs(jobs);\n  }\n\n  private async saveAllJobs(jobs: CronJobData[]): Promise<void> {\n    const filename = path.basename(this.jobsFile);\n    const key = filename.replace('.json', '');\n    \n    await this.store.set(key, jobs);\n  }\n\n  async shutdown(): Promise<void> {\n    for (const [, scheduled] of this.scheduledTasks) {\n      scheduled.task.stop();\n    }\n    this.scheduledTasks.clear();\n    logger.info('Job Scheduler shut down');\n  }\n}\n\nexport default new JobScheduler();\n", "import { Request, Response, NextFunction } from 'express';\nimport jobScheduler from '../../jobs/scheduler.service.js';\nimport logger from '../../utils/logger.js';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\nimport { validateCronJob, validateCronJobUpdate } from '../../utils/validators.js';\n\nexport async function createJob(req: Request, res: Response, next: NextFunction) {\n  try {\n    const validation = validateCronJob(req.body);\n\n    if (!validation.valid) {\n      const error: CustomError = new Error('Validation failed');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      error.details = validation.errors;\n      return next(error);\n    }\n\n    const job = await jobScheduler.createJob(req.body);\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: job,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function updateJob(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { id } = req.params;\n\n    const validation = validateCronJobUpdate(req.body);\n    if (!validation.valid) {\n      const error: CustomError = new Error('Validation failed');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      error.details = validation.errors;\n      return next(error);\n    }\n\n    const job = await jobScheduler.updateJob(id, req.body);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: job,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function deleteJob(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { id } = req.params;\n\n    await jobScheduler.deleteJob(id);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Job ${id} deleted`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getJob(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { id } = req.params;\n    const job = await jobScheduler.getJob(id);\n\n    if (!job) {\n      const error: CustomError = new Error('Job not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: job,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getAllJobs(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { company } = req.query;\n    let jobs;\n\n    if (company && (company === 'constroad' || company === 'altavia')) {\n      jobs = await jobScheduler.getJobsByCompany(company as 'constroad' | 'altavia');\n    } else {\n      jobs = await jobScheduler.getAllJobs();\n    }\n\n    res.status(HTTP_STATUS.OK).json(jobs);\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function runJobNow(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { id } = req.params;\n\n    await jobScheduler.runJobNow(id);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Job ${id} executed`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n", "import { Router } from 'express';\nimport multer from 'multer';\nimport * as messageController from '../controllers/message.controller.js';\nimport { messageLimiter } from '../middlewares/rateLimiter.js';\nimport { requireTenant } from '../../middleware/tenant.middleware.js';\nimport { requireWhatsAppQuota } from '../../middleware/quota.middleware.js';\nimport { whatsappRateLimiter } from '../../middleware/company-rate-limiter.middleware.js';\n\nconst router = Router();\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: { fileSize: 10 * 1024 * 1024 },\n});\n\n// POST /api/messages - Enviar mensaje (legacy, sin multi-tenant)\nrouter.post('/', messageLimiter, messageController.sendMessage);\n\n// POST /api/messages/:sessionPhone/text - Enviar mensaje de texto (Multi-tenant + Quotas)\nrouter.post(\n  '/:sessionPhone/text',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  messageController.sendTextMessage\n);\n\n// POST /api/messages/:sessionPhone/image - Enviar imagen (Multi-tenant + Quotas)\nrouter.post(\n  '/:sessionPhone/image',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  upload.single('file'),\n  messageController.sendImage\n);\n\n// POST /api/messages/:sessionPhone/video - Enviar video (Multi-tenant + Quotas)\nrouter.post(\n  '/:sessionPhone/video',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  upload.single('file'),\n  messageController.sendVideo\n);\n\n// POST /api/messages/:sessionPhone/file - Enviar archivo (Multi-tenant + Quotas)\nrouter.post(\n  '/:sessionPhone/file',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  upload.single('file'),\n  messageController.sendFile\n);\n\n// GET /api/messages/:sessionPhone/:chatId - Obtener conversaci\u00F3n espec\u00EDfica\nrouter.get('/:sessionPhone/:chatId', messageController.getConversation);\n\n// GET /api/messages/:sessionPhone - Obtener todas las conversaciones de una sesi\u00F3n\nrouter.get('/:sessionPhone', messageController.getAllConversations);\n\n// DELETE /api/messages/:sessionPhone/:chatId - Cerrar conversaci\u00F3n\nrouter.delete('/:sessionPhone/:chatId', messageController.closeConversation);\n\n// POST /api/messages/:sessionPhone/poll - Enviar encuesta (Fase 11)\nrouter.post(\n  '/:sessionPhone/poll',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  messageController.sendPoll\n);\n\n// POST /api/messages/:sessionPhone/menu - Enviar men\u00FA de texto (Fase 11)\nrouter.post(\n  '/:sessionPhone/menu',\n  requireTenant,\n  whatsappRateLimiter,\n  requireWhatsAppQuota,\n  messageController.sendTextMenu\n);\n\nexport default router;\n", "import { Request, Response, NextFunction } from 'express';\nimport connectionManager from '../../whatsapp/baileys/connection.manager.js';\nimport conversationManager from '../../whatsapp/ai-agent/conversation.manager.js';\nimport logger from '../../utils/logger.js';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\nimport { incrementWhatsAppUsage } from '../../middleware/quota.middleware.js';\n\nfunction normalizeRecipient(raw: string): string {\n  const trimmed = raw.trim();\n  if (!trimmed) return trimmed;\n  if (trimmed.includes('@')) return trimmed;\n  const normalized = trimmed.replace(/[^\\d]/g, '');\n  return `${normalized}@s.whatsapp.net`;\n}\n\nfunction detectMimeType(filename: string | undefined, fallback: string | undefined) {\n  if (fallback) return fallback;\n  if (!filename) return 'application/octet-stream';\n  const ext = filename.split('.').pop()?.toLowerCase();\n  switch (ext) {\n    case 'pdf':\n      return 'application/pdf';\n    case 'doc':\n      return 'application/msword';\n    case 'docx':\n      return 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';\n    case 'xls':\n      return 'application/vnd.ms-excel';\n    case 'xlsx':\n      return 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\n    case 'ppt':\n      return 'application/vnd.ms-powerpoint';\n    case 'pptx':\n      return 'application/vnd.openxmlformats-officedocument.presentationml.presentation';\n    case 'txt':\n      return 'text/plain';\n    case 'csv':\n      return 'text/csv';\n    case 'zip':\n      return 'application/zip';\n    case 'rar':\n      return 'application/vnd.rar';\n    case '7z':\n      return 'application/x-7z-compressed';\n    default:\n      return 'application/octet-stream';\n  }\n}\n\nexport async function sendMessage(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone, chatId, message } = req.body;\n\n    if (!sessionPhone || !chatId || !message) {\n      const error: CustomError = new Error('sessionPhone, chatId, and message are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const { queued } = await connectionManager.sendTextMessage(\n      sessionPhone,\n      chatId,\n      message\n    );\n\n    logger.info(`Message ${queued ? 'queued' : 'sent'} to ${chatId} via ${sessionPhone}`);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: queued ? 'Message queued for delivery' : 'Message sent successfully',\n      queued,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function sendTextMessage(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, message, mentions } = req.body;\n\n    if (!sessionPhone || !to || !message) {\n      const error: CustomError = new Error('sessionPhone, to, and message are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('to is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    // Preparar mensaje con menciones si se proporcionan\n    const messageContent: any = { text: message };\n\n    if (mentions && Array.isArray(mentions) && mentions.length > 0) {\n      // Normalizar menciones a formato JID\n      const mentionedJids = mentions.map((phone: string) => normalizeRecipient(phone));\n      messageContent.mentions = mentionedJids;\n      logger.info(`Sending message with ${mentionedJids.length} mentions`);\n    }\n\n    // Enviar mensaje\n    await socket.sendMessage(recipient, messageContent);\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Message sent successfully',\n      mentionsCount: mentions?.length || 0,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function sendImage(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, caption } = req.body;\n    const file = req.file;\n\n    if (!sessionPhone || !to || !file) {\n      const error: CustomError = new Error('sessionPhone, to, and file are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('to is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await socket.sendMessage(recipient, {\n      image: file.buffer,\n      caption,\n      mimetype: file.mimetype,\n    });\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Image sent successfully',\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function sendVideo(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, caption } = req.body;\n    const file = req.file;\n\n    if (!sessionPhone || !to || !file) {\n      const error: CustomError = new Error('sessionPhone, to, and file are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('to is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await socket.sendMessage(recipient, {\n      video: file.buffer,\n      caption,\n      mimetype: file.mimetype,\n    });\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Video sent successfully',\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function sendFile(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, caption, mimeType } = req.body;\n    const file = req.file;\n\n    if (!sessionPhone || !to || !file) {\n      const error: CustomError = new Error('sessionPhone, to, and file are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('to is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await socket.sendMessage(recipient, {\n      document: file.buffer,\n      fileName: file.originalname || 'document',\n      mimetype: detectMimeType(file.originalname, mimeType || file.mimetype),\n      caption,\n    });\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'File sent successfully',\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getConversation(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone, chatId } = req.params;\n\n    if (!sessionPhone || !chatId) {\n      const error: CustomError = new Error('sessionPhone and chatId are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const conversation = await conversationManager.get(chatId, sessionPhone);\n\n    if (!conversation) {\n      const error: CustomError = new Error('Conversation not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: conversation,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getAllConversations(\n  req: Request,\n  res: Response,\n  next: NextFunction\n) {\n  try {\n    const { sessionPhone } = req.params;\n\n    if (!sessionPhone) {\n      const error: CustomError = new Error('sessionPhone is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const conversations = await conversationManager.getAllForSession(sessionPhone);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        total: conversations.length,\n        conversations,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function closeConversation(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone, chatId } = req.params;\n\n    if (!sessionPhone || !chatId) {\n      const error: CustomError = new Error('sessionPhone and chatId are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await conversationManager.closeConversation(chatId, sessionPhone);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Conversation closed',\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\n/**\n * Env\u00EDa una encuesta (poll) a WhatsApp\n * Fase 11: Mensajes Avanzados\n */\nexport async function sendPoll(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, question, options, selectableCount } = req.body;\n\n    if (!sessionPhone || !to || !question || !options) {\n      const error: CustomError = new Error('sessionPhone, to, question, and options are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    if (!Array.isArray(options) || options.length < 2) {\n      const error: CustomError = new Error('options must be an array with at least 2 items');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    if (options.length > 12) {\n      const error: CustomError = new Error('options cannot exceed 12 items');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('Invalid recipient');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    // Determinar n\u00FAmero de opciones seleccionables\n    const selectableOptions = selectableCount || 1;\n    const maxSelectable = Math.min(selectableOptions, options.length);\n\n    // Enviar poll\n    const message = await socket.sendMessage(recipient, {\n      poll: {\n        name: question,\n        values: options,\n        selectableCount: maxSelectable,\n      },\n    });\n\n    logger.info(`Poll sent to ${recipient}: ${question} (${options.length} options)`);\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Poll sent successfully',\n      messageId: message.key.id,\n      pollDetails: {\n        question,\n        optionsCount: options.length,\n        selectableCount: maxSelectable,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\n/**\n * Env\u00EDa un men\u00FA de texto numerado (alternativa a buttons)\n * Fase 11: Mensajes Avanzados\n */\nexport async function sendTextMenu(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { sessionPhone } = req.params;\n    const { to, title, options, footer } = req.body;\n\n    if (!sessionPhone || !to || !options) {\n      const error: CustomError = new Error('sessionPhone, to, and options are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    if (!Array.isArray(options) || options.length < 1) {\n      const error: CustomError = new Error('options must be an array with at least 1 item');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const isConnected = await connectionManager.ensureConnected(sessionPhone);\n    const socket = connectionManager.getConnection(sessionPhone);\n    if (!socket || !isConnected) {\n      const error: CustomError = new Error('Session not connected');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const recipient = normalizeRecipient(to);\n    if (!recipient) {\n      const error: CustomError = new Error('Invalid recipient');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    // Construir men\u00FA de texto\n    const menuLines: string[] = [];\n\n    if (title) {\n      menuLines.push(`*${title}*`);\n      menuLines.push('');\n    }\n\n    options.forEach((option: string, index: number) => {\n      menuLines.push(`${index + 1}. ${option}`);\n    });\n\n    if (footer) {\n      menuLines.push('');\n      menuLines.push(footer);\n    } else {\n      menuLines.push('');\n      menuLines.push('_Reply with the number of your choice_');\n    }\n\n    const menuText = menuLines.join('\\n');\n\n    // Enviar mensaje\n    await socket.sendMessage(recipient, { text: menuText });\n\n    logger.info(`Text menu sent to ${recipient}: ${options.length} options`);\n\n    // Incrementar quota de WhatsApp (Fase 10)\n    if (req.companyId) {\n      await incrementWhatsAppUsage(req.companyId);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Text menu sent successfully',\n      menuDetails: {\n        title: title || null,\n        optionsCount: options.length,\n        footer: footer || null,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n", "/**\n * Quota Middleware - Multi-Tenant Quota Validation\n *\n * Middleware para validar quotas antes de ejecutar operaciones.\n * Previene que las empresas excedan sus l\u00EDmites de uso.\n *\n * Fase 10: Quotas y Validaciones\n *\n * @example\n * ```typescript\n * router.post('/message/text',\n *   requireTenant,\n *   requireWhatsAppQuota,\n *   sendMessage\n * );\n *\n * router.post('/drive/files',\n *   requireTenant,\n *   requireStorageQuota,\n *   uploadFile\n * );\n * ```\n */\n\nimport { Request, Response, NextFunction } from 'express';\nimport { quotaValidatorService } from '../services/quota-validator.service.js';\nimport logger from '../utils/logger.js';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\ninterface CustomError extends Error {\n  statusCode?: number;\n  code?: string;\n}\n\n// ============================================================================\n// WHATSAPP QUOTA MIDDLEWARE\n// ============================================================================\n\n/**\n * Middleware que verifica la quota de WhatsApp antes de enviar mensajes\n * Requiere que req.companyId est\u00E9 definido (usar despu\u00E9s de requireTenant)\n */\nexport async function requireWhatsAppQuota(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  try {\n    const companyId = req.companyId;\n\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = 401;\n      error.code = 'COMPANY_ID_REQUIRED';\n      throw error;\n    }\n\n    // Verificar si el servicio est\u00E1 listo\n    if (!quotaValidatorService.isReady()) {\n      logger.warn('QuotaValidator not ready, allowing operation');\n      return next();\n    }\n\n    // Verificar quota\n    const allowed = await quotaValidatorService.checkWhatsAppQuota(companyId);\n\n    if (!allowed) {\n      const quotaInfo = await quotaValidatorService.getWhatsAppQuotaInfo(companyId);\n\n      logger.warn(`WhatsApp quota exceeded for company ${companyId}`, quotaInfo);\n\n      res.status(429).json({\n        success: false,\n        error: {\n          message: 'WhatsApp message quota exceeded for this month',\n          code: 'WHATSAPP_QUOTA_EXCEEDED',\n          statusCode: 429,\n          quota: {\n            current: quotaInfo.current,\n            limit: quotaInfo.limit,\n            remaining: quotaInfo.remaining,\n            period: quotaInfo.period,\n          },\n        },\n      });\n      return;\n    }\n\n    logger.debug(`WhatsApp quota check passed for company ${companyId}`);\n    next();\n  } catch (error) {\n    const err = error as CustomError;\n    const statusCode = err.statusCode || 500;\n\n    logger.error('WhatsApp quota validation error:', error);\n\n    res.status(statusCode).json({\n      success: false,\n      error: {\n        message: err.message || 'Error validating WhatsApp quota',\n        code: err.code || 'QUOTA_VALIDATION_ERROR',\n        statusCode,\n      },\n    });\n  }\n}\n\n/**\n * Middleware opcional que verifica WhatsApp quota pero no bloquea\n * \u00DAtil para endpoints donde queremos advertir pero no bloquear\n */\nexport async function checkWhatsAppQuota(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  try {\n    const companyId = req.companyId;\n\n    if (!companyId || !quotaValidatorService.isReady()) {\n      return next();\n    }\n\n    const quotaInfo = await quotaValidatorService.getWhatsAppQuotaInfo(companyId);\n\n    // Agregar info al request para que el controller pueda usarla\n    (req as any).quotaInfo = { whatsapp: quotaInfo };\n\n    // Advertir si est\u00E1 cerca del l\u00EDmite (90%)\n    if (quotaInfo.current / quotaInfo.limit >= 0.9) {\n      logger.warn(`WhatsApp quota near limit for company ${companyId}:`, quotaInfo);\n    }\n\n    next();\n  } catch (error) {\n    logger.error('Error checking WhatsApp quota:', error);\n    next(); // Continuar sin bloquear\n  }\n}\n\n// ============================================================================\n// STORAGE QUOTA MIDDLEWARE\n// ============================================================================\n\n/**\n * Middleware que verifica la quota de almacenamiento antes de subir archivos\n * Requiere que req.file est\u00E9 definido (usar despu\u00E9s de multer)\n * Requiere que req.companyId est\u00E9 definido (usar despu\u00E9s de requireTenant)\n */\nexport async function requireStorageQuota(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  try {\n    const companyId = req.companyId;\n\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = 401;\n      error.code = 'COMPANY_ID_REQUIRED';\n      throw error;\n    }\n\n    // Obtener tama\u00F1o del archivo\n    const file = req.file;\n    if (!file) {\n      const error: CustomError = new Error('File is required');\n      error.statusCode = 400;\n      error.code = 'FILE_REQUIRED';\n      throw error;\n    }\n\n    const fileSize = file.size;\n\n    // Verificar si el servicio est\u00E1 listo\n    if (!quotaValidatorService.isReady()) {\n      logger.warn('QuotaValidator not ready, allowing operation');\n      return next();\n    }\n\n    // Verificar quota\n    const allowed = await quotaValidatorService.checkStorageQuota(companyId, fileSize);\n\n    if (!allowed) {\n      const quotaInfo = await quotaValidatorService.getStorageQuotaInfo(companyId);\n\n      logger.warn(`Storage quota exceeded for company ${companyId}`, {\n        fileSize,\n        ...quotaInfo,\n      });\n\n      res.status(429).json({\n        success: false,\n        error: {\n          message: 'Storage quota exceeded',\n          code: 'STORAGE_QUOTA_EXCEEDED',\n          statusCode: 429,\n          quota: {\n            current: quotaInfo.current,\n            limit: quotaInfo.limit,\n            remaining: quotaInfo.remaining,\n            period: quotaInfo.period,\n            currentFormatted: formatBytes(quotaInfo.current),\n            limitFormatted: formatBytes(quotaInfo.limit),\n            remainingFormatted: formatBytes(quotaInfo.remaining),\n            fileSizeFormatted: formatBytes(fileSize),\n          },\n        },\n      });\n      return;\n    }\n\n    logger.debug(`Storage quota check passed for company ${companyId}: ${fileSize} bytes`);\n    next();\n  } catch (error) {\n    const err = error as CustomError;\n    const statusCode = err.statusCode || 500;\n\n    logger.error('Storage quota validation error:', error);\n\n    res.status(statusCode).json({\n      success: false,\n      error: {\n        message: err.message || 'Error validating storage quota',\n        code: err.code || 'QUOTA_VALIDATION_ERROR',\n        statusCode,\n      },\n    });\n  }\n}\n\n// ============================================================================\n// HELPERS\n// ============================================================================\n\n/**\n * Incrementa el contador de mensajes de WhatsApp despu\u00E9s de enviar\n * Usar en el controller despu\u00E9s de enviar el mensaje\n */\nexport async function incrementWhatsAppUsage(companyId: string): Promise<void> {\n  try {\n    if (quotaValidatorService.isReady()) {\n      await quotaValidatorService.incrementWhatsAppUsage(companyId, 1);\n      logger.debug(`Incremented WhatsApp usage for company ${companyId}`);\n    }\n  } catch (error) {\n    logger.error('Error incrementing WhatsApp usage:', error);\n    // No lanzar error, solo loggear\n  }\n}\n\n/**\n * Incrementa el contador de almacenamiento despu\u00E9s de subir archivo\n * Usar en el controller despu\u00E9s de guardar el archivo\n */\nexport async function incrementStorageUsage(companyId: string, fileSize: number): Promise<void> {\n  try {\n    if (quotaValidatorService.isReady()) {\n      await quotaValidatorService.incrementStorageUsage(companyId, fileSize);\n      logger.debug(`Incremented storage usage for company ${companyId}: ${fileSize} bytes`);\n    }\n  } catch (error) {\n    logger.error('Error incrementing storage usage:', error);\n    // No lanzar error, solo loggear\n  }\n}\n\n/**\n * Decrementa el contador de almacenamiento despu\u00E9s de eliminar archivo\n * Usar en el controller despu\u00E9s de eliminar el archivo\n */\nexport async function decrementStorageUsage(companyId: string, fileSize: number): Promise<void> {\n  try {\n    if (quotaValidatorService.isReady()) {\n      await quotaValidatorService.decrementStorageUsage(companyId, fileSize);\n      logger.debug(`Decremented storage usage for company ${companyId}: ${fileSize} bytes`);\n    }\n  } catch (error) {\n    logger.error('Error decrementing storage usage:', error);\n    // No lanzar error, solo loggear\n  }\n}\n\n/**\n * Formatea bytes a formato legible\n */\nfunction formatBytes(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;\n}\n", "/**\n * Tenant Middleware - Multi-Tenant JWT Validation\n *\n * Middleware para validar JWT y extraer companyId del token.\n * Asegura que cada petici\u00F3n est\u00E9 asociada a una empresa espec\u00EDfica.\n *\n * Fase 9: Multi-Tenant Portal Transformation\n *\n * @example\n * ```typescript\n * router.post('/files', requireTenant, uploadFile);\n * ```\n */\n\nimport { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { config } from '../config/environment.js';\nimport logger from '../utils/logger.js';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\ninterface JWTPayload {\n  companyId: string;\n  userId?: string;\n  email?: string;\n  role?: string;\n  [key: string]: any;\n}\n\ninterface CustomError extends Error {\n  statusCode?: number;\n}\n\n// ============================================================================\n// MIDDLEWARE\n// ============================================================================\n\n/**\n * Middleware que requiere autenticaci\u00F3n por tenant\n * Extrae el JWT del header Authorization y valida el companyId\n */\nexport function requireTenant(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): void {\n  try {\n    // Extraer token del header Authorization\n    const authHeader = req.headers.authorization;\n\n    if (!authHeader) {\n      const error: CustomError = new Error('No authorization header provided');\n      error.statusCode = 401;\n      throw error;\n    }\n\n    // El formato esperado es: \"Bearer <token>\"\n    const parts = authHeader.split(' ');\n\n    if (parts.length !== 2 || parts[0] !== 'Bearer') {\n      const error: CustomError = new Error('Invalid authorization header format. Expected: Bearer <token>');\n      error.statusCode = 401;\n      throw error;\n    }\n\n    const token = parts[1];\n\n    if (!token) {\n      const error: CustomError = new Error('No token provided');\n      error.statusCode = 401;\n      throw error;\n    }\n\n    // Validar token\n    let decoded: JWTPayload;\n\n    try {\n      decoded = jwt.verify(token, config.security.jwtSecret) as JWTPayload;\n    } catch (err) {\n      const error: CustomError = new Error('Invalid or expired token');\n      error.statusCode = 401;\n      throw error;\n    }\n\n    // Verificar que el token contenga companyId\n    if (!decoded.companyId) {\n      const error: CustomError = new Error('Token does not contain companyId');\n      error.statusCode = 401;\n      throw error;\n    }\n\n    // Inyectar companyId en el request para que est\u00E9 disponible en los controladores\n    req.companyId = decoded.companyId;\n\n    logger.info(`Tenant validated: ${decoded.companyId}`, {\n      path: req.path,\n      method: req.method,\n      userId: decoded.userId,\n    });\n\n    next();\n  } catch (err) {\n    const error = err as CustomError;\n    const statusCode = error.statusCode || 401;\n\n    logger.warn('Tenant validation failed:', {\n      path: req.path,\n      method: req.method,\n      error: error.message,\n    });\n\n    res.status(statusCode).json({\n      success: false,\n      error: {\n        message: error.message,\n        statusCode,\n      },\n    });\n  }\n}\n\n/**\n * Middleware opcional que intenta extraer el tenant pero no falla si no existe\n * \u00DAtil para endpoints que pueden funcionar con o sin autenticaci\u00F3n\n */\nexport function optionalTenant(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): void {\n  try {\n    const authHeader = req.headers.authorization;\n\n    if (!authHeader) {\n      return next();\n    }\n\n    const parts = authHeader.split(' ');\n\n    if (parts.length !== 2 || parts[0] !== 'Bearer') {\n      return next();\n    }\n\n    const token = parts[1];\n\n    if (!token) {\n      return next();\n    }\n\n    try {\n      const decoded = jwt.verify(token, config.security.jwtSecret) as JWTPayload;\n\n      if (decoded.companyId) {\n        req.companyId = decoded.companyId;\n        logger.info(`Optional tenant identified: ${decoded.companyId}`);\n      }\n    } catch (err) {\n      // Token inv\u00E1lido, pero no fallar - continuar sin companyId\n      logger.debug('Optional tenant validation failed (ignored):', err);\n    }\n\n    next();\n  } catch (err) {\n    // En caso de cualquier error, simplemente continuar sin tenant\n    next();\n  }\n}\n\n// ============================================================================\n// HELPERS\n// ============================================================================\n\n/**\n * Genera un JWT de prueba para desarrollo\n * SOLO USAR EN DESARROLLO\n */\nexport function generateDevToken(companyId: string, userId?: string): string {\n  if (config.nodeEnv === 'production') {\n    throw new Error('generateDevToken is only available in development');\n  }\n\n  const payload: JWTPayload = {\n    companyId,\n    userId: userId || 'dev-user',\n    email: 'dev@constroad.com',\n    role: 'admin',\n  };\n\n  return jwt.sign(payload, config.security.jwtSecret, {\n    expiresIn: '24h',\n  });\n}\n", "/**\n * Company Rate Limiter Middleware - Per-Company Rate Limiting\n *\n * Middleware para limitar el n\u00FAmero de requests por empresa en una ventana de tiempo.\n * Usa almacenamiento en memoria (in-memory) para tracking.\n *\n * Fase 10: Quotas y Validaciones (In-Memory)\n *\n * @example\n * ```typescript\n * // Limitar a 100 requests por minuto por empresa\n * router.post('/api/messages',\n *   requireTenant,\n *   companyRateLimiter({ limit: 100, windowMs: 60000 }),\n *   sendMessage\n * );\n * ```\n */\n\nimport { Request, Response, NextFunction } from 'express';\nimport logger from '../utils/logger.js';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface RateLimiterOptions {\n  /**\n   * N\u00FAmero m\u00E1ximo de requests permitidos en la ventana\n   */\n  limit: number;\n\n  /**\n   * Tama\u00F1o de la ventana en milisegundos\n   * @default 60000 (1 minuto)\n   */\n  windowMs?: number;\n\n  /**\n   * Mensaje personalizado cuando se excede el l\u00EDmite\n   */\n  message?: string;\n\n  /**\n   * Incluir headers de rate limit en la respuesta\n   * @default true\n   */\n  includeHeaders?: boolean;\n\n  /**\n   * Handler personalizado cuando se excede el l\u00EDmite\n   */\n  onLimitReached?: (req: Request, res: Response) => void;\n}\n\ninterface RateLimitRecord {\n  count: number;\n  resetTime: number;\n}\n\n// ============================================================================\n// IN-MEMORY STORE\n// ============================================================================\n\n/**\n * Almacena contadores de rate limit en memoria por empresa\n * Key: companyId\n * Value: { count, resetTime }\n */\nconst rateLimitStore = new Map<string, RateLimitRecord>();\n\n/**\n * Limpia registros expirados cada 5 minutos\n */\nsetInterval(() => {\n  const now = Date.now();\n  for (const [companyId, record] of rateLimitStore.entries()) {\n    if (now > record.resetTime) {\n      rateLimitStore.delete(companyId);\n    }\n  }\n}, 5 * 60 * 1000); // 5 minutos\n\n/**\n * Verifica y actualiza el rate limit para una empresa\n */\nfunction checkAndIncrementRateLimit(\n  companyId: string,\n  limit: number,\n  windowMs: number\n): { allowed: boolean; current: number; resetTime: number } {\n  const now = Date.now();\n  const record = rateLimitStore.get(companyId);\n\n  // Si no hay registro o expir\u00F3, crear uno nuevo\n  if (!record || now > record.resetTime) {\n    const newRecord: RateLimitRecord = {\n      count: 1,\n      resetTime: now + windowMs,\n    };\n    rateLimitStore.set(companyId, newRecord);\n\n    return {\n      allowed: true,\n      current: 1,\n      resetTime: newRecord.resetTime,\n    };\n  }\n\n  // Incrementar contador\n  record.count++;\n  rateLimitStore.set(companyId, record);\n\n  const allowed = record.count <= limit;\n\n  return {\n    allowed,\n    current: record.count,\n    resetTime: record.resetTime,\n  };\n}\n\n// ============================================================================\n// MIDDLEWARE FACTORY\n// ============================================================================\n\n/**\n * Crea un middleware de rate limiting por empresa\n */\nexport function companyRateLimiter(options: RateLimiterOptions) {\n  const {\n    limit,\n    windowMs = 60000, // 1 minuto por defecto\n    message = 'Too many requests, please try again later',\n    includeHeaders = true,\n    onLimitReached,\n  } = options;\n\n  return async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const companyId = req.companyId;\n\n      // Si no hay companyId, pasar al siguiente middleware\n      // (esto significa que requireTenant no se ejecut\u00F3 antes)\n      if (!companyId) {\n        logger.warn('Company rate limiter called without companyId');\n        return next();\n      }\n\n      // Verificar rate limit\n      const result = checkAndIncrementRateLimit(companyId, limit, windowMs);\n\n      // Agregar headers de rate limit\n      if (includeHeaders) {\n        res.setHeader('X-RateLimit-Limit', limit.toString());\n        res.setHeader('X-RateLimit-Remaining', Math.max(0, limit - result.current).toString());\n        res.setHeader('X-RateLimit-Reset', result.resetTime.toString());\n      }\n\n      // Si excede el l\u00EDmite\n      if (!result.allowed) {\n        logger.warn(`Rate limit exceeded for company ${companyId}`, {\n          current: result.current,\n          limit,\n          windowMs,\n        });\n\n        // Agregar header de retry despu\u00E9s de\n        const retryAfter = Math.ceil((result.resetTime - Date.now()) / 1000);\n        res.setHeader('Retry-After', retryAfter.toString());\n\n        // Ejecutar handler personalizado si existe\n        if (onLimitReached) {\n          onLimitReached(req, res);\n          return;\n        }\n\n        // Respuesta por defecto\n        res.status(429).json({\n          success: false,\n          error: {\n            message,\n            code: 'RATE_LIMIT_EXCEEDED',\n            statusCode: 429,\n            rateLimit: {\n              limit,\n              current: result.current,\n              windowMs,\n              retryAfter,\n            },\n          },\n        });\n        return;\n      }\n\n      // Rate limit no excedido, continuar\n      next();\n    } catch (error) {\n      logger.error('Error in company rate limiter:', error);\n      // En caso de error, permitir la request\n      next();\n    }\n  };\n}\n\n// ============================================================================\n// PRESET CONFIGURATIONS\n// ============================================================================\n\n/**\n * Rate limiter estricto: 10 requests por minuto\n */\nexport const strictRateLimiter = companyRateLimiter({\n  limit: 10,\n  windowMs: 60000, // 1 minuto\n  message: 'Rate limit exceeded. Maximum 10 requests per minute.',\n});\n\n/**\n * Rate limiter moderado: 60 requests por minuto\n */\nexport const moderateRateLimiter = companyRateLimiter({\n  limit: 60,\n  windowMs: 60000, // 1 minuto\n  message: 'Rate limit exceeded. Maximum 60 requests per minute.',\n});\n\n/**\n * Rate limiter generoso: 200 requests por minuto\n */\nexport const generousRateLimiter = companyRateLimiter({\n  limit: 200,\n  windowMs: 60000, // 1 minuto\n  message: 'Rate limit exceeded. Maximum 200 requests per minute.',\n});\n\n/**\n * Rate limiter para WhatsApp: 30 mensajes por minuto\n */\nexport const whatsappRateLimiter = companyRateLimiter({\n  limit: 30,\n  windowMs: 60000, // 1 minuto\n  message: 'WhatsApp rate limit exceeded. Maximum 30 messages per minute.',\n});\n\n/**\n * Rate limiter para uploads: 20 archivos por minuto\n */\nexport const uploadRateLimiter = companyRateLimiter({\n  limit: 20,\n  windowMs: 60000, // 1 minuto\n  message: 'Upload rate limit exceeded. Maximum 20 uploads per minute.',\n});\n\n// ============================================================================\n// HELPERS\n// ============================================================================\n\n/**\n * Parsea una string de tiempo (ej: \"5m\", \"1h\") a milisegundos\n */\nexport function parseTimeWindow(timeStr: string): number {\n  const units: Record<string, number> = {\n    s: 1000,\n    m: 60000,\n    h: 3600000,\n    d: 86400000,\n  };\n\n  const match = timeStr.match(/^(\\d+)([smhd])$/);\n\n  if (!match) {\n    throw new Error(`Invalid time window format: ${timeStr}`);\n  }\n\n  const value = parseInt(match[1], 10);\n  const unit = match[2];\n\n  return value * units[unit];\n}\n\n/**\n * Crea un rate limiter desde configuraci\u00F3n de environment\n */\nexport function createRateLimiterFromConfig() {\n  const limitStr = process.env.COMPANY_RATE_LIMIT || '100';\n  const windowStr = process.env.COMPANY_RATE_WINDOW || '1m';\n\n  const limit = parseInt(limitStr, 10);\n  const windowMs = parseTimeWindow(windowStr);\n\n  return companyRateLimiter({ limit, windowMs });\n}\n\n/**\n * Limpia todos los registros de rate limit (\u00FAtil para testing)\n */\nexport function clearAllRateLimits(): void {\n  rateLimitStore.clear();\n  logger.info('All rate limit records cleared');\n}\n", "import { Router } from 'express';\nimport * as pdfController from '../controllers/pdf.controller.js';\nimport { generateVale, previewValeTemplateGrid } from '../controllers/pdf-vale.controller.js';\n\nconst router = Router();\n\n// POST /api/pdf/generate - Generar PDF desde template\nrouter.post('/generate', pdfController.generatePDF);\n\n// POST /api/pdf/generate-vale - Generar vale desde template PDF\nrouter.post('/generate-vale', generateVale);\n\n// GET /api/pdf/templates/preview-grid - Preview template con grilla\nrouter.get('/templates/preview-grid', previewValeTemplateGrid);\n\n// POST /api/pdf/templates - Crear nuevo template\nrouter.post('/templates', pdfController.createTemplate);\n\n// GET /api/pdf/templates - Listar templates\nrouter.get('/templates', pdfController.listTemplates);\n\n// DELETE /api/pdf/templates/:templateId - Eliminar template\nrouter.delete('/templates/:templateId', pdfController.deleteTemplate);\n\nexport default router;\n", "import puppeteer, { Browser } from 'puppeteer';\nimport Handlebars from 'handlebars';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport { randomUUID } from 'crypto';\nimport logger from '../utils/logger.js';\nimport { PDFGenerationRequest } from '../types/index.js';\nimport { config } from '../config/environment.js';\n\nexport class PDFGenerator {\n  private browser: Browser | null = null;\n  private templatesDir: string;\n  private uploadsDir: string;\n\n  constructor() {\n    this.templatesDir = config.pdf.templatesDir;\n    this.uploadsDir = config.pdf.uploadsDir;\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      logger.info('Initializing PDF Generator...');\n      \n      // Asegurar que los directorios existen\n      await fs.ensureDir(this.templatesDir);\n      await fs.ensureDir(this.uploadsDir);\n\n      // Inicializar navegador\n      this.browser = await puppeteer.launch({\n        headless: true,\n        args: ['--no-sandbox', '--disable-setuid-sandbox'],\n      });\n\n      logger.info('PDF Generator initialized');\n    } catch (error) {\n      logger.error('Error initializing PDF Generator:', error);\n      throw error;\n    }\n  }\n\n  async generatePDF(request: PDFGenerationRequest): Promise<string> {\n    try {\n      if (!this.browser) {\n        throw new Error('PDF Generator not initialized');\n      }\n\n      logger.info(`Generating PDF from template: ${request.templateId}`);\n\n      // Cargar template\n      const template = await this.loadTemplate(request.templateId);\n\n      // Compilar y renderizar HTML\n      const compiled = Handlebars.compile(template);\n      const html = compiled(request.data);\n\n      // Crear PDF\n      const filename = request.filename || `pdf-${randomUUID()}.pdf`;\n      const filepath = path.join(this.uploadsDir, filename);\n\n      const page = await this.browser.newPage();\n      await page.setContent(html, { waitUntil: 'networkidle0' });\n      await page.pdf({\n        path: filepath,\n        format: 'A4',\n        margin: { top: '20px', right: '20px', bottom: '20px', left: '20px' },\n      });\n      await page.close();\n\n      logger.info(`PDF generated: ${filepath}`);\n      return filepath;\n    } catch (error) {\n      logger.error('Error generating PDF:', error);\n      throw error;\n    }\n  }\n\n  async createTemplate(id: string, name: string, htmlContent: string): Promise<void> {\n    try {\n      const filepath = path.join(this.templatesDir, `${id}.hbs`);\n      await fs.ensureDir(path.dirname(filepath));\n      await fs.writeFile(filepath, htmlContent, 'utf-8');\n\n      logger.info(`Created PDF template: ${id}`);\n    } catch (error) {\n      logger.error('Error creating PDF template:', error);\n      throw error;\n    }\n  }\n\n  async loadTemplate(templateId: string): Promise<string> {\n    try {\n      const filepath = path.join(this.templatesDir, `${templateId}.hbs`);\n\n      if (!(await fs.pathExists(filepath))) {\n        throw new Error(`Template not found: ${templateId}`);\n      }\n\n      return await fs.readFile(filepath, 'utf-8');\n    } catch (error) {\n      logger.error('Error loading template:', error);\n      throw error;\n    }\n  }\n\n  async listTemplates(): Promise<string[]> {\n    try {\n      const files = await fs.readdir(this.templatesDir);\n      return files\n        .filter((f) => f.endsWith('.hbs'))\n        .map((f) => f.replace('.hbs', ''));\n    } catch (error) {\n      logger.error('Error listing templates:', error);\n      return [];\n    }\n  }\n\n  async deleteTemplate(templateId: string): Promise<void> {\n    try {\n      const filepath = path.join(this.templatesDir, `${templateId}.hbs`);\n      if (await fs.pathExists(filepath)) {\n        await fs.remove(filepath);\n        logger.info(`Deleted template: ${templateId}`);\n      }\n    } catch (error) {\n      logger.error('Error deleting template:', error);\n      throw error;\n    }\n  }\n\n  async shutdown(): Promise<void> {\n    if (this.browser) {\n      await this.browser.close();\n      logger.info('PDF Generator shut down');\n    }\n  }\n}\n\nexport default new PDFGenerator();\n", "import { Request, Response, NextFunction } from 'express';\nimport pdfGenerator from '../../pdf/generator.service.js';\nimport logger from '../../utils/logger.js';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\n\nexport async function generatePDF(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { templateId, data, filename } = req.body;\n\n    if (!templateId || !data) {\n      const error: CustomError = new Error('templateId and data are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const filepath = await pdfGenerator.generatePDF({\n      templateId,\n      data,\n      filename,\n    });\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: {\n        filepath,\n        filename: filename || `pdf-${Date.now()}.pdf`,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function createTemplate(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { id, name, htmlContent } = req.body;\n\n    if (!id || !name || !htmlContent) {\n      const error: CustomError = new Error('id, name, and htmlContent are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await pdfGenerator.createTemplate(id, name, htmlContent);\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      message: `Template ${id} created`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function listTemplates(req: Request, res: Response, next: NextFunction) {\n  try {\n    const templates = await pdfGenerator.listTemplates();\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        total: templates.length,\n        templates,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function deleteTemplate(req: Request, res: Response, next: NextFunction) {\n  try {\n    const { templateId } = req.params;\n\n    if (!templateId) {\n      const error: CustomError = new Error('templateId is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    await pdfGenerator.deleteTemplate(templateId);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: `Template ${templateId} deleted`,\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n", "import { Request, Response, NextFunction } from 'express';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport { PDFDocument, StandardFonts, rgb } from 'pdf-lib';\nimport { randomUUID } from 'crypto';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\nimport { config } from '../../config/environment.js';\nimport { renderPdfPageToPngWithGrid } from '../../pdf/render.service.js';\nimport connectionManager from '../../whatsapp/baileys/connection.manager.js';\n\ntype ValeFields = {\n  nroVale?: string;\n  fecha?: string;\n  senores: string;\n  obra: string;\n  tipoMaterial: string;\n  nroM3: string;\n  placa: string;\n  chofer: string;\n  hora: string;\n  nota?: string;\n};\n\ntype NotifyPayload = {\n  whatsapp?: {\n    from?: string;\n    to?: string;\n    caption?: string;\n  };\n  telegram?: {\n    chatId?: string;\n    caption?: string;\n  };\n};\n\ntype ValeCoords = Record<\n  keyof ValeFields,\n  {\n    x: number;\n    y: number;\n    size?: number;\n    bold?: boolean;\n  }\n>;\n\nconst DEFAULT_TEMPLATE = 'plantilla_dispatch_note.pdf';\n\nconst DEFAULT_COORDS: ValeCoords = {\n  nroVale: { x: 445, y: 755, size: 11, bold: true },\n  fecha: { x: 450, y: 725, size: 11, bold: true },\n  senores: { x: 122, y: 676, size: 11, bold: true },\n  obra: { x: 122, y: 655, size: 11 },\n  tipoMaterial: { x: 122, y: 632, size: 11 },\n  nroM3: { x: 230, y: 608, size: 11 },\n  placa: { x: 405, y: 610, size: 11 },\n  chofer: { x: 405, y: 585, size: 11 },\n  hora: { x: 405, y: 560, size: 11 },\n  nota: { x: 122, y: 588, size: 11 },\n};\n\nfunction adjustFontSizeForValue(\n  key: keyof ValeFields,\n  value: string,\n  baseSize: number\n) {\n  if (key !== 'obra') return baseSize;\n  const length = value.trim().length;\n  if (length > 70) return Math.max(8, baseSize - 4);\n  if (length > 55) return Math.max(9, baseSize - 3);\n  if (length > 40) return Math.max(10, baseSize - 2);\n  if (length > 30) return Math.max(11, baseSize - 1);\n  return baseSize;\n}\n\nfunction normalizeWhatsappTarget(raw: string) {\n  const trimmed = raw.trim();\n  if (!trimmed) return null;\n  if (trimmed.includes('@')) return trimmed;\n  if (trimmed.includes('-')) {\n    return `${trimmed}@g.us`;\n  }\n  const digits = trimmed.replace(/[^\\d]/g, '');\n  if (digits.length < 8) return null;\n  return `${digits}@s.whatsapp.net`;\n}\n\nfunction getDefaultWhatsappSession() {\n  const sessions = Array.from(connectionManager.getAllConnections().keys());\n  return sessions.find((phone) => connectionManager.isConnected(phone)) || null;\n}\n\nasync function sendWhatsappNotification(\n  sessionOverride: string | undefined,\n  target: string,\n  caption: string | undefined,\n  fileBuffer: Buffer,\n  filename: string\n) {\n  const sessionPhone = sessionOverride || getDefaultWhatsappSession();\n  if (!sessionPhone) {\n    throw new Error('No WhatsApp session connected');\n  }\n  const recipient = normalizeWhatsappTarget(target);\n  if (!recipient) {\n    throw new Error('Invalid WhatsApp target');\n  }\n\n  const isConnected = await connectionManager.ensureConnected(sessionPhone);\n  if (!isConnected) {\n    throw new Error('WhatsApp session not connected');\n  }\n\n  const socket = connectionManager.getConnection(sessionPhone);\n  if (!socket) {\n    throw new Error('WhatsApp session not connected');\n  }\n\n  await socket.sendMessage(recipient, {\n    document: fileBuffer,\n    fileName: filename,\n    mimetype: 'application/pdf',\n    caption,\n  });\n\n  return { sessionPhone, recipient };\n}\n\nasync function sendTelegramNotification(\n  chatId: string,\n  caption: string | undefined,\n  fileBuffer: Buffer,\n  filename: string\n) {\n  if (!config.telegram.botToken) {\n    throw new Error('Telegram bot token not configured');\n  }\n\n  const form = new FormData();\n  form.append('chat_id', chatId);\n  if (caption) form.append('caption', caption);\n  form.append('document', new Blob([fileBuffer], { type: 'application/pdf' }), filename);\n\n  const response = await fetch(\n    `https://api.telegram.org/bot${config.telegram.botToken}/sendDocument`,\n    {\n      method: 'POST',\n      body: form,\n    }\n  );\n\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(`Telegram error: ${response.status} ${text}`);\n  }\n}\n\nfunction buildAbsoluteUrl(req: Request, relativeUrl: string) {\n  const host = req.get('host');\n  if (!host) return relativeUrl;\n  const proto = req.protocol;\n  return `${proto}://${host}${relativeUrl}`;\n}\n\nexport async function generateVale(req: Request, res: Response, next: NextFunction) {\n  try {\n    const {\n      template = DEFAULT_TEMPLATE,\n      fields,\n      coords,\n      notify,\n    }: {\n      template?: string;\n      fields?: Partial<ValeFields>;\n      coords?: Partial<ValeCoords>;\n      notify?: NotifyPayload;\n    } = req.body;\n\n    if (!fields) {\n      const error: CustomError = new Error('fields are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const requiredFields: (keyof ValeFields)[] = [\n      'senores',\n      'obra',\n      'tipoMaterial',\n      'nroM3',\n      'placa',\n      'chofer',\n      'hora',\n      'fecha',\n    ];\n\n    for (const key of requiredFields) {\n      if (!fields[key]) {\n        const error: CustomError = new Error(`${key} is required`);\n        error.statusCode = HTTP_STATUS.BAD_REQUEST;\n        return next(error);\n      }\n    }\n\n    const templatePath = path.join(config.pdf.templatesDir, template);\n    if (!(await fs.pathExists(templatePath))) {\n      const error: CustomError = new Error('Template not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const bytes = await fs.readFile(templatePath);\n    const pdfDoc = await PDFDocument.load(bytes);\n    const page = pdfDoc.getPages()[0];\n    const { width, height } = page.getSize();\n    if (width > height) {\n      const error: CustomError = new Error('Template must be portrait (vertical)');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n    const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\n    const fontBold = await pdfDoc.embedFont(StandardFonts.HelveticaBold);\n\n    const signaturePath = path.join(\n      path.dirname(config.pdf.templatesDir),\n      'signatures',\n      'signature-dispatch-note.png'\n    );\n    if (await fs.pathExists(signaturePath)) {\n      const signatureBytes = await fs.readFile(signaturePath);\n      const signatureImage = await pdfDoc.embedPng(signatureBytes);\n      page.drawImage(signatureImage, {\n        x: 120,\n        y: 500,\n        width: 140,\n        height: 55,\n      });\n    }\n\n    const values: ValeFields = {\n      nroVale: fields.nroVale || `VALE-${Date.now()}`,\n      fecha: fields.fecha,\n      senores: fields.senores!,\n      obra: fields.obra!,\n      tipoMaterial: fields.tipoMaterial!,\n      nroM3: fields.nroM3!,\n      placa: fields.placa!,\n      chofer: fields.chofer!,\n      hora: fields.hora!,\n      nota: fields.nota || '',\n    };\n\n    const positions: ValeCoords = {\n      ...DEFAULT_COORDS,\n      ...(coords || {}),\n    } as ValeCoords;\n\n    (Object.keys(values) as (keyof ValeFields)[]).forEach((key) => {\n      const value = values[key];\n      if (!value) return;\n      const pos = positions[key];\n      const isVale = key === 'nroVale';\n      const isbold = pos.bold || false;\n      const size = adjustFontSizeForValue(key, String(value), pos.size || 12);\n      page.drawText(String(value), {\n        x: pos.x,\n        y: pos.y,\n        size,\n        font: isbold ? fontBold : font,\n        color: isVale ? rgb(0.8, 0, 0) : rgb(0, 0, 0),\n      });\n    });\n\n    await fs.ensureDir(config.pdf.tempDir);\n    const valeNumber = fields.nroVale || randomUUID().slice(0, 8);\n    const safeVale = String(valeNumber).replace(/[^a-zA-Z0-9_-]+/g, '-');\n    const filename = `vale-despacho-${safeVale}.pdf`;\n    const outputPath = path.join(config.pdf.tempDir, filename);\n    const pdfBytes = await pdfDoc.save();\n    await fs.writeFile(outputPath, pdfBytes);\n\n    const publicUrl = `${config.pdf.tempPublicBaseUrl.replace(/\\/+$/, '')}/${encodeURI(\n      filename\n    )}`;\n\n    const notifyStatus: Record<string, unknown> = {};\n    const notifyTasks: Promise<void>[] = [];\n\n    if (notify?.whatsapp?.to) {\n      notifyTasks.push(\n        (async () => {\n          try {\n            const result = await sendWhatsappNotification(\n              notify.whatsapp.from,\n              notify.whatsapp.to,\n              notify.whatsapp.caption,\n              Buffer.from(pdfBytes),\n              filename\n            );\n            notifyStatus.whatsapp = { sent: true, ...result };\n          } catch (error) {\n            notifyStatus.whatsapp = { sent: false, error: String(error) };\n          }\n        })()\n      );\n    }\n\n    if (notify?.telegram?.chatId) {\n      notifyTasks.push(\n        (async () => {\n          try {\n            await sendTelegramNotification(\n              notify.telegram.chatId,\n              notify.telegram.caption,\n              Buffer.from(pdfBytes),\n              filename\n            );\n            notifyStatus.telegram = { sent: true };\n          } catch (error) {\n            notifyStatus.telegram = { sent: false, error: String(error) };\n          }\n        })()\n      );\n    }\n\n    if (notifyTasks.length > 0) {\n      await Promise.allSettled(notifyTasks);\n    }\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: {\n        filename,\n        url: publicUrl,\n        urlAbsolute: buildAbsoluteUrl(req, publicUrl),\n        notify: notifyStatus,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function previewValeTemplateGrid(\n  req: Request,\n  res: Response,\n  next: NextFunction\n) {\n  try {\n    const template = String(req.query.template || DEFAULT_TEMPLATE);\n    const page = parseInt(String(req.query.page || '1'), 10);\n    const scale = parseFloat(String(req.query.scale || '1.5'));\n    const gridSize = parseInt(String(req.query.grid || '50'), 10);\n\n    const templatePath = path.join(config.pdf.templatesDir, template);\n    if (!(await fs.pathExists(templatePath))) {\n      const error: CustomError = new Error('Template not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const { cacheFile } = await renderPdfPageToPngWithGrid(templatePath, {\n      page,\n      scale,\n      gridSize,\n    });\n    res.setHeader('Cache-Control', 'public, max-age=3600, immutable');\n    res.setHeader('Content-Type', 'image/png');\n    res.status(HTTP_STATUS.OK).sendFile(path.resolve(cacheFile));\n  } catch (error) {\n    const err: CustomError = error instanceof Error ? error : new Error('Invalid request');\n    if (!err.statusCode) {\n      err.statusCode = HTTP_STATUS.BAD_REQUEST;\n    }\n    next(err);\n  }\n}\n", "import fs from 'fs-extra';\nimport path from 'path';\nimport crypto from 'crypto';\nimport { createCanvas } from '@napi-rs/canvas';\nimport * as pdfjsLib from 'pdfjs-dist/legacy/build/pdf.mjs';\nimport { config } from '../config/environment.js';\n\ntype RenderOptions = {\n  page: number;\n  scale: number;\n  gridSize?: number;\n};\n\nfunction getCacheKey(filePath: string, stat: fs.Stats, page: number, scale: number) {\n  const raw = `${filePath}:${stat.size}:${stat.mtimeMs}:${page}:${scale}`;\n  return crypto.createHash('sha1').update(raw).digest('hex');\n}\n\nfunction clampScale(value: number) {\n  if (Number.isNaN(value)) return 1;\n  return Math.min(3, Math.max(0.5, value));\n}\n\nexport async function getPdfInfo(filePath: string) {\n  const buffer = await fs.readFile(filePath);\n  const data = new Uint8Array(buffer);\n  const task = pdfjsLib.getDocument({ data, disableWorker: true });\n  const pdf = await task.promise;\n  return {\n    pages: pdf.numPages,\n  };\n}\n\nexport async function renderPdfPageToPng(filePath: string, options: RenderOptions) {\n  const stat = await fs.stat(filePath);\n  const scale = clampScale(options.scale);\n  const cacheKey = getCacheKey(filePath, stat, options.page, scale);\n  const cacheDir = path.resolve(config.drive.cacheDir, cacheKey);\n  const cacheFile = path.join(cacheDir, `page-${options.page}.png`);\n\n  if (await fs.pathExists(cacheFile)) {\n    return { cacheFile, fromCache: true };\n  }\n\n  await fs.ensureDir(cacheDir);\n  const buffer = await fs.readFile(filePath);\n  const data = new Uint8Array(buffer);\n  const task = pdfjsLib.getDocument({ data, disableWorker: true });\n  const pdf = await task.promise;\n\n  if (options.page < 1 || options.page > pdf.numPages) {\n    throw new Error('Page out of range');\n  }\n\n  const page = await pdf.getPage(options.page);\n  const viewport = page.getViewport({ scale });\n  const canvas = createCanvas(Math.ceil(viewport.width), Math.ceil(viewport.height));\n  const ctx = canvas.getContext('2d');\n\n  await page.render({ canvasContext: ctx, viewport }).promise;\n  const pngBuffer = canvas.toBuffer('image/png');\n  await fs.writeFile(cacheFile, pngBuffer);\n\n  return { cacheFile, fromCache: false };\n}\n\nexport async function renderPdfPageToPngWithGrid(filePath: string, options: RenderOptions) {\n  const stat = await fs.stat(filePath);\n  const scale = clampScale(options.scale);\n  const gridSize = options.gridSize && options.gridSize > 0 ? options.gridSize : 50;\n  const cacheKey = getCacheKey(filePath, stat, options.page, scale) + `-g${gridSize}`;\n  const cacheDir = path.resolve(config.drive.cacheDir, cacheKey);\n  const cacheFile = path.join(cacheDir, `page-${options.page}-grid.png`);\n\n  if (await fs.pathExists(cacheFile)) {\n    return { cacheFile, fromCache: true };\n  }\n\n  await fs.ensureDir(cacheDir);\n  const buffer = await fs.readFile(filePath);\n  const data = new Uint8Array(buffer);\n  const task = pdfjsLib.getDocument({ data, disableWorker: true });\n  const pdf = await task.promise;\n\n  if (options.page < 1 || options.page > pdf.numPages) {\n    throw new Error('Page out of range');\n  }\n\n  const page = await pdf.getPage(options.page);\n  const viewport = page.getViewport({ scale });\n  const canvas = createCanvas(Math.ceil(viewport.width), Math.ceil(viewport.height));\n  const ctx = canvas.getContext('2d');\n\n  await page.render({ canvasContext: ctx, viewport }).promise;\n\n  const step = gridSize * scale;\n  ctx.strokeStyle = 'rgba(255,0,0,0.35)';\n  ctx.lineWidth = 1;\n  ctx.font = `${Math.max(10, Math.floor(10 * scale))}px Arial`;\n  ctx.fillStyle = 'rgba(255,0,0,0.7)';\n\n  for (let x = 0; x <= canvas.width; x += step) {\n    ctx.beginPath();\n    ctx.moveTo(x, 0);\n    ctx.lineTo(x, canvas.height);\n    ctx.stroke();\n    ctx.fillText(String(Math.round(x / scale)), x + 2, 12);\n  }\n\n  for (let y = 0; y <= canvas.height; y += step) {\n    ctx.beginPath();\n    ctx.moveTo(0, y);\n    ctx.lineTo(canvas.width, y);\n    ctx.stroke();\n    const coord = Math.round((canvas.height - y) / scale);\n    ctx.fillText(String(coord), 2, y - 2);\n  }\n\n  const pngBuffer = canvas.toBuffer('image/png');\n  await fs.writeFile(cacheFile, pngBuffer);\n\n  return { cacheFile, fromCache: false };\n}\n", "import { Router } from 'express';\nimport multer from 'multer';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport {\n  createFolder,\n  deleteEntry,\n  getInfo,\n  listEntries,\n  moveEntry,\n  uploadFile,\n} from '../controllers/drive.controller.js';\nimport {\n  getPdfMetadata,\n  getPdfPageImage,\n  getPdfPagePreviewGrid,\n} from '../controllers/drive-pdf.controller.js';\nimport { config } from '../../config/environment.js';\nimport { requireTenant } from '../../middleware/tenant.middleware.js';\nimport { requireStorageQuota } from '../../middleware/quota.middleware.js';\nimport { uploadRateLimiter } from '../../middleware/company-rate-limiter.middleware.js';\n\nconst router = Router();\nconst MAX_DRIVE_BYTES = 2 * 1024 * 1024 * 1024; // 2GB\nconst tempDir = path.join(config.storage.root, 'temp', 'uploads');\nfs.ensureDirSync(tempDir);\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (_req, _file, cb) => cb(null, tempDir),\n    filename: (_req, file, cb) => {\n      const safeName = `${Date.now()}-${file.originalname}`;\n      cb(null, safeName);\n    },\n  }),\n  limits: { fileSize: MAX_DRIVE_BYTES },\n});\n\n// Multi-tenant routes (require JWT authentication + quotas)\nrouter.get('/list', requireTenant, listEntries);\nrouter.get('/info', requireTenant, getInfo);\nrouter.post('/folders', requireTenant, createFolder);\nrouter.post('/files', requireTenant, uploadRateLimiter, upload.single('file'), requireStorageQuota, uploadFile);\nrouter.delete('/entry', requireTenant, deleteEntry);\nrouter.patch('/move', requireTenant, moveEntry);\nrouter.get('/pdf/info', requireTenant, getPdfMetadata);\nrouter.get('/pdf/page', requireTenant, getPdfPageImage);\nrouter.get('/pdf/preview-grid', requireTenant, getPdfPagePreviewGrid);\n\nexport default router;\n", "import { Request, Response, NextFunction } from 'express';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\nimport { storagePathService } from '../../services/storage-path.service.js';\nimport { incrementStorageUsage, decrementStorageUsage } from '../../middleware/quota.middleware.js';\n\n// Helper: Validar nombre de archivo/folder\nfunction isValidEntryName(name: string) {\n  if (!name) return false;\n  if (name === '.' || name === '..') return false;\n  return !/[\\\\/]/.test(name);\n}\n\nfunction toEntry(relativeBase: string, name: string, stat: fs.Stats, companyId: string) {\n  const relPath = relativeBase ? `${relativeBase}/${name}` : name;\n  const type = stat.isDirectory() ? 'folder' : 'file';\n  const listUrl = type === 'folder' ? `/api/drive/list?path=${encodeURIComponent(relPath)}` : undefined;\n  return {\n    name,\n    path: relPath,\n    type,\n    size: stat.isFile() ? stat.size : undefined,\n    updatedAt: stat.mtime.toISOString(),\n    url: stat.isFile() ? `/files/companies/${companyId}/${relPath}` : undefined,\n    listUrl,\n  };\n}\n\nfunction buildAbsoluteUrl(req: Request, relativeUrl: string) {\n  const host = req.get('host');\n  if (!host) return relativeUrl;\n  const proto = req.protocol;\n  return `${proto}://${host}${relativeUrl}`;\n}\n\nexport async function listEntries(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    // Asegurar estructura de empresa\n    await storagePathService.ensureCompanyStructure(companyId);\n\n    // Resolver ruta dentro del espacio de la empresa\n    const relativePath = (req.query.path as string) || '';\n    const resolved = storagePathService.resolvePath(companyId, relativePath);\n\n    // Validar acceso\n    if (!storagePathService.validateAccess(resolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(resolved);\n    if (!exists) {\n      const error: CustomError = new Error('Path not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const stat = await fs.stat(resolved);\n    if (!stat.isDirectory()) {\n      const error: CustomError = new Error('Path is not a folder');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const entries = (await fs.readdir(resolved)).filter((name) => !name.startsWith('.'));\n    const results = await Promise.all(\n      entries.map(async (name) => {\n        const entryStat = await fs.stat(path.join(resolved, name));\n        const entry = toEntry(relativePath, name, entryStat, companyId);\n        const result: Record<string, unknown> = { ...entry };\n        if (entry.url) {\n          result.urlAbsolute = buildAbsoluteUrl(req, entry.url);\n        }\n        if (entry.listUrl) {\n          result.listUrlAbsolute = buildAbsoluteUrl(req, entry.listUrl);\n        }\n        return result;\n      })\n    );\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        path: relativePath || '',\n        total: results.length,\n        entries: results,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function createFolder(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const { path: parentPath, name } = req.body;\n\n    if (!name || !isValidEntryName(name)) {\n      const error: CustomError = new Error('Invalid folder name');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    // Resolver ruta padre\n    const relativePath = parentPath || '';\n    const resolved = storagePathService.resolvePath(companyId, relativePath);\n\n    // Validar acceso\n    if (!storagePathService.validateAccess(resolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    const parentExists = await fs.pathExists(resolved);\n    if (!parentExists) {\n      const error: CustomError = new Error('Parent path not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const target = path.join(resolved, name);\n\n    // Validar que la carpeta de destino tambi\u00E9n est\u00E9 dentro del espacio de la empresa\n    if (!storagePathService.validateAccess(target, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid target path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    await fs.ensureDir(target);\n\n    const newPath = relativePath ? `${relativePath}/${name}` : name;\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: {\n        name,\n        path: newPath,\n        type: 'folder',\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function uploadFile(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const { path: parentPath } = req.body;\n    const file = req.file;\n\n    if (!file) {\n      const error: CustomError = new Error('file is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    if (!isValidEntryName(file.originalname)) {\n      const error: CustomError = new Error('Invalid file name');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    // Resolver ruta\n    const relativePath = parentPath || '';\n    const resolved = storagePathService.resolvePath(companyId, relativePath);\n\n    // Validar acceso\n    if (!storagePathService.validateAccess(resolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    await fs.ensureDir(resolved);\n\n    const MAX_ORDERS_BYTES = 100 * 1024 * 1024; // 100MB\n    const MAX_DRIVE_BYTES = 2 * 1024 * 1024 * 1024; // 2GB\n    const isDriveRoot = relativePath.startsWith('drive');\n    const maxAllowedBytes = isDriveRoot ? MAX_DRIVE_BYTES : MAX_ORDERS_BYTES;\n    if (file.size > maxAllowedBytes) {\n      await fs.remove(file.path).catch(() => {});\n      const error: CustomError = new Error('File too large');\n      error.statusCode = HTTP_STATUS.REQUEST_TOO_LONG;\n      return next(error);\n    }\n\n    const target = path.join(resolved, file.originalname);\n\n    // Validar acceso al archivo de destino\n    if (!storagePathService.validateAccess(target, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid target path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    await fs.move(file.path, target, { overwrite: true });\n\n    // Incrementar contador de almacenamiento (Fase 10)\n    await incrementStorageUsage(companyId, file.size);\n\n    const filePath = relativePath ? `${relativePath}/${file.originalname}` : file.originalname;\n    const publicUrl = `/files/companies/${companyId}/${filePath}`;\n\n    res.status(HTTP_STATUS.CREATED).json({\n      success: true,\n      data: {\n        name: file.originalname,\n        path: filePath,\n        type: 'file',\n        size: file.size,\n        url: publicUrl,\n        urlAbsolute: buildAbsoluteUrl(req, publicUrl),\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function deleteEntry(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const targetPath = req.query.path as string;\n\n    if (!targetPath) {\n      const error: CustomError = new Error('path is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const resolved = storagePathService.resolvePath(companyId, targetPath);\n\n    // Validar acceso\n    if (!storagePathService.validateAccess(resolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(resolved);\n    if (!exists) {\n      const error: CustomError = new Error('Path not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    // Obtener stats antes de eliminar (Fase 10)\n    const stats = await fs.stat(resolved);\n    const isFile = stats.isFile();\n    const fileSize = isFile ? stats.size : 0;\n\n    await fs.remove(resolved);\n\n    // Decrementar contador de almacenamiento si es un archivo (Fase 10)\n    if (isFile && fileSize > 0) {\n      await decrementStorageUsage(companyId, fileSize);\n    }\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      message: 'Entry deleted',\n      data: {\n        path: targetPath,\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function moveEntry(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const { from, to } = req.body;\n\n    if (!from || !to) {\n      const error: CustomError = new Error('from and to are required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const fromResolved = storagePathService.resolvePath(companyId, from);\n    const toResolved = storagePathService.resolvePath(companyId, to);\n\n    // Validar acceso a ambas rutas\n    if (!storagePathService.validateAccess(fromResolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid source path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    if (!storagePathService.validateAccess(toResolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid destination path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(fromResolved);\n    if (!exists) {\n      const error: CustomError = new Error('Source not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    await fs.ensureDir(path.dirname(toResolved));\n    await fs.move(fromResolved, toResolved, { overwrite: false });\n\n    const publicUrl = `/files/companies/${companyId}/${to}`;\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        from,\n        to,\n        url: publicUrl,\n        urlAbsolute: buildAbsoluteUrl(req, publicUrl),\n      },\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n\nexport async function getInfo(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const targetPath = req.query.path as string;\n\n    if (!targetPath) {\n      const error: CustomError = new Error('path is required');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const resolved = storagePathService.resolvePath(companyId, targetPath);\n\n    // Validar acceso\n    if (!storagePathService.validateAccess(resolved, companyId)) {\n      const error: CustomError = new Error('Access denied: invalid path');\n      error.statusCode = HTTP_STATUS.FORBIDDEN;\n      return next(error);\n    }\n\n    const stat = await fs.stat(resolved);\n    const name = path.basename(resolved);\n\n    const parent = path.dirname(targetPath).replace(/\\\\/g, '/');\n    const base = parent === '.' ? '' : parent;\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: (() => {\n        const entry = toEntry(base, name, stat, companyId);\n        const result: Record<string, unknown> = { ...entry };\n        if (entry.url) {\n          result.urlAbsolute = buildAbsoluteUrl(req, entry.url);\n        }\n        if (entry.listUrl) {\n          result.listUrlAbsolute = buildAbsoluteUrl(req, entry.listUrl);\n        }\n        return result;\n      })(),\n    });\n  } catch (error) {\n    next(error);\n  }\n}\n", "/**\n * StoragePathService - Multi-Tenant Path Management\n *\n * Servicio centralizado para gestionar rutas de almacenamiento multi-tenant.\n * Estructura: /mnt/constroad-storage/companies/{companyId}/{module}/{subpath}\n *\n * Fase 9: Multi-Tenant Portal Transformation\n *\n * @example\n * ```typescript\n * const service = new StoragePathService();\n *\n * // Obtener ruta de empresa\n * const companyRoot = service.getCompanyRoot('company-123');\n * // => /mnt/constroad-storage/companies/company-123\n *\n * // Obtener ruta de m\u00F3dulo\n * const modulePath = service.getModulePath('company-123', 'orders', 'dispatches');\n * // => /mnt/constroad-storage/companies/company-123/orders/dispatches\n *\n * // Validar acceso\n * const isValid = service.validateAccess(requestedPath, 'company-123');\n * ```\n */\n\nimport path from 'path';\nimport fs from 'fs-extra';\nimport { config } from '../config/environment.js';\nimport logger from '../utils/logger.js';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface StorageModule {\n  name: string;\n  description: string;\n  autoCreate: boolean;\n}\n\nexport interface CompanyStorageStructure {\n  companyId: string;\n  root: string;\n  modules: {\n    orders: string;\n    dispatches: string;\n    clients: string;\n    certificates: string;\n    reports: string;\n    media: string;\n    temp: string;\n  };\n}\n\n// ============================================================================\n// SERVICE\n// ============================================================================\n\nexport class StoragePathService {\n  private readonly root: string;\n\n  /**\n   * M\u00F3dulos est\u00E1ndar que se crean autom\u00E1ticamente para cada empresa\n   */\n  private readonly standardModules: StorageModule[] = [\n    { name: 'orders', description: 'Pedidos y obras', autoCreate: true },\n    { name: 'dispatches', description: 'Despachos y vales', autoCreate: true },\n    { name: 'clients', description: 'Documentos de clientes', autoCreate: true },\n    { name: 'certificates', description: 'Certificados de calidad', autoCreate: true },\n    { name: 'reports', description: 'Reportes y an\u00E1lisis', autoCreate: true },\n    { name: 'media', description: 'Archivos multimedia', autoCreate: true },\n    { name: 'temp', description: 'Archivos temporales', autoCreate: true },\n  ];\n\n  constructor() {\n    this.root = config.storage.root;\n    logger.info(`StoragePathService initialized with root: ${this.root}`);\n  }\n\n  // ==========================================================================\n  // PATH BUILDERS\n  // ==========================================================================\n\n  /**\n   * Obtiene la ruta ra\u00EDz de una empresa\n   * @param companyId ID de la empresa\n   * @returns Ruta absoluta a la carpeta de la empresa\n   */\n  getCompanyRoot(companyId: string): string {\n    if (!companyId || companyId.trim() === '') {\n      throw new Error('companyId is required');\n    }\n\n    return path.join(this.root, 'companies', companyId);\n  }\n\n  /**\n   * Obtiene la ruta de un m\u00F3dulo espec\u00EDfico para una empresa\n   * @param companyId ID de la empresa\n   * @param module Nombre del m\u00F3dulo (orders, dispatches, clients, etc.)\n   * @param subpath Subruta opcional dentro del m\u00F3dulo\n   * @returns Ruta absoluta al m\u00F3dulo o subruta\n   */\n  getModulePath(companyId: string, module: string, subpath?: string): string {\n    const root = this.getCompanyRoot(companyId);\n    const modulePath = path.join(root, module);\n\n    if (subpath) {\n      return path.join(modulePath, subpath);\n    }\n\n    return modulePath;\n  }\n\n  /**\n   * Obtiene la estructura completa de carpetas para una empresa\n   * @param companyId ID de la empresa\n   * @returns Objeto con todas las rutas de m\u00F3dulos\n   */\n  getCompanyStructure(companyId: string): CompanyStorageStructure {\n    const root = this.getCompanyRoot(companyId);\n\n    return {\n      companyId,\n      root,\n      modules: {\n        orders: path.join(root, 'orders'),\n        dispatches: path.join(root, 'dispatches'),\n        clients: path.join(root, 'clients'),\n        certificates: path.join(root, 'certificates'),\n        reports: path.join(root, 'reports'),\n        media: path.join(root, 'media'),\n        temp: path.join(root, 'temp'),\n      },\n    };\n  }\n\n  /**\n   * Resuelve una ruta relativa a una ruta absoluta dentro de una empresa\n   * @param companyId ID de la empresa\n   * @param relativePath Ruta relativa proporcionada por el usuario\n   * @returns Ruta absoluta resuelta\n   */\n  resolvePath(companyId: string, relativePath: string): string {\n    const companyRoot = this.getCompanyRoot(companyId);\n\n    // Normalizar la ruta relativa (eliminar ../, ./, etc.)\n    const normalized = path.normalize(relativePath);\n\n    // Unir con la ra\u00EDz de la empresa\n    const resolved = path.join(companyRoot, normalized);\n\n    return resolved;\n  }\n\n  // ==========================================================================\n  // VALIDATION\n  // ==========================================================================\n\n  /**\n   * Valida que una ruta est\u00E9 dentro del espacio permitido para una empresa\n   * Previene path traversal attacks (../, etc.)\n   * @param requestedPath Ruta que se quiere acceder\n   * @param companyId ID de la empresa\n   * @returns true si el acceso es v\u00E1lido, false si no\n   */\n  validateAccess(requestedPath: string, companyId: string): boolean {\n    try {\n      const companyRoot = this.getCompanyRoot(companyId);\n\n      // Normalizar ambas rutas\n      const normalizedRequested = path.normalize(requestedPath);\n      const normalizedRoot = path.normalize(companyRoot);\n\n      // Verificar que la ruta solicitada comience con la ra\u00EDz de la empresa\n      const isWithinCompanyRoot = normalizedRequested.startsWith(normalizedRoot);\n\n      if (!isWithinCompanyRoot) {\n        logger.warn('Path validation failed: outside company root', {\n          companyId,\n          requestedPath: normalizedRequested,\n          companyRoot: normalizedRoot,\n        });\n        return false;\n      }\n\n      // Verificar que no haya intentos de escapar con path traversal\n      const relative = path.relative(normalizedRoot, normalizedRequested);\n      const hasTraversal = relative.startsWith('..') || path.isAbsolute(relative);\n\n      if (hasTraversal) {\n        logger.warn('Path validation failed: traversal attempt detected', {\n          companyId,\n          requestedPath: normalizedRequested,\n          relative,\n        });\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      logger.error('Path validation error:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Valida que un m\u00F3dulo sea v\u00E1lido\n   * @param moduleName Nombre del m\u00F3dulo\n   * @returns true si es un m\u00F3dulo est\u00E1ndar\n   */\n  isValidModule(moduleName: string): boolean {\n    return this.standardModules.some((m) => m.name === moduleName);\n  }\n\n  // ==========================================================================\n  // DIRECTORY MANAGEMENT\n  // ==========================================================================\n\n  /**\n   * Crea la estructura de carpetas completa para una empresa\n   * @param companyId ID de la empresa\n   * @returns Promise que se resuelve cuando se crea la estructura\n   */\n  async ensureCompanyStructure(companyId: string): Promise<CompanyStorageStructure> {\n    const structure = this.getCompanyStructure(companyId);\n\n    logger.info(`Creating company storage structure for: ${companyId}`);\n\n    try {\n      // Crear carpeta ra\u00EDz de la empresa\n      await fs.ensureDir(structure.root);\n\n      // Crear todas las carpetas de m\u00F3dulos\n      const moduleCreations = this.standardModules\n        .filter((m) => m.autoCreate)\n        .map(async (module) => {\n          const modulePath = path.join(structure.root, module.name);\n          await fs.ensureDir(modulePath);\n          logger.debug(`Created module folder: ${module.name}`, { companyId });\n        });\n\n      await Promise.all(moduleCreations);\n\n      logger.info(`Company storage structure created successfully for: ${companyId}`);\n\n      return structure;\n    } catch (error) {\n      logger.error(`Failed to create company storage structure for: ${companyId}`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Verifica si la estructura de una empresa existe\n   * @param companyId ID de la empresa\n   * @returns true si existe la carpeta ra\u00EDz\n   */\n  async companyStructureExists(companyId: string): Promise<boolean> {\n    const root = this.getCompanyRoot(companyId);\n    return fs.pathExists(root);\n  }\n\n  /**\n   * Asegura que un directorio exista, cre\u00E1ndolo si es necesario\n   * Solo si est\u00E1 dentro del espacio de la empresa\n   * @param dirPath Ruta del directorio\n   * @param companyId ID de la empresa\n   */\n  async ensureDir(dirPath: string, companyId: string): Promise<void> {\n    // Validar que la ruta est\u00E9 dentro del espacio de la empresa\n    if (!this.validateAccess(dirPath, companyId)) {\n      throw new Error('Invalid path: outside company storage space');\n    }\n\n    await fs.ensureDir(dirPath);\n  }\n\n  // ==========================================================================\n  // UTILITIES\n  // ==========================================================================\n\n  /**\n   * Obtiene informaci\u00F3n de uso de almacenamiento para una empresa\n   * @param companyId ID de la empresa\n   * @returns Tama\u00F1o total en bytes\n   */\n  async getStorageUsage(companyId: string): Promise<number> {\n    const root = this.getCompanyRoot(companyId);\n\n    if (!(await fs.pathExists(root))) {\n      return 0;\n    }\n\n    try {\n      const calculateSize = async (dir: string): Promise<number> => {\n        const entries = await fs.readdir(dir, { withFileTypes: true });\n        let totalSize = 0;\n\n        for (const entry of entries) {\n          const fullPath = path.join(dir, entry.name);\n\n          if (entry.isDirectory()) {\n            totalSize += await calculateSize(fullPath);\n          } else {\n            const stats = await fs.stat(fullPath);\n            totalSize += stats.size;\n          }\n        }\n\n        return totalSize;\n      };\n\n      return await calculateSize(root);\n    } catch (error) {\n      logger.error(`Failed to calculate storage usage for: ${companyId}`, error);\n      return 0;\n    }\n  }\n\n  /**\n   * Convierte bytes a formato legible\n   * @param bytes Tama\u00F1o en bytes\n   * @returns String formateado (ej: \"1.5 GB\")\n   */\n  formatBytes(bytes: number): string {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;\n  }\n\n  /**\n   * Limpia archivos temporales de una empresa\n   * @param companyId ID de la empresa\n   */\n  async cleanTempFiles(companyId: string): Promise<void> {\n    const tempPath = this.getModulePath(companyId, 'temp');\n\n    if (await fs.pathExists(tempPath)) {\n      await fs.emptyDir(tempPath);\n      logger.info(`Cleaned temp files for company: ${companyId}`);\n    }\n  }\n}\n\n// ============================================================================\n// SINGLETON INSTANCE\n// ============================================================================\n\nexport const storagePathService = new StoragePathService();\nexport default storagePathService;\n", "import { Request, Response, NextFunction } from 'express';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport { HTTP_STATUS } from '../../config/constants.js';\nimport { CustomError } from '../middlewares/errorHandler.js';\nimport { storagePathService } from '../../services/storage-path.service.js';\nimport {\n  getPdfInfo,\n  renderPdfPageToPng,\n  renderPdfPageToPngWithGrid,\n} from '../../pdf/render.service.js';\n\nfunction getPdfPathFromRequest(req: Request) {\n  const companyId = req.companyId;\n  if (!companyId) {\n    throw new Error('Company ID is required');\n  }\n\n  const { path: pathParam } = req.query as { path?: string };\n\n  if (!pathParam) {\n    throw new Error('path is required');\n  }\n\n  const resolved = storagePathService.resolvePath(companyId, pathParam);\n\n  if (!storagePathService.validateAccess(resolved, companyId)) {\n    throw new Error('Access denied: invalid path');\n  }\n\n  return { resolved, normalized: pathParam };\n}\n\nfunction ensurePdfExtension(filePath: string) {\n  return path.extname(filePath).toLowerCase() === '.pdf';\n}\n\nfunction decodePath(value: string) {\n  let decoded = value;\n  for (let i = 0; i < 2; i += 1) {\n    try {\n      const next = decodeURIComponent(decoded);\n      if (next === decoded) break;\n      decoded = next;\n    } catch {\n      break;\n    }\n  }\n  return decoded;\n}\n\nasync function resolveExistingPdfPath(\n  resolved: string,\n  normalized: string,\n  companyId: string\n) {\n  if (await fs.pathExists(resolved)) {\n    return { resolved, normalized };\n  }\n\n  const candidates = [normalized.normalize('NFC'), normalized.normalize('NFD')].filter(\n    (candidate, index, arr) => candidate && arr.indexOf(candidate) === index\n  );\n\n  for (const candidate of candidates) {\n    const altResolved = storagePathService.resolvePath(companyId, candidate);\n    if (await fs.pathExists(altResolved)) {\n      return { resolved: altResolved, normalized: candidate };\n    }\n  }\n\n  return { resolved, normalized };\n}\n\nexport async function getPdfMetadata(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const initial = getPdfPathFromRequest(req);\n    const { resolved, normalized } = await resolveExistingPdfPath(\n      initial.resolved,\n      initial.normalized,\n      companyId\n    );\n\n    if (!normalized || !ensurePdfExtension(resolved)) {\n      const error: CustomError = new Error('Only PDF files are allowed');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(resolved);\n    if (!exists) {\n      const error: CustomError = new Error('File not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const info = await getPdfInfo(resolved);\n\n    res.status(HTTP_STATUS.OK).json({\n      success: true,\n      data: {\n        path: normalized,\n        pages: info.pages,\n      },\n    });\n  } catch (error) {\n    const err: CustomError = error instanceof Error ? error : new Error('Invalid request');\n    if (!err.statusCode) {\n      err.statusCode = HTTP_STATUS.BAD_REQUEST;\n    }\n    next(err);\n  }\n}\n\nexport async function getPdfPageImage(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const initial = getPdfPathFromRequest(req);\n    const { resolved, normalized } = await resolveExistingPdfPath(\n      initial.resolved,\n      initial.normalized,\n      companyId\n    );\n    const page = parseInt(String(req.query.page || '1'), 10);\n    const scale = parseFloat(String(req.query.scale || '1.5'));\n\n    if (!normalized || !ensurePdfExtension(resolved)) {\n      const error: CustomError = new Error('Only PDF files are allowed');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(resolved);\n    if (!exists) {\n      const error: CustomError = new Error('File not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const { cacheFile } = await renderPdfPageToPng(resolved, { page, scale });\n    res.setHeader('Cache-Control', 'public, max-age=3600, immutable');\n    res.setHeader('Content-Type', 'image/png');\n    res.setHeader('X-PDF-Path', normalized);\n    res.setHeader('X-PDF-Page', String(page));\n    res.status(HTTP_STATUS.OK).sendFile(path.resolve(cacheFile));\n  } catch (error) {\n    const err: CustomError = error instanceof Error ? error : new Error('Invalid request');\n    if (!err.statusCode) {\n      err.statusCode = HTTP_STATUS.BAD_REQUEST;\n    }\n    next(err);\n  }\n}\n\nexport async function getPdfPagePreviewGrid(req: Request, res: Response, next: NextFunction) {\n  try {\n    const companyId = req.companyId;\n    if (!companyId) {\n      const error: CustomError = new Error('Company ID is required');\n      error.statusCode = HTTP_STATUS.UNAUTHORIZED;\n      return next(error);\n    }\n\n    const initial = getPdfPathFromRequest(req);\n    const { resolved, normalized } = await resolveExistingPdfPath(\n      initial.resolved,\n      initial.normalized,\n      companyId\n    );\n    const page = parseInt(String(req.query.page || '1'), 10);\n    const scale = parseFloat(String(req.query.scale || '1.5'));\n    const gridSize = parseInt(String(req.query.grid || '50'), 10);\n\n    if (!normalized || !ensurePdfExtension(resolved)) {\n      const error: CustomError = new Error('Only PDF files are allowed');\n      error.statusCode = HTTP_STATUS.BAD_REQUEST;\n      return next(error);\n    }\n\n    const exists = await fs.pathExists(resolved);\n    if (!exists) {\n      const error: CustomError = new Error('File not found');\n      error.statusCode = HTTP_STATUS.NOT_FOUND;\n      return next(error);\n    }\n\n    const { cacheFile } = await renderPdfPageToPngWithGrid(resolved, {\n      page,\n      scale,\n      gridSize,\n    });\n    res.setHeader('Cache-Control', 'public, max-age=3600, immutable');\n    res.setHeader('Content-Type', 'image/png');\n    res.setHeader('X-PDF-Path', normalized);\n    res.setHeader('X-PDF-Page', String(page));\n    res.status(HTTP_STATUS.OK).sendFile(path.resolve(cacheFile));\n  } catch (error) {\n    const err: CustomError = error instanceof Error ? error : new Error('Invalid request');\n    if (!err.statusCode) {\n      err.statusCode = HTTP_STATUS.BAD_REQUEST;\n    }\n    next(err);\n  }\n}\n", "export const openApiSpec = {\n  openapi: '3.0.3',\n  info: {\n    title: 'WhatsApp API v2',\n    version: '2.0.0',\n    description: 'API para sesiones, mensajeria, jobs, PDFs y almacenamiento multi-tenant.',\n  },\n  servers: [\n    {\n      url: '/',\n    },\n  ],\n  tags: [\n    { name: 'Session', description: 'Sesiones de WhatsApp' },\n    { name: 'WhatsApp', description: 'Envio de mensajes y archivos' },\n    { name: 'Messages', description: 'Historial de conversaciones' },\n    { name: 'Jobs', description: 'Cron jobs' },\n    { name: 'PDF', description: 'Generacion de PDFs y templates' },\n    { name: 'Drive', description: 'Almacenamiento multi-tenant (requiere JWT con companyId)' },\n    { name: 'System', description: 'Health y estado del servidor' },\n  ],\n  components: {\n    securitySchemes: {\n      bearerAuth: {\n        type: 'http',\n        scheme: 'bearer',\n        bearerFormat: 'JWT',\n        description: 'JWT token con companyId en el payload. Formato: Authorization: Bearer {token}',\n      },\n    },\n    schemas: {\n      Error: {\n        type: 'object',\n        properties: {\n          success: { type: 'boolean', example: false },\n          error: {\n            type: 'object',\n            properties: {\n              message: { type: 'string' },\n              statusCode: { type: 'number' },\n            },\n          },\n        },\n      },\n      DriveEntry: {\n        type: 'object',\n        properties: {\n          name: { type: 'string', description: 'Nombre del archivo o carpeta' },\n          path: { type: 'string', description: 'Ruta relativa' },\n          type: { type: 'string', enum: ['file', 'folder'] },\n          size: { type: 'number', description: 'Tama\u00F1o en bytes (solo archivos)' },\n          updatedAt: { type: 'string', format: 'date-time' },\n          url: { type: 'string', description: 'URL publica (solo archivos)' },\n          listUrl: { type: 'string', description: 'URL para listar (solo carpetas)' },\n        },\n      },\n    },\n  },\n  paths: {\n    '/health': {\n      get: {\n        tags: ['System'],\n        summary: 'Health check',\n        responses: {\n          200: {\n            description: 'Servidor activo',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    message: { type: 'string' },\n                    timestamp: { type: 'string', format: 'date-time' },\n                    environment: { type: 'string' },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/status': {\n      get: {\n        tags: ['System'],\n        summary: 'Estado del servidor y sesiones activas',\n        responses: {\n          200: {\n            description: 'Estado del sistema',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        activeSessions: { type: 'number' },\n                        nodeEnv: { type: 'string' },\n                        timestamp: { type: 'string', format: 'date-time' },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/sessions': {\n      post: {\n        tags: ['Session'],\n        summary: 'Crear nueva sesion WhatsApp',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['phoneNumber'],\n                properties: {\n                  phoneNumber: {\n                    type: 'string',\n                    description: 'Numero en formato internacional (ej. 51999999999)',\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: {\n            description: 'Sesion creada',\n          },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n      get: {\n        tags: ['Session'],\n        summary: 'Obtener todas las sesiones',\n        responses: {\n          200: { description: 'Listado de sesiones' },\n        },\n      },\n    },\n    '/api/sessions/list': {\n      get: {\n        tags: ['Session'],\n        summary: 'Listar sesiones activas',\n        responses: {\n          200: {\n            description: 'Listado de sesiones',\n          },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/qr': {\n      get: {\n        tags: ['Session'],\n        summary: 'Obtener QR como imagen PNG',\n        description: 'Usa ?format=json para recibir el QR como data URL.',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n          {\n            name: 'format',\n            in: 'query',\n            required: false,\n            schema: { type: 'string', enum: ['json'] },\n            description: 'Devuelve el QR como data URL en JSON',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'QR en PNG',\n            content: {\n              'image/png': {\n                schema: { type: 'string', format: 'binary' },\n              },\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        qr: { type: 'string' },\n                        qrImage: { type: 'string' },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          404: { description: 'QR no disponible' },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/status': {\n      get: {\n        tags: ['Session'],\n        summary: 'Estado de sesion WhatsApp',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: { description: 'Estado de sesion' },\n          400: { description: 'Numero invalido' },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/logout': {\n      post: {\n        tags: ['Session'],\n        summary: 'Cerrar sesion activa',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: { description: 'Sesion cerrada' },\n          400: { description: 'Numero invalido' },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/groups': {\n      get: {\n        tags: ['Session'],\n        summary: 'Listar grupos de WhatsApp',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Listado de grupos',\n            content: {\n              'application/json': {\n                schema: { type: 'array', items: { type: 'object' } },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/syncGroups': {\n      get: {\n        tags: ['Session'],\n        summary: 'Sincronizar grupos de WhatsApp',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Listado de grupos',\n            content: {\n              'application/json': {\n                schema: { type: 'array', items: { type: 'object' } },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}/contacts': {\n      get: {\n        tags: ['Session'],\n        summary: 'Listar contactos de WhatsApp',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Listado de contactos',\n            content: {\n              'application/json': {\n                schema: { type: 'array', items: { type: 'object' } },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/sessions/{phoneNumber}': {\n      delete: {\n        tags: ['Session'],\n        summary: 'Desconectar sesion WhatsApp',\n        parameters: [\n          {\n            name: 'phoneNumber',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        responses: {\n          200: { description: 'Sesion desconectada' },\n          400: { description: 'Numero invalido' },\n        },\n      },\n    },\n    '/api/message': {\n      post: {\n        tags: ['WhatsApp'],\n        summary: 'Enviar mensaje de texto (legacy)',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['sessionPhone', 'chatId', 'message'],\n                properties: {\n                  sessionPhone: { type: 'string' },\n                  chatId: { type: 'string' },\n                  message: { type: 'string' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Mensaje enviado' },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}/text': {\n      post: {\n        tags: ['WhatsApp'],\n        summary: 'Enviar mensaje de texto',\n        parameters: [\n          {\n            name: 'sessionPhone',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['to', 'message'],\n                properties: {\n                  to: {\n                    type: 'string',\n                    description: 'Numero destino o JID (ej. 51999999999 o 51999999999@s.whatsapp.net)',\n                  },\n                  message: { type: 'string' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Mensaje enviado' },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}/image': {\n      post: {\n        tags: ['WhatsApp'],\n        summary: 'Enviar imagen',\n        parameters: [\n          {\n            name: 'sessionPhone',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        requestBody: {\n          required: true,\n          content: {\n            'multipart/form-data': {\n              schema: {\n                type: 'object',\n                required: ['file', 'to'],\n                properties: {\n                  file: { type: 'string', format: 'binary' },\n                  to: { type: 'string' },\n                  caption: { type: 'string' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Imagen enviada' },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}/video': {\n      post: {\n        tags: ['WhatsApp'],\n        summary: 'Enviar video',\n        parameters: [\n          {\n            name: 'sessionPhone',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        requestBody: {\n          required: true,\n          content: {\n            'multipart/form-data': {\n              schema: {\n                type: 'object',\n                required: ['file', 'to'],\n                properties: {\n                  file: { type: 'string', format: 'binary' },\n                  to: { type: 'string' },\n                  caption: { type: 'string' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Video enviado' },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}/file': {\n      post: {\n        tags: ['WhatsApp'],\n        summary: 'Enviar archivo',\n        parameters: [\n          {\n            name: 'sessionPhone',\n            in: 'path',\n            required: true,\n            schema: { type: 'string' },\n          },\n        ],\n        requestBody: {\n          required: true,\n          content: {\n            'multipart/form-data': {\n              schema: {\n                type: 'object',\n                required: ['file', 'to'],\n                properties: {\n                  file: { type: 'string', format: 'binary' },\n                  to: { type: 'string' },\n                  caption: { type: 'string' },\n                  mimeType: {\n                    type: 'string',\n                    description: 'Opcional, se detecta por extension si no se envia',\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Archivo enviado' },\n          400: { description: 'Datos invalidos' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}/{chatId}': {\n      get: {\n        tags: ['Messages'],\n        summary: 'Obtener conversacion',\n        parameters: [\n          { name: 'sessionPhone', in: 'path', required: true, schema: { type: 'string' } },\n          { name: 'chatId', in: 'path', required: true, schema: { type: 'string' } },\n        ],\n        responses: {\n          200: { description: 'Conversacion' },\n          404: { description: 'No encontrada' },\n        },\n      },\n      delete: {\n        tags: ['Messages'],\n        summary: 'Cerrar conversacion',\n        parameters: [\n          { name: 'sessionPhone', in: 'path', required: true, schema: { type: 'string' } },\n          { name: 'chatId', in: 'path', required: true, schema: { type: 'string' } },\n        ],\n        responses: {\n          200: { description: 'Conversacion cerrada' },\n        },\n      },\n    },\n    '/api/message/{sessionPhone}': {\n      get: {\n        tags: ['Messages'],\n        summary: 'Listar conversaciones de sesion',\n        parameters: [\n          { name: 'sessionPhone', in: 'path', required: true, schema: { type: 'string' } },\n        ],\n        responses: {\n          200: { description: 'Listado de conversaciones' },\n        },\n      },\n    },\n    '/api/jobs': {\n      post: {\n        tags: ['Jobs'],\n        summary: 'Crear cron job',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['name', 'cronExpression', 'company', 'isActive'],\n                properties: {\n                  name: { type: 'string' },\n                  type: { type: 'string', enum: ['api', 'message'] },\n                  url: { type: 'string' },\n                  message: {\n                    type: 'object',\n                    properties: {\n                      sender: { type: 'string' },\n                      chatId: { type: 'string' },\n                      body: { type: 'string' },\n                    },\n                  },\n                  cronExpression: { type: 'string' },\n                  company: { type: 'string', enum: ['constroad', 'altavia'] },\n                  isActive: { type: 'boolean' },\n                  timeout: { type: 'number' },\n                  retryPolicy: {\n                    type: 'object',\n                    properties: {\n                      maxRetries: { type: 'number' },\n                      backoffMultiplier: { type: 'number' },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: { description: 'Job creado' },\n        },\n      },\n      get: {\n        tags: ['Jobs'],\n        summary: 'Listar cron jobs',\n        parameters: [\n          {\n            name: 'company',\n            in: 'query',\n            required: false,\n            schema: { type: 'string', enum: ['constroad', 'altavia'] },\n            description: 'Filtrar jobs por empresa',\n          },\n        ],\n        responses: {\n          200: { description: 'Listado de jobs' },\n        },\n      },\n    },\n    '/api/jobs/{id}': {\n      get: {\n        tags: ['Jobs'],\n        summary: 'Obtener job por ID',\n        parameters: [{ name: 'id', in: 'path', required: true, schema: { type: 'string' } }],\n        responses: {\n          200: { description: 'Job encontrado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n      patch: {\n        tags: ['Jobs'],\n        summary: 'Actualizar cron job',\n        parameters: [{ name: 'id', in: 'path', required: true, schema: { type: 'string' } }],\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                properties: {\n                  name: { type: 'string' },\n                  url: { type: 'string' },\n                  type: { type: 'string', enum: ['api', 'message'] },\n                  message: {\n                    type: 'object',\n                    properties: {\n                      sender: { type: 'string' },\n                      chatId: { type: 'string' },\n                      body: { type: 'string' },\n                    },\n                  },\n                  cronExpression: { type: 'string' },\n                  company: { type: 'string', enum: ['constroad', 'altavia'] },\n                  isActive: { type: 'boolean' },\n                  timeout: { type: 'number' },\n                  retryPolicy: {\n                    type: 'object',\n                    properties: {\n                      maxRetries: { type: 'number' },\n                      backoffMultiplier: { type: 'number' },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Job actualizado' },\n        },\n      },\n      put: {\n        tags: ['Jobs'],\n        summary: 'Actualizar cron job (PUT)',\n        parameters: [{ name: 'id', in: 'path', required: true, schema: { type: 'string' } }],\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                properties: {\n                  name: { type: 'string' },\n                  url: { type: 'string' },\n                  type: { type: 'string', enum: ['api', 'message'] },\n                  message: {\n                    type: 'object',\n                    properties: {\n                      sender: { type: 'string' },\n                      chatId: { type: 'string' },\n                      body: { type: 'string' },\n                    },\n                  },\n                  cronExpression: { type: 'string' },\n                  company: { type: 'string', enum: ['constroad', 'altavia'] },\n                  isActive: { type: 'boolean' },\n                  timeout: { type: 'number' },\n                  retryPolicy: {\n                    type: 'object',\n                    properties: {\n                      maxRetries: { type: 'number' },\n                      backoffMultiplier: { type: 'number' },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: { description: 'Job actualizado' },\n        },\n      },\n      delete: {\n        tags: ['Jobs'],\n        summary: 'Eliminar cron job',\n        parameters: [{ name: 'id', in: 'path', required: true, schema: { type: 'string' } }],\n        responses: {\n          200: { description: 'Job eliminado' },\n        },\n      },\n    },\n    '/api/jobs/{id}/run': {\n      post: {\n        tags: ['Jobs'],\n        summary: 'Ejecutar job inmediatamente',\n        parameters: [{ name: 'id', in: 'path', required: true, schema: { type: 'string' } }],\n        responses: {\n          200: { description: 'Job ejecutado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n    '/api/pdf/generate': {\n      post: {\n        tags: ['PDF'],\n        summary: 'Generar PDF desde template',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['templateId', 'data'],\n                properties: {\n                  templateId: { type: 'string' },\n                  data: { type: 'object' },\n                  filename: { type: 'string' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: { description: 'PDF generado' },\n        },\n      },\n    },\n    '/api/pdf/templates': {\n      post: {\n        tags: ['PDF'],\n        summary: 'Crear template',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                properties: {\n                  id: { type: 'string' },\n                  name: { type: 'string' },\n                  htmlContent: { type: 'string' },\n                },\n                required: ['id', 'name', 'htmlContent'],\n              },\n            },\n          },\n        },\n        responses: {\n          201: { description: 'Template creado' },\n        },\n      },\n      get: {\n        tags: ['PDF'],\n        summary: 'Listar templates',\n        responses: {\n          200: { description: 'Listado de templates' },\n        },\n      },\n    },\n    '/api/pdf/templates/{templateId}': {\n      delete: {\n        tags: ['PDF'],\n        summary: 'Eliminar template',\n        parameters: [\n          { name: 'templateId', in: 'path', required: true, schema: { type: 'string' } },\n        ],\n        responses: {\n          200: { description: 'Template eliminado' },\n        },\n      },\n    },\n    '/api/pdf/generate-vale': {\n      post: {\n        tags: ['PDF'],\n        summary: 'Generar vale desde template PDF',\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['fields'],\n                properties: {\n                  template: {\n                    type: 'string',\n                    description: 'Nombre del template PDF en templates/pdf',\n                    example: 'plantilla_dispatch_note.pdf',\n                  },\n                  fields: {\n                    type: 'object',\n                    required: [\n                      'senores',\n                      'obra',\n                      'tipoMaterial',\n                      'nroM3',\n                      'placa',\n                      'chofer',\n                      'hora',\n                      'fecha',\n                    ],\n                    properties: {\n                      nroVale: { type: 'string' },\n                      fecha: { type: 'string' },\n                      senores: { type: 'string' },\n                      obra: { type: 'string' },\n                      tipoMaterial: { type: 'string' },\n                      nroM3: { type: 'string' },\n                      placa: { type: 'string' },\n                      chofer: { type: 'string' },\n                      hora: { type: 'string' },\n                      nota: { type: 'string' },\n                    },\n                  },\n                  coords: {\n                    type: 'object',\n                    description: 'Coordenadas opcionales por campo',\n                  },\n                  notify: {\n                    type: 'object',\n                    description: 'Notificaciones opcionales',\n                    properties: {\n                      whatsapp: {\n                        type: 'object',\n                        properties: {\n                          from: {\n                            type: 'string',\n                            description: 'Session phone a usar para enviar',\n                          },\n                          to: {\n                            type: 'string',\n                            description:\n                              'Numero o group id (ej. 51999999999 o 12345-67890)',\n                          },\n                          caption: { type: 'string' },\n                        },\n                      },\n                      telegram: {\n                        type: 'object',\n                        properties: {\n                          chatId: {\n                            type: 'string',\n                            description: 'Chat ID o username',\n                          },\n                          caption: { type: 'string' },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: { description: 'PDF generado' },\n        },\n      },\n    },\n    '/api/pdf/templates/preview-grid': {\n      get: {\n        tags: ['PDF'],\n        summary: 'Preview de template PDF con grilla',\n        parameters: [\n          {\n            name: 'template',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'Nombre del template PDF',\n          },\n          {\n            name: 'page',\n            in: 'query',\n            required: true,\n            schema: { type: 'integer', minimum: 1 },\n          },\n          {\n            name: 'scale',\n            in: 'query',\n            required: false,\n            schema: { type: 'number', default: 1.5 },\n          },\n          {\n            name: 'grid',\n            in: 'query',\n            required: false,\n            schema: { type: 'integer', default: 50 },\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Imagen PNG con grilla',\n            content: {\n              'image/png': {\n                schema: { type: 'string', format: 'binary' },\n              },\n            },\n          },\n        },\n      },\n    },\n    '/api/drive/list': {\n      get: {\n        tags: ['Drive'],\n        summary: 'Listar archivos y carpetas (Multi-tenant)',\n        description: 'Lista el contenido de una carpeta dentro del espacio de almacenamiento de la empresa. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'path',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'Ruta relativa dentro del espacio de la empresa (ej: orders/project-1)',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Listado de contenido',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        path: { type: 'string' },\n                        total: { type: 'number' },\n                        entries: {\n                          type: 'array',\n                          items: { $ref: '#/components/schemas/DriveEntry' },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          401: { description: 'No autorizado - Token invalido o ausente' },\n          403: { description: 'Acceso denegado - Ruta fuera del espacio de la empresa' },\n          404: { description: 'Ruta no encontrada' },\n        },\n      },\n    },\n    '/api/drive/info': {\n      get: {\n        tags: ['Drive'],\n        summary: 'Obtener metadata de un archivo o carpeta (Multi-tenant)',\n        description: 'Obtiene informaci\u00F3n detallada de un archivo o carpeta. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'path',\n            in: 'query',\n            required: true,\n            schema: { type: 'string' },\n            description: 'Ruta relativa del archivo o carpeta',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Metadata del archivo o carpeta',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: { $ref: '#/components/schemas/DriveEntry' },\n                  },\n                },\n              },\n            },\n          },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n    '/api/drive/folders': {\n      post: {\n        tags: ['Drive'],\n        summary: 'Crear carpeta (Multi-tenant)',\n        description: 'Crea una nueva carpeta en el espacio de la empresa. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['name'],\n                properties: {\n                  path: { type: 'string', description: 'Ruta padre (opcional, raiz si se omite)' },\n                  name: { type: 'string', description: 'Nombre de la carpeta' },\n                },\n                example: {\n                  path: 'orders',\n                  name: 'project-1',\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: {\n            description: 'Carpeta creada exitosamente',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        name: { type: 'string' },\n                        path: { type: 'string' },\n                        type: { type: 'string', example: 'folder' },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          400: { description: 'Nombre de carpeta invalido' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'Ruta padre no encontrada' },\n        },\n      },\n    },\n    '/api/drive/files': {\n      post: {\n        tags: ['Drive'],\n        summary: 'Subir archivo (Multi-tenant)',\n        description: 'Sube un archivo al espacio de almacenamiento de la empresa. Requiere JWT con companyId. El archivo se almacenar\u00E1 en /companies/{companyId}/{path}/',\n        security: [{ bearerAuth: [] }],\n        requestBody: {\n          required: true,\n          content: {\n            'multipart/form-data': {\n              schema: {\n                type: 'object',\n                required: ['file'],\n                properties: {\n                  path: { type: 'string', description: 'Ruta destino relativa (ej: orders/project-1)' },\n                  file: { type: 'string', format: 'binary', description: 'Archivo a subir' },\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          201: {\n            description: 'Archivo subido exitosamente',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        name: { type: 'string' },\n                        path: { type: 'string' },\n                        type: { type: 'string', example: 'file' },\n                        size: { type: 'number' },\n                        url: { type: 'string', description: 'URL publica del archivo' },\n                        urlAbsolute: { type: 'string', description: 'URL absoluta' },\n                      },\n                    },\n                  },\n                  example: {\n                    success: true,\n                    data: {\n                      name: 'factura.pdf',\n                      path: 'orders/project-1/factura.pdf',\n                      type: 'file',\n                      size: 102400,\n                      url: '/files/companies/company-123/orders/project-1/factura.pdf',\n                    },\n                  },\n                },\n              },\n            },\n          },\n          400: { description: 'Archivo invalido o faltante' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n        },\n      },\n    },\n    '/api/drive/entry': {\n      delete: {\n        tags: ['Drive'],\n        summary: 'Eliminar archivo o carpeta (Multi-tenant)',\n        description: 'Elimina un archivo o carpeta del espacio de la empresa. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'path',\n            in: 'query',\n            required: true,\n            schema: { type: 'string' },\n            description: 'Ruta del archivo o carpeta a eliminar',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Eliminado exitosamente',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    message: { type: 'string' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        path: { type: 'string' },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          400: { description: 'Ruta requerida' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n    '/api/drive/move': {\n      patch: {\n        tags: ['Drive'],\n        summary: 'Mover o renombrar archivo/carpeta (Multi-tenant)',\n        description: 'Mueve o renombra un archivo o carpeta dentro del espacio de la empresa. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        requestBody: {\n          required: true,\n          content: {\n            'application/json': {\n              schema: {\n                type: 'object',\n                required: ['from', 'to'],\n                properties: {\n                  from: { type: 'string', description: 'Ruta origen' },\n                  to: { type: 'string', description: 'Ruta destino' },\n                },\n                example: {\n                  from: 'orders/old-name.pdf',\n                  to: 'orders/project-1/new-name.pdf',\n                },\n              },\n            },\n          },\n        },\n        responses: {\n          200: {\n            description: 'Movido exitosamente',\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    success: { type: 'boolean' },\n                    data: {\n                      type: 'object',\n                      properties: {\n                        from: { type: 'string' },\n                        to: { type: 'string' },\n                        url: { type: 'string' },\n                        urlAbsolute: { type: 'string' },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          400: { description: 'Rutas requeridas o invalidas' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'Origen no encontrado' },\n        },\n      },\n    },\n    '/api/drive/pdf/info': {\n      get: {\n        tags: ['Drive'],\n        summary: 'Obtener metadata de un PDF (Multi-tenant)',\n        description: 'Obtiene informaci\u00F3n de un PDF (n\u00FAmero de p\u00E1ginas, dimensiones, etc.). Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'url',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'URL publica del PDF',\n          },\n          {\n            name: 'path',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'Ruta relativa dentro del drive',\n          },\n        ],\n        responses: {\n          200: { description: 'Metadata del PDF' },\n          400: { description: 'Parametro invalido' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n    '/api/drive/pdf/page': {\n      get: {\n        tags: ['Drive'],\n        summary: 'Renderizar pagina de PDF a imagen (Multi-tenant)',\n        description: 'Renderiza una p\u00E1gina de un PDF a imagen PNG. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'url',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'URL publica del PDF',\n          },\n          {\n            name: 'path',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'Ruta relativa dentro del drive',\n          },\n          {\n            name: 'page',\n            in: 'query',\n            required: true,\n            schema: { type: 'integer', minimum: 1 },\n          },\n          {\n            name: 'scale',\n            in: 'query',\n            required: false,\n            schema: { type: 'number', default: 1.5 },\n            description: 'Escala de render (0.5 - 3)',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Imagen PNG de la pagina',\n            content: {\n              'image/png': {\n                schema: { type: 'string', format: 'binary' },\n              },\n            },\n          },\n          400: { description: 'Parametro invalido' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n    '/api/drive/pdf/preview-grid': {\n      get: {\n        tags: ['Drive'],\n        summary: 'Preview de PDF con grilla para coordenadas (Multi-tenant)',\n        description: 'Renderiza una p\u00E1gina de PDF con grilla superpuesta para ayudar a encontrar coordenadas. Requiere JWT con companyId.',\n        security: [{ bearerAuth: [] }],\n        parameters: [\n          {\n            name: 'url',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'URL publica del PDF',\n          },\n          {\n            name: 'path',\n            in: 'query',\n            required: false,\n            schema: { type: 'string' },\n            description: 'Ruta relativa dentro del drive',\n          },\n          {\n            name: 'page',\n            in: 'query',\n            required: true,\n            schema: { type: 'integer', minimum: 1 },\n          },\n          {\n            name: 'scale',\n            in: 'query',\n            required: false,\n            schema: { type: 'number', default: 1.5 },\n          },\n          {\n            name: 'grid',\n            in: 'query',\n            required: false,\n            schema: { type: 'integer', default: 50 },\n            description: 'Tama\u00F1o de grilla en puntos',\n          },\n        ],\n        responses: {\n          200: {\n            description: 'Imagen PNG con grilla',\n            content: {\n              'image/png': {\n                schema: { type: 'string', format: 'binary' },\n              },\n            },\n          },\n          400: { description: 'Parametro invalido' },\n          401: { description: 'No autorizado' },\n          403: { description: 'Acceso denegado' },\n          404: { description: 'No encontrado' },\n        },\n      },\n    },\n  },\n};\n"],
  "mappings": "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",
  "names": ["path", "mongoose", "Buffer", "Buffer", "Buffer", "Buffer", "Buffer", "crypto", "timingSafeEqual", "Buffer", "Buffer", "Buffer", "jwt", "require_valid", "require_semver", "header", "secretOrPublicKey", "_", "require_lodash", "require_lodash", "require_lodash", "require_lodash", "require_lodash", "require_lodash", "_", "fs", "path", "path", "fs", "path", "path", "delay", "cron", "path", "path", "path", "fs", "statusCode", "Router", "path", "path", "router", "Router", "Router", "jwt", "router", "Router", "Router", "fs", "path", "randomUUID", "fs", "path", "randomUUID", "fs", "path", "path", "fs", "randomUUID", "router", "Router", "Router", "multer", "fs", "path", "fs", "path", "path", "fs", "buildAbsoluteUrl", "fs", "path", "MAX_DRIVE_BYTES", "fs", "path", "path", "fs", "path", "router", "Router", "path", "fs", "upload", "multer", "cron", "fs", "quotaValidatorService"]
}
